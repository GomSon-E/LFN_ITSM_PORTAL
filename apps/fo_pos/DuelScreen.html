<style>[pgmid='DuelScreen'].framepage .userClass { 
width:100%; 
}
[pgmid='DuelScreen'].framepage #totalpaylist{
    min-width : 100%;
    font-weight : bold; 
    font-size:2em;
    text-align : right; 
}
[pgmid='DuelScreen'].framepage #totalpaylist button{
    width : 90%;
    height : 30%;
    font-size : 2em;
    font-weight : bold;
}
[pgmid='DuelScreen'].framepage #totalpaylist{
    min-width : 100%;
}
[pgmid='DuelScreen'].framepage #totalpaylist input{
    width : 80%;
    font-size : 1.2em;
    font-weight : bold;
    height : 50px;
}
#wrapper{
    
    height : 100%;
    
    overflow : auto;
    
    vertical-align: baseline;
}


th{ 
    
    height : 50px;
    
    position: sticky;
    
    top: 0px;
    
    background-color : #F7F4E3;
    
    border-bottom : 1px solid black;
    
    border-collapse: collapse;

    font-size : large;
    
    font-family: 'NanumSquareRoundExtraBold';
}


tbody {
    
    height : 80%;
    
    display: table-row-group;
    
    vertical-align: baseline;
    
    border-color: inherit;
    
    font-size : 1.3em;
    
    text-align : center;

}


#content td{
    
    font-weight : bold;
    
    font-size : large;
    
    border-bottom : 1px solid black;
    
    vertical-align: middle;
    
    font-family: 'NanumSquareRoundExtraBold';
}

footer {
    
    height : 10%;
    
    font-family: 'NanumPen';
    
    text-align : center;
    
    font-size : 4em;
}

#pay {
    
    font-family: 'NanumSquareRoundExtraBold';
    
    font-size : 2em;
    
    font-weight : bold;
}

#totalpay {
    
    background-color : #F7F4E3;
    
    font-family: 'NanumSquareRoundExtraBold';
    
    font-weight : bold;
    
    font-size : 1em;
    
    width : 150px;
    
    height : 35px;
    
    border : none;
    
    text-align : center;
}


#list{
    
    border-collapse: collapse;
    
    white-space:nowrap;
    
}
</style>

<!-- HTML autogen start ---------------------------------------------- -->            
<div class="pageContent">
    <!--<div class="flexColumn">-->
    <div id=wrapper>
        <table id="list" style="width:100%">
            <thead>
                <tr>
                    <th>이 미 지</th>
                    <!--<th>제 품 명</th>-->
                    <th>상 품 코 드</th>
                    <th>판 매 가</th>
                    <th>수 량 </th>
                    <th>판 매 금 액</th>
                    
                </tr>
            </thead>
            <tbody id='content'></tbody>
        </table>
    </div>
</div>
<div style="text-align : right" id="pay">총 액 : <input type="text" name="totalpay" id="totalpay"/></div>
<footer>저희 LF팩토리 아울렛 매장을 찾아주셔서 감사합니다.</footer>
<link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-pen.css" rel="stylesheet">
<link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square-round.css" rel="stylesheet">

<!-- HTML autogen end ---------------------------------------------- -->
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "fo_pos";
    var pgmid = "DuelScreen"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"pgmid":"DuelScreen","pgm_nm":"판매 목록","pgm_tp":"UX","proc_mst_id":"","proc_mst_nm":"","remark":"매장 포스 듀얼스크린용 화면","ver":4.3,"pgm_stat":"Y","reg_usid":"mjw","reg_dt":"2022-02-28 11:53:38","upd_usid":"mjw","upd_dt":"2022-02-28 11:53:38","app_pgmid":"fo_pos","pgm_grp_nm":"판매","sort_seq":107,"shortcut":"","crud":"","app_pgm_nm":"매장"};
me.dataDef["_pgm_func"]=[];
me.dataDef["_pgm_data"] = {};
me.dataDef["_pgm_data"]["imgPreview"]={"sort_seq":"1","data_id":"imgPreview","data_nm":null,"data_icon":null,"component_pgmid":"FreeForm","component_option":null,"inout_tp":"OUT","content":[]};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */

    /* 사용자초기화 */
    me.fnInitExtra=function() {
        
        gMDI.screen(true);
        window.addEventListener("storage", function () {
        "localDataStorage",
        me.fnsearch();
        }, false);
        $("input[name=totalpay]").val("0");
        me.pageObj.imgPreview.componentTop.hide(); 
        //탭 설정
        //gfnTab(pageid, "tabs", {"multi-active":"off","toggle-switch":"on"}); 
        //사용자 컴포넌트 
        //me.dataDef["_pgm_data"][myCompoId] = {...};
        //me.pageObj["myCompoId"] = new gfnComponent( me.pageid, myCompoId, me.dataDef["_pgm_data"][myCompoId], me.fnEH, me); 
        //me.pageObj["myCompoId"].userComponent = "myCompoId";
        //사용자 컨트롤
        //var myColinfo = {colid:...}
        //me.pageObj["myColId"] = new gfnControl(myColinfo, me.fnEH) 
        //me.page.find("#myCol").append(me.pageObj["myColId"].dispObj);
        //me.pageObj["myColId"].getVal(); / myCol.setVal(val);...    
    }
    /* 이벤트핸들러 */
    me.fnEH=function(component, evt, row, col, val) { 
        //console.log(evt+","+row+","+col+","+val);
        //화면기능버튼이 눌리면 
        if (component==me.pageObj["_pageFunc"]){ 
            if(typeof(me[col])=='function') me[col](); //col=기능명 me["fnSearch"]()=me.fnSearch(); 
        }
        //list:판매목록 이벤트처리     
        else if(component==me.pageObj["list"]) {
            if(evt=="componentFunc") {
                if(row=="addRow") {
                    component.addRow();
                } else if(row=="delRow") {
                    component.delRow();
                }
            }
            //if(evt=="change" && col=="colid") {...}
        }
        //사용자 컴포넌트/컨트롤
        else if(component.userComponent=="myCompoId") {
            //if(evt=="dblclick" && col=="colid") {...}
        }
    }
    me.fnsearch=function() {
        var itemlist = JSON.parse(localStorage.getItem("item"));
        if(isNull(itemlist)){
            $("input[name=totalpay]").val("0");
            $("#content").empty();
            return;
        }
        var brcd = [];
        for(i=0;i<itemlist.length;i++){
            var code = itemlist[i].brcd;
            if(!isNull(code)){
               brcd.push(code); 
            }
        }
        var args = {brcd:brcd};
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"imgsearch",{INVAR:invar},function(OUTVAR){
            if(OUTVAR.rtnCd == "OK") {
                var list = OUTVAR.list;
                $("#content").empty();
                var total = 0;
                for(var i=0; i < itemlist.length; i++) {
                    var find = getIndex(list,"ref_id",itemlist[i].brcd);
                    if(find!=-1){
                        var goods_cd = itemlist[i].goods_cd;
                        var html = "";
                        html += `<tr>`;
                        if(!isNull(list[find].file_url)){
                            html += `<td>`+`<img src='`+ list[find].file_url + `' style='width:80px; height:30px;'/>`+`</td>`;
                        }
                        // html += `<td>` + itemlist[i].goods_nm + `</td>`;
                        html += `<td>` + itemlist[i].goods_cd + `</td>`;
                        html += `<td>` + format(itemlist[i].sale_price) + `</td>`;
                        html += `<td>` + itemlist[i].so_qty + `</td>`;
                        html += `<td>` + format(itemlist[i].sale_amt) + `</td>`;
                        html += `</tr>`;
                        total += itemlist[i].sale_amt;
                        $("#list").append(html);
                    }else{
                        var goods_cd = itemlist[i].goods_cd;
                        var html = "";
                        html += `<tr>`;
                        html += `<td>`+`<img src='`+ "https://fo.lfnetworks.co.kr/pds/LFN/BR_IMG//220225000421da95a7a0.png" + `' style='width:80px; height:30px;'/>`+`</td>`;
                        html += `<td>` + itemlist[i].goods_cd + `</td>`;
                        // html += `<td>` + itemlist[i].goods_nm + `</td>`;
                        html += `<td>` + format(itemlist[i].sale_price) + `</td>`;
                        html += `<td>` + itemlist[i].so_qty + `</td>`;
                        html += `<td>` + format(itemlist[i].sale_amt) + `</td>`;
                        html += `</tr>`;
                        total += itemlist[i].sale_amt;
                        $("#list").append(html);
                    }
                }
                $("input[name=totalpay]").val(format(total));
                
            } else {
                gfnAlert("조회오류", OUTVAR.rtnMsg);
            }
        });
        localStorage.clear();
    }  


/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>