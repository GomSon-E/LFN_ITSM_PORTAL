<!-- css start -->
<style>
    [pgmid=''].framepage .userClass {
        width: 100%;
    }

    html {
        height: 100%;
    }

    body {
        background: linear-gradient(70deg, #3595fc, pink);
        font-family: "Asap", sans-serif;
    }

    .signup {
        overflow: hidden;
        background-color: white;
        padding: 40px 30px 30px 30px;
        border-radius: 10px;
        position: absolute;
        top: 50%;
        left: 50%;
        width: 550px;
        -webkit-transform: translate(-50%, -50%);
        -moz-transform: translate(-50%, -50%);
        -ms-transform: translate(-50%, -50%);
        -o-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
        -webkit-transition: -webkit-transform 300ms, box-shadow 300ms;
        -moz-transition: -moz-transform 300ms, box-shadow 300ms;
        transition: transform 300ms, box-shadow 300ms;
        box-shadow: 5px 10px 10px rgba(2, 128, 144, 0.2);
    }

    .signup::before,
    .signup::after {
        content: "";
        position: absolute;
        width: 600px;
        height: 600px;
        border-top-left-radius: 40%;
        border-top-right-radius: 45%;
        border-bottom-left-radius: 35%;
        border-bottom-right-radius: 40%;
        z-index: -1;
    }

    .signup::before {
        left: 20%;
        bottom: -100%;
        background-color: #cce3ff;
        -webkit-animation: wawes 6s infinite linear;
        -moz-animation: wawes 6s infinite linear;
        animation: wawes 6s infinite linear;
    }

    .signup::after {
        left: 15%;
        bottom: -105%;
        background-color: #9cc5f7;
        -webkit-animation: wawes 7s infinite;
        -moz-animation: wawes 7s infinite;
        animation: wawes 7s infinite;
    }

    .signup button, .signup #btnEmpnoCheck {
        font-family: "Asap", sans-serif;
        cursor: pointer;
        color: #fff;
        font-size: 12px;
        text-transform: uppercase;
        width: 95px;
        height: 25px;
        border: 0;
        border-radius: 9px;
        background-color: #4296fc;
        /* -webkit-transition: background-color 300ms; */
        -moz-transition: background-color 300ms;
        transition: background-color 300ms;
        margin: 0 0 0 10px;
    }

    .signup button:hover, .signup #btnEmpnoCheck:hover {
        background-color: #8ebcf5;
    }

    .signup #usid, .signup #pwd {
        font-family: "Asap", sans-serif;
        border-radius: 5px;
        font-size: 16px;
        background: #e8f0fe;
        width: 70%;
        border: 0;
        padding: 10px 10px;
        margin: 10px 10px;
    }

    select {
        font-family: "Asap", sans-serif;
        color: #787878;
        display: block;
        border-radius: 5px;
        font-size: 16px;
        background: #e8f0fe;
        width: 70%;
        border: 0;
        padding: 10px 10px;
        margin: 10px 10px 15px 10px;
        height: 40PX;
    }

    select::-ms-expand {
        /* for IE 11 */
        display: none;
    }

    .signup p {
        color: #787878;
        font-size: 12px;
        margin: 0 10px;
    }
</style>

<!-- html start -->
<div class="pageNav"></div>
<div class="pageTop"></div>
<div class="pageCond"></div>
<div class="pageContent">
    <div class="signup">
        <img src="./images/CI.jpg">
        <div name="frm" action="#" id="frm">
            <input type="text" class="usid" name="usid" id="usid" check_result="fail" required placeholder="*아이디"/>
          <input type="button" id="btnEmpnoCheck" value="중복체크" />
            <p id="notice"></p>

            <input type="password" name="pwd" id="pwd" placeholder="*비밀번호">
            <p>* 숫자+영문+특수문자 포함 8자리 이상 입력해야 합니다.</p>
            <select>
                <option selected>*소속회사</option>
                <option>업체</option>
                <option>현업</option>
            </select>
            <button id="signUpBtn"><i class="fas fa-save" aria-hidden="true"></i> 회원가입</button>
            <button id="loginBtn" class="link" onclick="location.reload()"> <i class="fas fa-key"
                    aria-hidden="true"></i> Login</button>
        </div>
    </div>
</div>
<script>
/*-- _script(자동생성1) start ---------------------------------------------- */        
$(function() {
    var appid = "ITSM";
    var pgmid = "signup"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"ver":0.2,"upd_dt":"2023-01-05 09:02:02","remark":"","pgmid":"signup","proc_mst_id":"","pgm_stat":"Y","sort_seq":null,"app_pgmid":"ITSM","shortcut":"","reg_dt":"2023-01-05 08:54:15","reg_usid":"jhk","pgm_nm":"회원가입","upd_usid":"jhk","pgm_tp":"UX","pgm_grp_nm":"공통","proc_mst_nm":"","app_pgm_nm":"ITSM","":"트랜젝션(메뉴)","crud":""};
me.dataDef["_pgm_func"]=[];
me.dataDef["_pgm_data"] = {};

    me.pageObj["_page"] = new gfnFramepage( me ); 
    for(var component_id in me.dataDef["_pgm_data"]) { 
        me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
    }  
    setTimeout(function(){
        $("#frameset").scrollTo(0); //스크롤 
    },10);
    if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
}
/*-- script(개발자작성) start ---------------------------------------------------- */ 
 /* 사용자초기화 */
        me.fnInitExtra = function () {
            //사용자 컴포넌트 
            //me.dataDef["_pgm_data"][myCompoId] = {...};
            //me.pageObj["myCompoId"] = new gfnComponent( me.pageid, myCompoId, me.dataDef["_pgm_data"][myCompoId], me.fnEH, me); 
            //me.pageObj["myCompoId"].userComponent = "myCompoId";
            //사용자 컨트롤
            //var myColinfo = {colid:...}
            //me.pageObj["myColId"] = new gfnControl(myColinfo, me.fnEH) 
            //me.page.find("#myCol").append(me.pageObj["myColId"].dispObj);
            //me.pageObj["myColId"].getVal(); / myCol.setVal(val);...    
        };
        /* 이벤트핸들러 */
        me.fnEH = function (component, evt, row, col, val) {
            //화면기능버튼이 눌리면 
            if (component == me.pageObj["_pageFunc"]) {
                if (typeof (me[col]) == 'function') me[col](); //col=기능명 me["fnSearch"]()=me.fnSearch(); 
            }
            //사용자 컴포넌트/컨트롤
            else if (component.userComponent == "myCompoId") {
                //if(evt=="dblclick" && col=="colid") {...}
            }
        };

        //회원가입
        $('.usid').change(function () {
            $('#id_check_sucess').hide();
            $('.id_overlap_button').show();
            $('.usid').attr("check_result", "fail");
        });

        $(document).ready(function (){   
	   $("#btnEmpnoCheck").on("click", function(event) {
	   var params = $("frm").serialize(); // 자동으로 폼태그 안에있는애들 주르륵
	   
	   		$.ajax({
	   			url:"awegtx.jsp"
	   			,dataType:"json"
	   			,type:"GET"
	   			//,data:"empno="+$("#empno").val(); //id값이 주어졌다면 이렇게 해도되나 지저분
	   			,data:params //바로 이렇게 줘도 됨 
	   			,cache:false //같은 요청이 있으면 db에 있는 것 바로 뿌리겠다
	   			,success:function(data){ //성공했으면 가져오는 데이터가 있을 것
	   				//alert(data.count); //data는 JSON 값을 받을 것 {"count":0} data.count하면 0아니면 1
	   				if(data.count==1){ //사용중
	   					$("#notice").css("color","red").text("이미 사용 중인 아이디입니다.");
	   				}else{//사용가능
	   					$("#notice").css("color","blue").text("사용 가능한 아이디입니다.");
	   				}
	   			}
	   		});//ajax
	   });//click
   });//ready


        //회원가입 저장
        $("#signUpBtn").click(function () {

            console.log("회원가입 테스트")
            if ($("#usid").val() === "") {
                alert("아이디를 입력하세요.");
                $("#usid").focus();
                return false;
            }
            if ($('.usid').attr("check_result") == "fail") {
                alert("아이디 중복체크를 해주시기 바랍니다.");
                $('.usid').focus();
                return false;
            }
            if ($("#pwd").val() === "") {
                alert("비밀번호를 입력하세요.");
                $("#pwd").focus();
                return false;
            }
            if ($("#checkpwd").val() === "") {
                alert("비밀번호를 확인해주세요.");
                $("#checkpwd").focus();
                return false;
            }
            if ($("#company").val() === "") {
                alert("소속회사를 선택해주세요.");
                $("#company").focus();
                return false;
            }


            me.fnSave();
        });

        //save:저장 
        me.fnSave = function () {

            console.dir("fnSave" + ":" + invar);
            gfnConfirm("회원가입 확인", " 회원가입 하시겠습니까?", function (bConfirm) {
                // if (!me.pageObj["frm"].chkVal'id()) return;
                // var args = me.pageObj["frm"].exportData()[0];
                // var frm = me.pageObj.frm.exportData("CRU");
                // args.frm = frm;
                if (bConfirm) {
                    var args = {
                        "usid": $("#usid").val(),
                        "pwd": $("#pwd").val(),
                        "checkpwd": $("#checkpwd").val(),
                        "company": $("#company").val()
                    };
                    console.log(args);
                    var invar = JSON.stringify(args);
                    gfnTx(appid + "." + pgmid, "save", { INVAR: invar }, function (OUTVAR) {
                        console.log(OUTVAR);
                        if (OUTVAR.rtnCd == "OK") {
                            me.fnSavePwd3();
                            me.fnSaveGrp();
                        } else {
                            gfnAlert("조회오류", OUTVAR.rtnMsg);

                        }
                    });
                }
            }
            );
        };

        me.fnSavePwd3 = function () {
            var args = {
                "usid": $("#usid").val()
            };
            var invar = JSON.stringify(args);
            console.log(args);
            gfnTx(appid + "." + pgmid, "savePwd", { INVAR: invar }, function (OUTVAR) {
                console.log(OUTVAR);
                if (OUTVAR.rtnCd == "OK") {
                    // gfnAlert("저장성공","비밀번호가 초기화 되었습니다."); 
                    // me.fnSearchGrp();
                } else {
                    gfnAlert("저장오류", OUTVAR.rtnMsg);
                }
            });
        };

        me.fnSaveGrp = function () {
            var args = {
                "usid": $("#usid").val()
            };
            var invar = JSON.stringify(args);
            gfnTx(appid + "." + pgmid, "saveGrp", { INVAR: invar }, function (OUTVAR) {
                console.log(OUTVAR);
                if (OUTVAR.rtnCd == "OK") {
                    location.reload();
                } else {
                    gfnAlert("저장오류", OUTVAR.rtnMsg);
                }
            });
        };
/*-- _script2(자동생성2) start ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>