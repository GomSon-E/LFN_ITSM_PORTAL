<style>[pgmid='frameset'].framepage .userClass { 
width:100%; 
}</style>
<header id="frameGNB" class="float">
	<div class="gnb">
		<img class="CI" src="/images/fashionERP.png"/>
		<nav class="frameBtnSet A" style="width:calc( 100% - 10em );">
			<button class="apps"><i class="fas fa-th"></i><span>Apps</span></button>
			<button class="search"><i class="fas fa-search"></i><span>Search</span></button>
			<button class="notice"><div class="countAlert hidden" value="0"></div><i class="fas fa-comment-dots"></i><span>Notice</span></button>
			<button class="user"><i class="fas fa-user-circle"></i><span>User</span></button>
			<button class="remote"><i class="fas fa-desktop"></i><span>원격지원</span></button>
		</nav>
	</div>
	<div class="userInfo hidden">
		<ul class="userInfo-item">
			<li class="profile">프로필 관리</li>
			<li class="changePwd">비밀번호변경</li>
			<li class="withdrawlUser">회원탈퇴</li>
			<li class="logout">로그아웃</li>
		</ul>
	</div>
</header>
<div id="frameset">
	<aside id="frameLeft"> 
		<div class="appMenu">
			<H3>My Apps</H3>
			<div id="frameTab" class="APP"></div>
		</div>
		<div class="grp">
			<div class="grpCafe">
				<H3>My Cafe
				<button id="cafeMore" class="cafeMore" value="카페리스트">more</button></H3>
				<ul class="CAFE"></ul>
			</div>
			<div class="grpChat">
			</div>
		</div>
	</aside>
	<main id="frameMain">
		<button class="btnShow"><i class="far fa-map"></i><span></span></button>
		<!-- button class="btnShowR"><i class="far fa-map"></i><span></span></button -->

	</main>
	<aside id="frameRight" class="rightMini" > 
		<div class="info" style="display:none;">
			<H3>History</H3>
			<ul class="history">
				<li>좋아요!: 퍼갈께요~ <b>candy</b><span>2021-06-18 18:57:21</span></li>
				<li>공유됨 <b>You</b><span>2021-06-18 18:55:21</span></li>
				<li>수정됨: 제목변경 <b>airjaws</b><span>2021-06-18 18:55:11</span></li>
				<li>신규생성 <b>You</b><span>2021-06-18 18:45:11</span></li>
			</ul>
			<H3>Collabor with</H3>
			<ul class="cowork">
				<li><b>이름</b> 역할</li>
				<li><b>이름</b> 역할</li>
				<li><b>이름</b> 역할</li>
				<li><b>이름</b> 역할</li>
			</ul>
			<H3>채널별 매출</H3>
			<ul class="channelSell">
				<li>채널1 수량 금액</li>
				<li>채널2 수량 금액</li>
				<li>채널3 수량 금액</li>
			</ul>
			<H3>일별매출(최근2주)</H3>
			<ul class="storeSell">
				<li>일자1 수량 금액</li>
				<li>일자2 수량 금액</li>
				<li>일자3 수량 금액</li>
			</ul>
		</div>
	</aside>
</div>
<footer id="frameBottom" class="bottom">
	<nav class="frameBtnSet B">
		<button class="home"><i class="fas fa-home"></i><span>Home</span></button>
		<button class="prev"><i class="fas fa-arrow-left"></i><span>Back</span></button>
		<button class="next"><i class="fas fa-arrow-right"></i><span>Next</span></button>
		<button class="calendar"><i class="far fa-calendar-alt"></i><span>Calendar</span></button>
		<button class="screen"><i class="fas fa-window-restore"></i><span>Screen</span></button>
		<button class="close"><i class="fas fa-window-close"></i><span>Close</span></button>
	</nav>
</footer>
<nav id="frameApp" class="aweApp hidden">
	<div class="appMenu">
		<ul class="APP"></ul>
		<div class="PGM"></div>
	</div>
	<div class="pgmMenu">
	</div>
</nav>
<div id="frameAlert" class="hidden"></div>
<div id="frameChat"></div>
<div id="frameMsg">
    <ul class="msgList"></ul>
</div>
<search id="frameSearch" class="aweSearch hidden">
</search>
<div id="frameStatus"></div>
<div id="ruler"></div>

<!-- status -->
<div id="status">
    <ul></ul>
</div>


<!-- alert -->
<div id="alert" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">alert 창입니다.</h5>
            <button class="layerBtn btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="layerClickHandler('alert')"></button>
        </div>
        <div class="modal-body">
            <p>alert 내용입니다.</p>
        </div>
        <div class="modal-footer">
            <button class="layerBtn btn btn-primary" onclick="layerClickHandler('alert')">확인</button>
        </div>
    </div>
</div>

<!-- progress -->
<div id="progress" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Progress 창입니다.</h5>
            </div>
            <div class="modal-body">
                <p>Progress 내용입니다.</p>
                <div class="progress">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" style="width: 100%;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- popup -->
<div id="popup" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">popup 창입니다.</h5>
            <button class="layerBtn btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="layerClickHandler('popup')"></button>
        </div>
        <div class="modal-body">
            <p>popup 내용입니다.</p>
        </div>
    </div>
</div>

<script>
var wH, wW, bH, bW, fH, fW, mH, mW, rem; //화면상태 추적
</script>
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "aweportal";
    var pgmid = "frameset"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"ver":2.6,"upd_dt":"2022-10-27 09:04:25","remark":"","pgmid":"frameset","proc_mst_id":"","pgm_stat":"Y","sort_seq":92,"app_pgmid":"aweportal","shortcut":"","reg_dt":"2022-10-12 17:14:15","reg_usid":"kihyunlee","pgm_nm":"포털프레임셋","upd_usid":"kihyunlee","pgm_tp":"TX","pgm_grp_nm":"공통","proc_mst_nm":"","app_pgm_nm":"FO Portal","":"트랜젝션(화면)","crud":""};
me.dataDef["_pgm_func"]=[];
me.dataDef["_pgm_data"] = {};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */
    /* 사용자초기화 */
    me.fnInitExtra=function() {
        if(isNull(gUserinfo.usersession)) location.reload(); 
        pageid  = "frameset";
    	page    = $("#body"); //frameset의 page는 "#body"임에 주의한다!
    	
        gFrameset  = me; //frameset에 Access할때 gFrameset사용 
        me.appid   = appid;
        me.pgmid   = pgmid;
        me.pageid  = pageid;
        me.page    = page;
        me.dataSet = dataSet; 

        try {
            //최초 로드시 스크롤탑 처리
            window.addEventListener('load', function(){
                setTimeout(scrollTo, 0, 0, 1);
            }, false);

            //화면이 바뀔때 사이즈정보 표시
            $(window).on("resize rotate orientationchange", me.fnFramesetLayout);

        } catch(e) {
            console.error(`${pgmid} window.load : ${e}`);
        }  
        
        //CI 로고 클릭시 리로드
        $("img.CI").on("click",function(){
            alert("시스템 리소스 파일을 초기화합니다.")
            location.href="/index.html?"+date("today","yyyymmddhh24miss"); 
        });
    	
	    me.fnRetrieveInit();
    	
    	//jqueryui modal dialog에서 select2 제대로 작동하지 않는 것에 대한 HACK
        if ($.ui && $.ui.dialog && $.ui.dialog.prototype._allowInteraction) {
            var ui_dialog_interaction = $.ui.dialog.prototype._allowInteraction;
            $.ui.dialog.prototype._allowInteraction = function(e) {
                if ($(e.target).closest('.select2-dropdown').length) return true;
                return ui_dialog_interaction.apply(this, arguments);
            };
        }
        
        gfnTx("aweportal.frameset","getReq",{}, function(OUTVAR){ 
            console.log(OUTVAR);
        });
    }   

//frameset 데이터로드 : 세션사용자정보를 사용하므로 args없음 
    me.fnRetrieveInit = function() {
        gfnTx("aweportal.frameset","retrieveInit",{}, function(OUTVAR){ 
            if(OUTVAR.rtnCd=="OK") {
                if(OUTVAR.server != "fo.lfnetworks.co.kr") {
                    $("#frameGNB").css("background-color","darkred");
                    gUserinfo.server = "dev";
                    console.log("개발환경입니다...");
                    messages          = io('http://192.168.0.86:8070/socket.io/messages'); //Messages 개발 서버 연결 
                } else {
                    gUserinfo.server = "prod";
                    console.log("운영환경입니다...!");
                    messages          = io('https://fo.lfnetworks.co.kr/socket.io/messages'); //Messages 운영 서버 연결
                }
                
                gds.comcd         = OUTVAR.comcd;   //공통코드
                gUserinfo.defval  = OUTVAR.defval;  //사용자기본값
                gUserinfo.usergrp = OUTVAR.usergrp; //사용자그룹
                gds.menu          = OUTVAR.menu;    //권한화면목록
                gds.notice        = OUTVAR.notice;  //사용자알림
                
                encdeckey         = "lfnetworks";   //메세지 암호화 복호화 키

                me.fnInitMDI();
				me.fnInitFrameGNB();
                me.fnInitJoinGroupMain();
                
				me.fnShowFrameApp();

				me.fnEHFrameStatus();
				me.fnEHFrameGNB();
				me.fnEHFrameApp();
				me.fnEHFrameSearch();
				me.fnEHFrameUser();
				me.fnEHFrameSet();
                me.fnEHFrameLeftBar();
                me.fnEHFrameRightBar();
                me.fnEHFrameBottom();
                me.fnEHMessageReceive();
                
				me.fnFramesetLayout();

                //비번변경해야할 경우
                gfnTx("aweportal.frameset","checkChangePwd",{}, function(OUTVAR){ 
                    //console.log(OUTVAR);
                    if(OUTVAR.rtnCd=="OK") {
                        var pwd_yn = OUTVAR.list[0].temp_yn; 
                    	if(pwd_yn == "Y"){
                            gfnAlert("비밀번호 변경 요청","비밀번호가 초기화 또는 변경요청되었습니다. 비밀번호를 변경한 후 [저장]하시면 다시 접속됩니다!");
                    	    gMDI = new gfnMDI($("#frameMain"), $("#frameTab")); //gMDI초기화 
                    	    var pgmid = "changePwd";
                            var pgmnm = "비밀번호 변경"; 
                            var changePwd = $("<div></div>"); 
                            gMDI.openPageOne(pgmid,pgmnm);
                            
                    	} 
                    } 
                });
            }
        });
    }

//frameSet 화면크기
    me.fnFramesetLayout = function() {
        //프레임셋 화면크기 추적
        wH = toNum($(window).outerHeight(),0);
        wW = toNum($(window).outerWidth(),0);

        //mobile모드가 아니면 frameBottom을 frameGNB로 도킹시킨다
        var frameBottom = $("#frameBottom");
        var bottomH = 0;
        if(wW < 768) {
            $("body").addClass("mobile");
            me.fnShowFrameLeftBar(false); 
            $("#frameRight").after(frameBottom);
            frameBottom.removeClass("dock");
            frameBottom.addClass("bottom");
            bottomH = frameBottom.outerHeight();
        } else {
            $("body").removeClass("mobile");
            $("#frameGNB .CI").after(frameBottom); //docking
            frameBottom.removeClass("bottom");
            frameBottom.addClass("dock");
        }
        $("#frameset").css("margin-bottom",bottomH+"px");

        bH = toNum($("body").outerHeight(),0);
        bW = toNum($("body").outerWidth(),0);
        fH = toNum($("#frameset").outerHeight(),0);
        fW = toNum($("#frameset").outerWidth(),0);
        mH = toNum($("#frameMain").outerHeight(),0);
        mW = toNum($("#frameMain").outerWidth(),0);

        var oRem = $("#ruler");
        $("body").append(oRem);
        rem = toNum(oRem.outerHeight(),0);
        oRem.text(mW+","+mH+" / "+fW+","+fH+" / "+bW+","+bH+" / "+wW+","+wH+" ("+rem+"px/rem)");

        /* JQUERYUI HACK : window변경시 다이얼로그 닫기 */
        if(!$("body").hasClass("mobile")) {
            $("[role='dialog']").each(function(idx,el) {
                var dialogId = $(el).attr("aria-describedby");
                $("#"+dialogId).dialog("close");
            });
    
            $(".gButtonsetpanel").hide();
    
            if(!$("#frameApp").hasClass("hidden")) $("#frameApp").addClass("hidden");
        }
    }

    //main group 유저 접속	
    me.fnInitJoinGroupMain = function() {	
        var args = {	
            reg_usid : gUserinfo.userid,	
            usnm : gUserinfo.usernm,	
            grpid  : "main"	
        }	
        messages.emit("main", args);	
        // var args = {	
        //     reg_usid : gUserinfo.userid,	
        //     usnm : gUserinfo.usernm,	
        //     grpid : gUserinfo.userid	
        // }	
        // messages.emit(gUserinfo.userid, args);	
    }

//gMDI
    me.fnInitMDI = function() {
        gMDI = new gfnMDI($("#frameMain"), $("#frameTab")); //gMDI초기화 
        gMDI.loadHome(); //frameMain에 frameHome 로드
    
        //frameLeft cafePortlet 로드
        var cafePortlet = $("#frameLeft .CAFE");
        gfnLoad("aweportal","cafePortlet", cafePortlet, function(OUTVAR){
        }); 

        //frameLeft 메세지 채널 로드 및 초기화
        gMDI.portletChat();	
        //frameGNB 알림 로드 및 초기화	
        gMDI.portletAlert();	
	}

    me.fnInitFrameGNB = function() {
        //banner로드
        gfnTx("aweportal.frameset","retrieveBanner",{},function(OUTVAR){
            if(OUTVAR.rtnCd == "OK") { 
                for(var i=0; i < OUTVAR.list.length; i++) {
                    var row = OUTVAR.list[i];
                    var banner = $(`<div class="banner ${row.doc_template_id}" docid="${row.docid}" title="${row.title}"></div>`);
                    //내용채워주고
                    var bannerContent = $(`<span>${row.content}</span>`);
                    bannerContent.on("click",function(e){
                        //광고 내용표시
                        var oDoc = $(e.target).exactObj(".banner");
                        var args = {docid:oDoc.attr("docid"), proc_stat:"Y"};
                        var invar = JSON.stringify(args);
                        gfnTx("aweportal.frameset","updateBannerRead",{INVAR:invar},function(OUTVAR){

                            gfnAlert("준비중",`Banner표시: [${oDoc.attr("docid")}] ${oDoc.attr("title")}`); 
                        }); 							

                        oDoc.remove();
                    });
                    banner.append(bannerContent);
                    //닫기버튼 추가하고
                    var bannerCloser = $('<i class="fas fa-times"></i>');
                    bannerCloser.on("click",function(e){
                        //다시 안 열리게 업데이트
                        var oDoc = $(e.target).exactObj(".banner");
                        var args = {docid:oDoc.attr("docid"), proc_stat:"C"};
                        var invar = JSON.stringify(args);
                        gfnTx("aweportal.frameset","updateBannerRead",{INVAR:invar},function(OUTVAR){

                            gfnStatus("광고를 읽음처리 하였습니다."); 
                        }); 

                        oDoc.remove();
                    });
                    bannerContent.after(bannerCloser);
                    //GNB에 붙여줌
                    if(row.doc_template_id=="bannerUp") {
                        $("#frameGNB .gnb").before(banner);
                    } else {
                        $("#frameGNB .gnb").after(banner);
                    }
                }
            }
        });

        //알림
        if(gds.notice !=undefined && gds.notice.length > 0) {
            var noticnt = $("#frameGNB button.notice i b");
            if( noticnt.length == 0 ) {
                $("#frameGNB button.notice i").append("<b></b>");
                noticnt = $("#frameGNB button.notice i b");
            }
            noticnt.text( gds.notice.length );
        } else {
            $("#frameGNB button.notice i b").remove();
        }

        //사용자정보에 따른 사용자표시
        $("#frameGNB button.user span").text( gUserinfo.usernm );
	}

    me.fnShowFrameApp = function() {
        var showMenu = function(app_pgm_nm) {
            page.find("#frameApp .appMenu .APP .app").removeClass("selected");
            page.find("#frameApp .appMenu .APP div[app='" + app_pgm_nm + "']").addClass("selected");

            //$.each(subset(gds.menu, "app_pgm_nm", app_pgm_nm), function(idx, row) {
            var pgms = subset(gds.menu, "app_pgm_nm", app_pgm_nm); 
            sort(pgms,"sort_seq");   
            $.each(pgms, function(idx, row) {
                //idx 시작 값 0 이벤트 - 기존 APP 메뉴 대분류 제거, 새로운 APP 메뉴 대분류 생성
                if(idx == 0) {
                    page.find("#frameApp .appMenu .PGM .app").remove();
                    var app = $("<div></div>");
                    app.addClass("app");
                    app.attr("app", app_pgm_nm);
                    page.find("#frameApp .appMenu .PGM").append(app);
                } 

                //hasClass() boolean - 이미 생성된 중분류가 있는지 확인 후 대분류에 append()
                if(page.find("#frameApp .appMenu .PGM .app div").hasClass(row.pgm_grp_nm) == false) {				
                    var grp = $("<div></div>");
                    grp.addClass(row.pgm_grp_nm);
                    //grp.attr("pgmgrp", row.pgm_grp_nm);
                    grp.append("<div class='pgmgrp'>" + row.pgm_grp_nm + "</div>")
                    grp.append("<ul class='box'></ul>")
                    //grp.text(row.pgm_grp_nm);
                    page.find("#frameApp .appMenu .PGM .app").append(grp);
                }

                //subset()으로 분류된 요소를 each() 반복 - row를 통해 program 정보를 해당 중분류에 append()
                var pgm = $("<li></li>");
                pgm.addClass("pgm");
                pgm.text(row.pgm_nm);
                pgm.attr("pgmid", row.pgmid);
                pgm.attr("pgmgrp", row.pgm_grp_nm);
                if(row.fav_yn=="Y") pgm.addClass("fav");
                page.find("#frameApp .appMenu .PGM div[class='" + row.pgm_grp_nm + "'] .box").append(pgm);
            });
        }

        //menu에 app 추가
        var applistDistinct = extract(gds.menu, ["app_pgm_nm","app_seq"], "distinct");
        applistDistinct = applistDistinct.filter(el=> !isNull(el.app_pgm_nm));
        sort(applistDistinct,"app_seq");
        var applist = [];
        for(var x=0; x < applistDistinct.length; x++) {
            applist.push( applistDistinct[x].app_pgm_nm);
        }
        $.each(applist, function(idx, row) {
            if(idx == 0) page.find("#frameApp .appMenu .APP .app").remove();

            //extract()로 중복 제거한 applist를 each()로 반복 - row값 idx 0인 경우만 showMenu로 전달
            var app = $("<div app='" + row + "'></div>");
            app.addClass("app")
            app.text(row);
            page.find("#frameApp .appMenu .APP").append(app);
            if(idx == 0) showMenu(row);
        });

        //event-handler(frameGNB) : frameApp menu click event
        page.find("#frameApp .appMenu .APP .app").on("click", function(e) {
            //Apps 을 클릭하면 하단에 pgm리스트를 표시한다.
            showMenu($(e.target).text());
        });

        page.find("#frameApp .appMenu .PGM").on("click", ".pgm", function(e) {
            //pgm을 클릭하면 해당 화면을 열어준다.
            var menu = $(e.target);
            var pgmid = menu.attr("pgmid");
            var pgmnm = menu.text();
            gMDI.openPage( pgmid, pgmnm );
            page.find("#frameApp").addClass("hidden"); //메뉴선택시 패널 숨김
        });
	}

    me.fnShowFrameSearch = function() {
        $("#frameSearch").empty();
        var frameGNBWidth = parseInt(window.getComputedStyle(document.querySelector("nav")).width);
        document.querySelector("#frameSearch").style.width = (frameGNBWidth - 10) + "px";

        //page.find("#frameSearch .frameSearchSet").remove();
        //page.find("#frameSearch").removeClass("hidden");
        //var search = $("<div></div>");
        //search.addClass("frameSearchSet");
        var searchAll = $("<div></div>"); 
        gfnLoad("aweportal","searchAll", searchAll, function() {
            /* 
        search.append("<div><input class='searchBar' placeholder='&nbsp;LF Networks EP 통합검색'></div>");
        //search.append("<div><button>아이콘</div>");
        
        page.find(".searchBar").off("keyup");
        page.find(".searchBar").on("keyup",function(e){
            if(e.keyCode==13) {
                gfnStatus($(e.target).val()+" enter pressed");
            }
        });            */
            page.find("#frameSearch").append(searchAll);
            page.find(".searchBar").focus(); 
        });
        
    }

    me.fnShowFrameLeftBar = function(bShow) {
        if(bShow==undefined) {
				if(page.find("#frameLeft").hasClass("leftMini")) bShow=true;
				else bShow = false;
			}
        if(bShow) {
            if($("#frameBottom nav .screen").hasClass("max")) $("#frameGNB").css("display","block");
            page.find("#frameLeft .appMenu").show();
            page.find("#frameLeft .grp").show();
            page.find("#frameLeft").removeClass("leftMini"); 
            $("#frameMain .btnShow").removeClass("closed");
        } else {
            if($("#frameBottom nav .screen").hasClass("max")) $("#frameGNB").css("display","none");
            page.find("#frameLeft .appMenu").hide();
            page.find("#frameLeft .grp").hide();
            page.find("#frameLeft").addClass("leftMini");  
            $("#frameMain .btnShow").addClass("closed");
        }
    }

    me.fnShowFrameRightBar = function(bShow) { 
        if(bShow == undefined) {
            if(page.find("#frameRight").hasClass("rightMini")) bShow = true;
            else bShow = false;
        } 
        if(bShow) {
            page.find("#frameRight .info").show();
            page.find("#frameRight").removeClass("rightMini"); 
        } else {
            page.find("#frameRight .info").hide();
            page.find("#frameRight").addClass("rightMini");         
        }
    }

    me.fnEHFrameStatus = function() {
        /* 커서가 있으면 frameStatus메시지 위치를 변경한다. */
        var block = false;
        $("body #frameStatus").on({
            mouseover: function(e) {
                if(!block) { 
                    if( $("#frameStatus").css("flex-direction") == "column-reverse" ) {
                        block=true;
                        $("#frameStatus").css({top:"unset",bottom:"0.5em","flex-direction":"column"});
                        setTimeout(function(){ block=false},1000);
                    } else {
                        $("#frameStatus").css({top:"0.5em",bottom:"unset","flex-direction":"column-reverse"});
                        bLock=true;
                        setTimeout(function(){ block=false},1000);
                    }
                }
            }
        })
        /* gButtonsetpanel */
        $(window).on({
            click: function(e) {
                var oE = $(e.target);
                if ( oE.isON(".gButtonpanelBtn")==false ) {
				 		$(".gButtonsetpanel").hide();
				}
                /* framepage.active에서 btnCond, Quick Guide, Tab 클릭이 일어나면 그리드 높이를 fit하게 해줌 */
                if (oE.isON(".btnCond") || oE.isON(".guideBtn") || oE.isON(".commonFunc button:contains('Screen')") || oE.isON(".aweTab .tab") || oE.isON(".componentTitle")  ) {
                    gfnFramepageLayout(); 
                } 
            }
        }); 
    }

    me.fnEHFrameGNB = function() {
		$("#frameGNB .gnb .CI").on({ 
            click: function() { 
                gfnHome();
            } 
        })
		$("#frameGNB .gnb nav .notice").on({ 
            click: function() { 
	            $("#frameGNB .gnb nav .notice").attr("style","background-color:unset");
                $("#frameGNB .gnb nav .notice i").css("color", "hsl(0 12% 12%)");
                $("#frameAlert").toggleClass("hidden");	
            }	
        })	
        $(page).on({	
            click: function(e) {	
                if(!$("#frameGNB .gnb nav .notice").has(e.target).length && !$("#frameAlert").has(e.target).length) {	
                    $("#frameAlert").addClass("hidden");	
                }	
            }	
        }); 
        $("#frameGNB .gnb nav .remote").on({ 
            click: function(e) {
                const url = "http://helpu.kr/LFNETWORKS/";
                window.open(url);
            }
        })
	}

    me.fnEHFrameApp = function() {
        
        $("#frameGNB .gnb nav .apps").on({
			click: function() {
				$("#frameApp").toggleClass("hidden");
			}
		}) 
        $(window).on({  //메뉴표시 바깥 클릭시 메뉴 숨기기 
            click: function(e) {
                if(!$("#frameGNB .gnb nav .apps").has(e.target).length && !$("#frameApp").has(e.target).length) {
                    $("#frameApp").addClass("hidden");
                }
            }
        });  
    }

    me.fnEHFrameSearch = function() {
        $("#frameGNB .gnb .frameBtnSet .search").on({
            click: function() {
                $("#frameSearch").toggleClass("hidden");
		 	    me.fnShowFrameSearch();
            }
        });
        $(window).on({
            click: function(e) {
                if(!$("#frameGNB .gnb .frameBtnSet .search").has(e.target).length && !$("#frameSearch").has(e.target).length) {
                    $("#frameSearch").addClass("hidden");
                }
            }
        });
    }

    me.fnEHFrameUser = function() {
        $("#frameGNB .gnb nav .user").on({
	 		click: function(e) {
                $("#frameGNB .userInfo").toggleClass("hidden");
            }
        })
        $("#frameGNB .userInfo").on({
			click: function(e) {
				var oE = $(e.target);
                
				if(oE.isON(".profile")) gMDI.openPage("manageProfile", "프로필 관리", function(OUTVAR){},"aweportal");
				else if(oE.isON(".changePwd")) gMDI.openPage("changePwd", "비밀번호 변경", function(OUTVAR){}, "aweportal");	
				else if(oE.isON(".withdrawlUser")) gMDI.openPage("withdrawlUser", "회원탈퇴", function(OUTVAR){}, "aweportal");	
				else if(oE.isON(".logout")) gfnLogout();				
			}
		});
        $(page).on({
            click: function(e) {
                if(!$("#frameGNB .gnb nav .user").has(e.target).length && !$("#frameGNB .list").has(e.target).length) {
                    $("#frameGNB .userInfo").addClass("hidden");
                }
            }
        });
    }

    me.fnEHFrameSet = function() {
        $("#frameset").on({
            scroll: function() {
                if($("body").hasClass("mobile") == false) {
                    var scrollTop = $("#frameset").scrollTop();
                    var frameLeft = $("#frameLeft");
                    if ( scrollTop < 2*rem ) { //스크롤이 충분히(2rem) 올라왔으면 마진 0
                        frameLeft.css("margin-top",0);
                    } else {
                        var Lmt = nzl(toNum(frameLeft.css("margin-top").replaceAll("px","")),0);
                        var LH = frameLeft.outerHeight();
                        var MH = $("#frameMain").outerHeight();
                        if(Lmt+LH < MH && scrollTop+LH < MH) { //frameMain이 더 크다고 가정할때 왼쪽이 더 작으면
                            frameLeft.css("margin-top", scrollTop+"px" ); //스크롤Top만큼 마진을 넣어줌
                        }
                    }
                }
                //화면크기 추적
                me.fnFramesetLayout();
            }
        })
    }

    me.fnEHFrameLeftBar = function() { 
        $("#frameMain .btnShow").on({
            click : function() {
                me.fnShowFrameLeftBar();
            }
        })
    }

    me.fnEHFrameRightBar = function() { 
        $("#frameMain .btnShowR").on({
            click : function() {
                me.fnShowFrameRightBar();
            }
        })
    }

    me.fnEHFrameBottom = function() {
        $("#frameBottom").on({
            click: function(e) {
                var oE = $(e.target);
                if(oE.isON(".home")) gMDI.go(0);
                else if(oE.isON(".prev")) gMDI.go("prev");
                else if(oE.isON(".next")) gMDI.go("next");
                else if(oE.isON(".calendar")) gfnCalendar();
                else if(oE.isON(".screen")) gMDI.screen();
                else if(oE.isON(".close")) gMDI.close();
            }
        })
    } 
    //여기도 페이지 리로딩 시 (리스너) 초기화 필요	
    me.fnEHMessageReceive = function() {	
        //메인 그룹 메세지 리스너	
        messages.on("main", function(data) {	
        })	
        //유저 전용 메세지 리스너	
        messages.on(gUserinfo.userid, function(data) {	
            if(data.type == "chatInvite") {	
                gMDI.portletChat();	
                gMDI.portletAlert();	
                me.fnEHAlert();	
            }	
        })	
    }	
    me.fnEHAlert = () => {
        //chaim.play();
        $("#frameGNB .gnb nav .notice").animate({ "background-color":"rgb(0, 0, 0)" }, 1000);
        $("#frameGNB .gnb nav .notice i").animate({ "color":"rgb(255, 255, 255)" }, 1000);
    }


/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>