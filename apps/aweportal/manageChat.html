<style>
	#frameset .manageframeChat {
		position: absolute;
		background-color: hsl(0 0% 100%);
		padding: 15px;
		border-radius: 10px;
		left: 39%;
		top: 15%;
		/* transform: translate(-50%, -50%); */
		transition:all 0.2s ;
		box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.42);
		z-index: 15;
		width: 315px;
	}
	input:-webkit-autofill {
		-webkit-box-shadow: 0 0 0 1000px white inset;
	}
	div.ui-dialog-content {
		background-color:hsl(240 23.8% 95.9%);
	}

	.alertInfo {
		display: flex;
		align-items: center;
		justify-content: space-between;
	}
		.alertInfo #alertInput {
			outline: none;
			border: none;
			font-size: 18px;
			font-weight: bolder;
			height: 30px;
			border-radius: 10px;
		    text-indent: 10px;
		}
		.alertInfo #alertInput::placeholder {
			color: hsl(0 0% 0%);
		} 
		.alertInfo i.fas.fa-times {
			font-size: 24px;
    	margin-right: 5px;
			cursor: pointer;
		} 
		.alertInfo i.fas.fa-times:hover {
			color: hsl(210 100% 52%);
		}

	.titleInfo, .titleInfoDef {
		display: flex;
	}

		.titleInfo .title, .titleInfoDef .title {
			color: hsl(210 100% 52%);
			font-size: 14px;
			margin: 10px;
		}
		.titleInfo #titleInput, .titleInfoDef #titleInputDef { 
			border: none;
			outline: none;
			font-size: 14px;
			margin-left: 10px;
			border-bottom: 1px solid hsl(240 23.8% 95.9%);
			width: 60%;
		}

	.userInfo {
		display: flex;
	}

		.userInfo .user {
			color: hsl(210 100% 52%);
			font-size: 14px;
			margin: 10px;
		}
		.userInfo #userInput {
			border: none;
			outline: none;
			font-size: 14px;
			margin-left: 10px;
			border-bottom: 1px solid hsl(240 23.8% 95.9%);
			width: 30%;
		}
		.userInfo #userLvl {
			border: none;
			outline: none;
			font-size: 14px;
			width: 100px;
		}

	.selectedInfo {
		height: 80px;
		/*background-color: hsl(240 23.8% 95.9%);*/
		border-radius: 8px;
		margin-top: 5px;
		overflow: overlay;
	}
	.selectedInfo::-webkit-scrollbar{
		width: 6px;
	}
	.selectedInfo::-webkit-scrollbar-thumb{
		height: 18%;
		background-color: hsl(240 2.5% 69.0%);
		border-radius: 10px;  
	}
	.selectedInfo::-webkit-scrollbar-track{
		background-color: hsl(0 0% 100%);
	}

		.selectedInfo .selectedEmpList {
			margin-top: -9px;
		}

			.selectedInfo .selectedEmpList .list {
				list-style: none;
				padding: 0;
			}

				.selectedInfo .selectedEmpList .list li {
					background-color: hsl(210 100% 52%);
					color: hsl(0 0% 100%);
					display: inline-flex;
					padding-top: 4px;
					padding-bottom: 4px;
					padding-left: 10px;
					padding-right: 7px;
					margin-top: 3px;
					margin-left: 5px;
					margin-bottom: 3px;
					border-radius: 20px;
					font-size: 13px;
					cursor: pointer;
				}
				.selectedInfo .selectedEmpList .list li:hover {
					background-color: hsl(0 0% 100%);
					color: hsl(210 100% 52%);
					box-shadow: 0 0 0 1px hsl(210 100% 52%) inset; 
				}

				.selectedInfo .selectedEmpList .list li .selectCancel {
					padding-left: 3px;
					font-size: 15px;
				}
				.selectedInfo .selectedEmpList .list li .selectCancel:hover {
					color: hsl(0 0% 0%);
				}
	.searchInfo {
		background-color: hsl(240 23.8% 95.9%);
    	border-radius: 8px;
    	margin-left: 10px;
    	margin-right: 10px;
    	margin-top: 5px;
    	margin-bottom: 5px;
    	display: flex;
    	justify-content: space-between;
	}
		.searchInfo #searchInput {
			background-color: hsl(240 23.8% 95.9%);
			width: 100%;
			border: none;
			outline: none;
			font-size: 15px;
			height: 30px;
    		padding-left: 10px;
			margin-right: 10px;
		}
		.searchInfo i.fas.fa-search {
			color: hsl(240 23.8% 80%);
			font-size: 17px;
    		margin-left: 10px;
    		margin-top: 8px;
		}

		.searchInfo i.fas.fa-times-circle {
			color: hsl(240 23.8% 80%);
			font-size: 18px;
			margin-top: 7px;
			margin-right: 10px;
			cursor: pointer;
		}
	.empDept {
		background-color: hsl(210 100% 52%);
    	border-radius: 8px;
		margin-left: 10px;
		margin-right: 10px;
	}
		.empDept #empDept {
			width: 100%;
			border: none;
			background-color: rgba( 255, 255, 255, 0 );
    		color: hsl(0 0% 100%);
			height: 30px;
			border-radius: 8px;
			-webkit-appearance:none; /* for chrome */
			-moz-appearance:none; /*for firefox*/
			appearance:none;
			outline: none;
			cursor: pointer;
			text-align: center;
			font-size: 14px;
			font-weight: bolder;
		}

	.empInfo {
		display: flex;
	}
		.empInfo .organization {
			width: 130px;
		}
			.empInfo .organization .header {
				text-align: center;
				font-size: 12px;
    			font-weight: bolder;
			}

		.empList {
    		width: 100%;
		}

		.empList .tab {
			display: flex;
    		justify-content: space-around;
			font-size: 12px;
    		font-weight: bolder;
			/* margin-right: 50px; */
		}
		.empList .list {
			list-style: none;
			padding: 10px;
			overflow: overlay;
    		height: 29em;
		}
		.list::-webkit-scrollbar{
			width: 6px;
		}
		.list::-webkit-scrollbar-thumb{
			height: 18%;
			background-color: hsl(240 2.5% 69.0%);
			border-radius: 10px;  
		}
		.list::-webkit-scrollbar-track{
			background-color: hsl(0 0% 100%);
		}

			.empList .list .usid {	
				display: grid;
				grid-auto-flow: column;
				padding-left: 15px;
				padding-right: 15px;
				padding-top: 1px;
				padding-bottom: 4px;
				border-bottom: 1px solid hsl(60 5.2% 81%);
				cursor: pointer;
				align-items: center;
				justify-content: end;
			}
			.empList .list li i {
				/* grid-row: 2; */
				padding-right: 14px;
				font-size: 16px;
				margin-top: 7px;
				color: hsl(60 5.2% 81%);
			}
			.empList .list li i.fas.fa-user {
				font-size: 16px;
				background-color: hsl(0 0% 70%);
				border-radius: 12px;
				padding: 10px;
    			margin-right: 10px;
				color: hsl(0 0% 100%);
			}

			.empList .list li i.fa-check-circle:before {
				color: hsl(135 58.6% 49.2%);
			}

			.empList .list li:hover {
				background-color: hsl(240 23.8% 95.9%);
    			color: hsl(0 0% 0%);
			}
			.empList .list li.selected {
				background-color: hsl(240 23.8% 95.9%);
    			color: hsl(0 0% 0%);
			}
			.empList .list .header {
				display: inline-block;
				width: 100px;
				font-size: 13px;
				padding: 4px;
				text-align: center;
				color: hsl(0 0% 60%);
			}
				.empList .list .usid input {
					margin-right: 20px;
					grid-row: 2;
					margin-top: -10px;
					width: 15px;
					height: 15px;
				}
				.empList .list .usid .nm {
					font-size: 16px;
					font-weight: bolder;
					width: 110px;
				}
					.empList .list .usid .nm label.role_tp {
						background-color: hsl(210 100% 52%);
						color: hsl(0 0% 100%);
						font-size: 12px;
						padding-left: 7px;
						padding-top: 2px;
						padding-bottom: 2px;
						padding-right: 7px;
						border-radius: 5px;
						margin-left: 2px;
					}
				.empList .list .usid .nick_nm {
					width: 90px;
					font-size: 14px;
				}	
		.empList .empInfoCard {	
			position: absolute;
			width: 336px;
			height: 160px;
			background-color: hsla(212deg 10% 15% / .85);
			transition: all 0.3s cubic-bezier(.25,.8,.25,1);
			top: 35%;
    	left: 1%;
			border-radius: 10px;
			box-shadow: 0 10px 20px rgb(0 0 0 / 19%), 0 6px 6px rgb(0 0 0 / 23%);
			display: grid;
			grid-auto-flow: column;
			justify-content: start;
			align-items: center;
			padding-bottom: 5px;
		}
		.empList .empInfoCard i.fas.fa-user {
			background-color: hsl(0 0% 100%);
    		padding: 10px;
    		font-size: 100px;
    		margin: 20px;
			  margin-right: 15px;
    		border-radius: 10px;
			grid-row: span 4;
		}
		.empList .empInfoCard .empInfoCardName {
			color: hsl(0 0% 100%);
    	font-size: 22px;
		}

		.empList .empInfoCard .empInfoCardNick {
			color: hsl(0 0% 100%);
    		font-size: 15px;
		}
		.empList .empInfoCard .empInfoPhone, .empList .empInfoCard .empInfoEmail {
			color: hsl(0 0% 100%);
    	font-size: 12px;
			cursor: pointer;
		}
		.empList .empInfoCard .empInfoPhone:hover, .empList .empInfoCard .empInfoEmail:hover {
			color: hsl(210 100% 52%);
		}				
	.btnList button {
		border: none;
		outline: none;
		font-size: 14px;
		padding-left: 15px;
		padding-right: 15px;
		padding-top: 5px;
		padding-bottom: 5px;
		border-radius: 8px;	
	}
		.btnList button#confirm {
			background-color: hsl(210 100% 52%);
			color: hsl(0 0% 100%);
		}
		.btnList button#confirm:hover {
			background-color: hsl(210 100% 52%);
			color: hsl(240 10.6% 90.8%)
		}
		.btnList button#leave {
			background-color: hsl(0 0% 100%);
			color: hsl(210 100% 52%);
			float: right;
			box-shadow: 0px 0px 0px 1px hsl(210deg 100% 52%) inset;
			margin-left: 5px;
		}
		.btnList button#leave:hover {
			background-color: hsl(210 100% 52%);
			color: hsl(0 0% 100%);
		}
		.btnList button.selectManager {
			color: hsl(210 100% 52%);
			float: right;
		}
		.btnList button.selectManager:hover {
			background-color: hsl(210 100% 52%);
			color: hsl(0 0% 100%);
		}
</style>
<div id="manageChat">
	<div class="alertInfo">
		<input id="alertInput" placeholder= "Messages" disabled/><i class="fas fa-times"></i>
	</div>
	<div class="titleInfoDef hidden">
		<div class="title">채널 기본 이름</div>
		<input id="titleInputDef" placeholder="기본 이름을 변경합니다.">
	</div>
	<div class="titleInfo hidden">
		<div class="title">메세지 채널</div>
		<input id="titleInput" placeholder="채널 이름을 입력해주세요.">
	</div>
	<div class="userInfo hidden">
		<div class="user">닉네임 설정</div>
		<input id="userInput" placeholder="닉네임을 입력해주세요."/>
		<input id="userLvl" readonly/>
	</div>
	<div class="selectedInfo">
		<div class="selectedEmpList">
			<ul class="list"></ul>
		</div>
	</div>
	<div class="searchInfo">
		<i class="fas fa-search"></i><input id="searchInput" placeholder="검색" autocomplete="false"/><i class="fas fa-times-circle hidden"></i>
	</div>
	<div class="empDept">
		<select id="empDept"></select>
	</div>
	<div class="empInfo">
		<div class="empList">
			<ul class="list"></ul>
		</div>
	</div>
	<div class="btnList">
		<button id="confirm">확인</button>
		<button id="leave">채널 나가기</button>
		<button class="selectManager hidden">매니저 변경</button>

	</div>
</div>
<script>
$(function () {
    var appid 	= "aweportal";
    var pgmid 	= "manageChat";
	var grpid   = gParam["grpid"];	//gParam["grpid"]를 참조 (생성할/생성된 메세지 채널 구분)
    var page 	= $("*[pgmid='" + pgmid + "']").last();
    var dataSet	= {};
    var me 		= {};
	var args	= {};

	var usid     = gUserinfo.userid;
	var nm       = gUserinfo.usernm;
	var nick_nm  = gUserinfo.usernicknm;
	var deptcd   = gUserinfo.deptcd; 

    me.fnInit = function () {
        gfn[pgmid] = me;
        me.appid   = appid;
        me.pgmid   = pgmid;
		me.grpid   = grpid; 
        me.page    = page;
		me.dataSet = dataSet;

		me.usid    = usid;		//현재 로그인 유저 ID
		me.nm	   = nm;		//현재 로그인 유저 이름
		me.nick_nm = nick_nm;	//현재 로그인 유저 직급
		me.deptcd  = deptcd;	//현재 로그인 유저 부서 코드
		me.role_tp = "";		//현재 로그인 유저 TYPE
		me.admin   = "";		//현재 채널 관리자 ID
		me.mode    = false;		//true: 매니저 변경 모드 

		me.dataSet["selectEmpInfo"] = []; 	//부서 유저 정보
		me.dataSet["deptInfo"]      = [];	//ORG, LFN 부서 정보
		me.dataSet["roomInfo"]	    = [];	//신규, 현재 메세지 채널 정보
		me.dataSet["userInfo"]	    = [];	//현재 채널에 로그인한 유저 정보
		me.dataSet["selectEmp"]     = []; 	//현재 메세지 채널에서 변경된 유저 정보
		me.dataSet["selectedEmp"]   = []; 	//현재 메세지 채널에 있는 유저 정보
		
		if(typeof(me.fnInitExtra) == 'function') me.fnInitExtra();
	}

	//데이터 로드
	me.fnInitExtra = function() {
		//draggable 설정
		$("#frameset .manageframeChat").draggable();

		//기존 채널인 경우 그룹ID, 유저 ID로 그룹 정보를 조회
		if(me.grpid != undefined) args = { bCheck: true, grpid : me.grpid, usid : me.usid };
		const invar = JSON.stringify(args);

		gfnTx(appid + "." + pgmid, "chatInfo", { INVAR : invar }, function(OUTVAR) {
			if(OUTVAR.rtnCd = "OK") {
				//그룹 리스트
				me.dataSet["deptInfo"].push(OUTVAR.deptInfo);
				const deptInfoList = me.dataSet["deptInfo"][0];
				me.fnInitDeptList(deptInfoList);

				//기존 채널
				if(me.grpid != undefined) {
					//로그인 유저 정보, 메세지 채널 정보, 선택된 유저 정보 초기화
					Object.assign(me.dataSet["selectedEmp"], OUTVAR.selectedEmp);
					Object.assign(me.dataSet["selectEmp"], OUTVAR.selectedEmp);
					me.dataSet["userInfo"].push(OUTVAR.userInfo[0]);
					me.dataSet["roomInfo"].push(OUTVAR.roomInfo[0]);

					const userInfo    = me.dataSet["userInfo"][0];
					const roomInfo    = me.dataSet["roomInfo"][0];
					const selectedEmp = me.dataSet["selectedEmp"];

					//로그인 유저 부서의 유저 리스트 리턴
					me.fnInitSelectDept(me.deptcd);

					//로그인 유저 타입
					me.role_tp = userInfo.role_tp;

					//채널 관리자
					me.admin = roomInfo.admin;

					//기존 채널 정보(그룹 이름, 그룹 유저 닉네임, 유저 닉네임, 유저 직급)
					me.fnInitRoomInfo(roomInfo.grp_nm, userInfo.grp_nick_nm, userInfo.user_nick_nm, me.nick_nm);

					//기존 채널 매니저 변경 버튼 활성화
					if(me.role_tp == "MNGR") document.querySelector(".selectManager").classList.remove("hidden");

					//1:N 채널일 때,
					if(selectedEmp.length > 2) {
						document.querySelector("#manageChat .titleInfo").classList.remove("hidden");
						document.querySelector("#manageChat .userInfo").classList.remove("hidden");
						document.querySelector("#manageChat .userInfo").classList.remove("hidden");

					//1:1 채널일 때
					} else {
						document.querySelector("#manageChat .btnList #leave").classList.add("hidden");
						document.querySelector("#manageChat .btnList .selectManager").classList.add("hidden");
					}

				//신규 채널
				} else {
					//로그인 유저 부서의 유저 리스트 리턴
					me.fnInitSelectDept(me.deptcd);

					//채널 나가기 버튼 비활성화
					document.querySelector("#leave").classList.add("hidden");

					//신규 채널 정보(그룹 이름, 그룹 유저 닉네임, 유저 닉네임, 유저 직급)
					me.fnInitRoomInfo(null, null, me.nm, me.nick_nm);
				}

				//유저 검색 이벤트
				me.fnEHSearchEmp();

				//부서 선택 이벤트
				me.fnEHSearchDept();
				
				//버튼 이벤트
				me.fnEHBtn();

				//영역 클릭 감지 이벤트
				//me.fnEHClose();

			} else {
				//debug
			}
		})
	}
	//유저 정보 및 기존 채널 정보 필드 초기화
	me.fnInitRoomInfo = function(grp_nm, grp_nick_nm, user_nick_nm, nick_nm) {
		var titleInputDef = grp_nm;				//T_GRP 채널 이름(MNGR) ---- 미사용
		var titleInput	  = grp_nick_nm;		//T_USER_GRP 개별 채널 이름
		var userInput     = user_nick_nm;		//T_USER_GRP 개별 채널 닉네임
		var userLvl       = nick_nm;			//T_USER 직급

		document.querySelector("#titleInputDef").value = titleInputDef;
		document.querySelector("#titleInput").value    = titleInput;
		document.querySelector("#userInput").value 	   = userInput;
		document.querySelector("#userLvl").value 	   = userLvl;
	}

    //부서별 유저 리스트 초기화
	me.fnInitEmpList = function(selectEmpInfo) {
		//선택 유저 리스트 초기화
		const selectEmpList = me.dataSet["selectEmp"];

		//유저 리스트 선택 초기화
		$(".empList .list").empty();

		//유저 등록
		selectEmpInfo.forEach((empInfo) => {
			//li 유저 정보
			let usid = document.createElement("li");
			usid.classList.add("usid");
			usid.setAttribute("value", empInfo.usid);
			usid.setAttribute("oncontextmenu", "return false");

			//체크박스 빈 이미지
			let circle = document.createElement("i");
			circle.classList.add("far");
			circle.classList.add("fa-circle");
			usid.append(circle);

			//체크박스 체크 이미지
			let circleCheck = document.createElement("i");
			circleCheck.classList.add("fas");
			circleCheck.classList.add("fa-check-circle");
			circleCheck.classList.add("hidden");
			usid.append(circleCheck);
			
			//유저 프로필 이미지로 사용할 ico
			let userIco = document.createElement("i");
			userIco.classList.add("fas");
			userIco.classList.add("fa-user");
			usid.append(userIco);

			//유저 이름
			let nm = document.createElement("div");
			nm.classList.add("nm");
			nm.textContent = empInfo.nm;
			usid.append(nm);

			//유저 닉네임(직급)
			let nick_nm = document.createElement("div");
			nick_nm.classList.add("nick_nm");
			nick_nm.textContent = empInfo.nick_nm;
			usid.append(nick_nm);

			//유저 그룹 이름(숨김; 선택 이벤트 시 변수 사용, 차후 시각화용)
			let grp_nm = document.createElement("div");
			grp_nm.classList.add("grp_nm");
			grp_nm.classList.add("hidden");
			grp_nm.textContent = empInfo.grp_nm;
			usid.append(grp_nm);

			//유저 그룹 ID(숨김; 선택 이벤트 시 변수 사용, 차후 시각화용)
			let grpid = document.createElement("div");
			grpid.classList.add("grpid");
			grpid.classList.add("hidden");
			grpid.textContent = empInfo.grpid;
			usid.append(grpid);
			
			//유저 폰(숨김; 선택 이벤트 시 변수 사용, 차후 시각화용)
			let phone = document.createElement("div");
			phone.classList.add("phone");
			phone.classList.add("hidden");
			phone.textContent = empInfo.phone;
			usid.append(phone);
			
			//유저 이메일(숨김; 선택 이벤트 시 변수 사용, 차후 시각화용)
			let email = document.createElement("div");
			email.classList.add("email");
			email.classList.add("hidden");
			email.textContent = empInfo.email;
			usid.append(email);

			//유저 리스트 ul 태그로 유저 정보  li 삽입
			document.querySelector(".empList .list").append(usid);
		});

		//로그인 유저 등록 여부 확인, 선택 처리(선택(선택해제), {유저 ID /유저 이름 / 유저 TYPE / 유저 직급 })
		if(!selectEmpList.find(empInfo => empInfo.usid === me.usid)) {
			me.fnSelectEmp(true, { usid : me.usid, nm : me.nm, role_tp : "MNGR", nick_nm : me.nick_nm });

		//데이터셋에 이미 등록된 경우
		} else {
			//chips, css추가
			me.fnSelectEmpCSS(true, { usid : me.usid, nm : me.nm });
		}

		//데이터셋에 선택한 유저가 있을 경우
		selectEmpList.forEach((selectEmp) => {
			if(selectEmpInfo.find(empInfo => empInfo.usid === selectEmp.usid && selectEmp.usid !== me.usid)) {
				//로그인 유저를 제외한 유저 chips, CSS 선택 처리
				me.fnSelectEmpCSS(true, { usid : selectEmp.usid, nm : selectEmp.nm });
			}
		})
		//유저 선택 이벤트 초기화
		me.fnEHSelectEmp();
	}

	//부서 리스트 초기화(부서코드 리스트)
	me.fnInitDeptList = function(deptInfoList) {
		deptInfoList.forEach((deptInfo) => {
			let option = document.createElement("option");
			if(deptInfo.grpid == me.deptcd) option.setAttribute("selected", "selected");
			option.setAttribute("value", deptInfo.grpid);
			option.setAttribute("style", "font-size: 15px");
			option.setAttribute("style", "color: black");
			option.textContent = deptInfo.grp_nm;
			document.getElementById("empDept").append(option);
		})
	}

	//부서별 유저 리스트(부서코드)
	me.fnInitSelectDept = function(dept) {
		const args = { grpid : dept };
		const invar = JSON.stringify(args);
		gfnTx(appid + "." + pgmid, "selectEmpInfo", { INVAR : invar }, function(OUTVAR) {
			if(OUTVAR.rtnCd == "OK") {
				me.dataSet["selectEmpInfo"] = [];
				me.dataSet["selectEmpInfo"].push(OUTVAR.selectEmpInfo);
				const selectEmpInfo = me.dataSet["selectEmpInfo"][0];
				me.fnInitEmpList(selectEmpInfo);
			}
		});
	}

	//신규, 기존 채널 유저 선택 처리(선택 유무 / 사원 정보 / 기존 채널 유저 유무)
	me.fnSelectEmp = function(bSelect, empInfo, bAlready) {
		//true: 유저 선택
		if(bSelect) {
			//유저 데이터셋 추가
			me.dataSet["selectEmp"].push(empInfo);

			//chips, CSS 추가
			me.fnSelectEmpCSS(true, { usid : empInfo.usid, nm : empInfo.nm } );
			
			//기존 채널 유저 registered 추가
			if(bAlready) $(".empList .list li[value=" + empInfo.usid + "]").setAttribute("type", "registered");
			//if(bAlready) document.querySelector("li[value=" + empInfo.usid + "]").setAttribute("type", "registered");
				
			//신규 기존 채널 생성 로그인 유저, 관리자 유저 MANAGER 타이틀 추가
			if(!bAlready && empInfo.usid == me.usid || bAlready && empInfo.role_tp == "MNGR") $(".empList .list li[value=" + empInfo.usid + "] .nm").append($("<label class='role_tp'>M</label>"));

		//false: 유저 선택 해제
		} else {
			//유저 데이터셋 삭제
            me.dataSet["selectEmp"].forEach(function (row, idx) {
                if(row.usid == empInfo.usid) {
                    me.dataSet["selectEmp"].splice(idx, 1);
                    idx--; 
                }

				if(me.dataSet["selectEmp"].length < 3) {
					document.querySelector("#manageChat .titleInfo").classList.add("hidden");
					document.querySelector("#manageChat .userInfo").classList.add("hidden");
				}

				//chips, CSS 삭제
				me.fnSelectEmpCSS(false, { usid : empInfo.usid, nm : empInfo.nm } );
            })
		}
		page.find(".selectedInfo").scrollTop(page.find(".selectedInfo")[0].scrollHeight);
	}

	//chips, CSS 추가 제거
	me.fnSelectEmpCSS = function(bSelect, empInfo) {
		//유저 선택
		if(bSelect) {
			//chips 추가
			if(!document.querySelector(".selectedEmpList .list ." + empInfo.usid)) {
				let emp = document.createElement("li");
				emp.classList.add(empInfo.usid);
				
				let nm = document.createElement("div");
				nm.textContent = empInfo.nm;
				emp.append(nm);

				let selectCancel = document.createElement("div");
				selectCancel.classList.add("selectCancel");
				emp.append(selectCancel);

				let circleI = document.createElement("i");
				circleI.classList.add("fas");
				circleI.classList.add("fa-times-circle");
				selectCancel.append(circleI);

				document.querySelector(".selectedEmpList .list").append(emp);

				//chips 취소 버튼 이벤트 정의
				me.fnEHCancelEmp(empInfo.usid);
			}
			//css 추가
			$(".empList .list li[value=" + empInfo.usid + "]").addClass("selected");
			$(".empList .list li[value=" + empInfo.usid + "] i.far.fa-circle").addClass("hidden");
			$(".empList .list li[value=" + empInfo.usid + "] i.fas.fa-check-circle").removeClass("hidden");
	
		//유저 선택 해제
		} else {
			//chips 해제
			$(".selectedEmpList .list ." + empInfo.usid).remove();

			//css 해제
			$(".empList .list li[value=" + empInfo.usid + "] i.far.fa-circle").removeClass("hidden");
            $(".empList .list li[value=" + empInfo.usid + "] i.fas.fa-check-circle").addClass("hidden");
            $(".empList .list li[value=" + empInfo.usid + "]").removeClass("selected");
		}
	}

	//매니저 선택 처리
	me.fnSelectManager = function() {
		//매니저 변경 모드 설정
		me.mode = true;

		//정보 변경 쿼리
		
		//필드 초기화 -> es6 empty
		$(".empList .list").empty();
		$(".selectedEmpList .list").empty();

		//기존 채널 선택된 유저 데이터셋 초기화
		me.dataSet["selectEmp"] = [];

		//기존 채널 유저 리스트 출력
		me.fnInitEmpList(me.dataSet["selectedEmp"]);

		//기존 채널 로그인 유저만 선택 처리(선택(선택해제), 유저 정보 데이터 object)
		me.fnSelectEmp(true, { usid : me.usid, nm : me.nm, role_tp : "MNGR", nick_nm : me.nick_nm , grpid : me.grpid });
		
		//선택 이벤트 핸들러 초기화
		me.fnEHSelectEmp();

		//css 설정
		//element.style.backgroundColor = "red";
		document.getElementById("alertInput").setAttribute("value", "매니저를 변경합니다.");
		document.getElementById("alertInput").style.backgroundColor = "hsl(3 100% 61.4%)";
		document.getElementById("alertInput").style.color = "hsl(0 0% 100%)";
		document.getElementsByClassName("selectManager")[0].classList.add("hiddden");
		document.getElementById("leave").classList.add("hidden");
	}

	//신규, 기존 채널 추가 유저 구분 
	me.fnGetEmpData = function() {
		let union       = undefined;
		let insertEmp   = undefined;
		let leaveEmp    = undefined;
		let selectedEmp = undefined;
		let selectEmp   = undefined;
		
		selectedEmp = me.dataSet["selectedEmp"]; //기존 채널 선택 유저 데이터셋
		selectEmp   = me.dataSet["selectEmp"];   //신규, 기존 채널 현재 선택한 유저 데이터셋(로그인 유저 포함)

		//선택 유저 데이터셋 초기화(me.mode true : 매니저 변경 모드)
		if(!me.mode && me.grpid != undefined) { 
			me.dataSet["selectEmp"] = []; 
			me.dataSet["selectedEmp"] = []; 
		};
		
		//기존 채널 유저 데이터 가공(me.mode true : 매니저 변경 모드)
		if(!me.mode && me.grpid != undefined) {
			//채널 선택 유저, 선택 해제 유저
			union     = selectEmp.concat(selectedEmp.filter(({usid}) => !selectEmp.find(row => row.usid == usid)));
			insertEmp = union.filter(row => selectedEmp.every(row2 => !row2.usid.includes(row.usid)));
			leaveEmp  = union.filter(row => selectEmp.every(row2 => !row2.usid.includes(row.usid))); 

			if(insertEmp.length > 0) { insertEmp.forEach(function (row, idx) { me.dataSet["selectEmp"].push(row) })};
			if(leaveEmp.length > 0) { leaveEmp.forEach(function (row, idx) { me.dataSet["selectEmp"].push(row) })};

			//채널 유저 초대하기, 내보내기 리스트 리턴
			return { insert : insertEmp, leave : leaveEmp, select : selectEmp };

		//신규 채널
		} else return { select : selectEmp };
	}

	//신규, 기존 채널 알림 타이틀 생성
	me.fnGetTitle = function(empList, button) {
		//초대하기, 나가기 타이틀 생성 function
		function titleMaker(array) {
			var title = "";
			for(let i = 0; i < array.length; i++) {
				if(i == array.length -1) {
					title += array[i].nm;
				} else {
					title += array[i].nm + ", ";
				}
			}
			return title;
		}

		//데이터 초기화
		let title  = "";
		let select = "";
        let tTop   = "";
		let args   = "";
		let type   = "";

		//타이틀 정의
		if(me.grpid != undefined) { tTop += "[" + me.dataSet["userInfo"][0].grp_nick_nm + " 메세지 채널]</br>" };
		const tNewTop = "[새로운 메세지 채널]</br>";
		const tInvite = " 를(을) 초대합니다.</br>";
		const tOut    = " 를(을) 내보내기 합니다.</br>";
		const tTypeM  = " 를(을) 매니저로 변경합니다.</br>";
		const tTypeC  = "매니저를 위임할 유저를 선택한 뒤, 확인 버튼을 눌러주세요.";
		const tNewOne = "나와의 메세지 채널을 생성합니다.</br>";
		const tLeaveM = "매니저는 메세지 채널을 나가기 전에 매니저를 변경해야 합니다.</br>";
		const tLeaveO = "메세지 채널 나가기를 하면 대화 내용 및 목록에서 모두 삭제 됩니다.</br>";
		const tGo     = "계속하시겠습니까?";		

		//채널 팝업 확인 confirm 버튼
		if(button == 'confirm') {

			//일반 모드
			if(!me.mode) {
				//기존 채널
				let tTotal  = " 총 " + empList.select.length + "명";
				

				if(me.grpid != undefined) {
					title += tTop;
					//초대하거나 내보내기 유저가 있는 경우, 데이터 Array 생성 후, titleMaker로 타이틀 생성
					if(empList.insert.length > 0) { 
						const insertEmpMsg = titleMaker(empList.insert); title += insertEmpMsg + tInvite };
					if(empList.leave.length > 0) { const leaveEmpMsg = titleMaker(empList.leave); title += leaveEmpMsg  + tOut };
					title += tGo;
					const selectEmpMsg = titleMaker(empList.select);
					select = selectEmpMsg + tTotal;

				//신규 채널
				} else {
					const selectEmpMsg = titleMaker(empList.select);
					title += tNewTop + selectEmpMsg + tInvite + tGo;
					select = selectEmpMsg;

					if(empList.select.length != 2) select += tTotal;;
				}
				
			//변경될 매니저 타이틀 생성
			} else if(me.mode) {
				(empList.select).forEach(function(row, idx) {
					//매니저 변경 모드(타입을 변경할 조건)
					if(row.role_tp == "MEMBER") { title += tTop + row.nm + tTypeM; }
				})				
			}
			args = { title : title, select : select };
			
		//채널 팝업 나가기 leave 버튼
		} else if(button == 'leave') {

			//매니저인 경우,
			if(me.usid == me.admin) {
				title += tTop + tLeaveM + tGo;
			
			//멤버인 경우,
			} else {
				title += tTop + tLeaveO + tGo;
			}
			args = { title: title };
		}
		return args;
	}
	
	//채널 데이터 수집
	me.fnGetData = function(title, type) {
		//데이터 및 데이터셋 초기화
		var titleInputDef = document.getElementById('titleInputDef').value;
		var titleInput 	  = document.getElementById('titleInput').value;
		var userInput 	  = document.getElementById('userInput').value;
		
		me.dataSet["roomInfo"] = [];

		//로그인 유저 데이터셋 갱신
		if(me.grpid != undefined) Object.assign(me.dataSet["userInfo"][0], { grp_nick_nm : titleInput, user_nick_nm : userInput });

		//타이틀이 빈 값인 경우, 참여자 이름으로 자동 생성
		if(titleInput == "") titleInput = title.select;
		 
		//채널 정보 갱신
		var roomInfo = { reg_usid : me.usid, upd_usid : me.usid , usid : me.usid};

		//기존 채널
		if(me.grpid != undefined) var ext_roomInfo = { grpid : me.grpid, usid : me.usid, grp_nm : titleInputDef };
		
		//신규 채널
		else var ext_roomInfo = { grp_nm : titleInput };

		//채널 정보 데이터셋 저장
		Object.assign(roomInfo, ext_roomInfo);
		me.dataSet["roomInfo"].push(roomInfo);

		//신규, 기존 채널 유저별 정보 갱신
        me.dataSet["selectEmp"].forEach(function(row, idx) {

            //신규, 기존 유저 정보
            var userInfo = { grp_nick_nm : titleInput, user_nick_nm : row.nm, reg_uid : me.usid, upd_uid : me.usid };

			//기존 채널 유저 정보
			if(me.grpid != undefined && row.grp_nick_nm != undefined) {
                userInfo = { grp_nick_nm : row.grp_nick_nm, user_nick_nm : row.grp_nick_nm, upd_uid : me.usid }; //user_nick_nm -> row.grp_nick_nm 이였음
            }    
            Object.assign(row, userInfo);
		})
	}

	//데이터셋 DB 전송
	me.fnExecuteData = function(button) {
		var args = {};
		var func = undefined;

		args["userInfo"]  = me.dataSet["userInfo"];
		args["roomInfo"]  = me.dataSet["roomInfo"];
		args["selectEmp"] = me.dataSet["selectEmp"];
		func = "chatInfoIUEmpID";

		//신규, 기존 채널 구분 bCheck 
		if(me.dataSet["userInfo"].length == 0) Object.assign(args, { bCheck : true } );//{ args = { bCheck : true } };
		
		//채널 반영 유저 카운트
		if(me.dataSet["selectEmp"].length == 0) Object.assign(args, { bEmp : true } ); //{ args = { bEmp : true } };

		//매니저 변경 모드
		if(me.mode) Object.assign(args, { bType : true });

		//기존 2인 메세지 채널
		if(button == "confirmDual" && me.mode == false) {
			var selectEmp = me.dataSet["selectEmp"];
			selectEmp.sort(function(a, b) { return a.usid < b.usid ? -1 : a.usid > b.usid ? 1 : 0; });
			args = { usid : me.usid, usids :selectEmp[0].usid + "/" + selectEmp[1].usid };
			func = "selectChatInfoDual";
		}
		var invar = JSON.stringify(args);

		gfnTx(appid + "." + pgmid, func, { INVAR : invar }, function(OUTVAR) {
			function fnRespring(grpid) {
                //portletChat 초기화
				gMDI.portletChat();										
				
                //manageChat 팝업 제거
                
				document.getElementsByClassName("manageframeChat")[0].remove();
				//$(document).find(".ui-dialog").remove();

                //manageChat 팝업 gParam 데이터셋 제거
                gParam["grpid"]  = [];									
                gParam["userid"] = [];

				//------------------------프레임 닫지 않고 init 재로딩(추후)
				//frameChat 채널 닫기
				gMDI.closeChat(grpid);

				if(button == 'confirm' || button == 'confirmDual') {					
					//frameChat 채널 열기
					gMDI.openChat("frameChat", grpid);
				}
			}
			
			if(OUTVAR.rtnCd == "OK") {
				//새로 생성하는 채널이 1:1 채널여부 확인
				if(button == "confirmDual" && me.mode == false) {
					const grpInfo = OUTVAR.grpInfo[0];

					if(grpInfo != undefined) fnRespring(grpInfo.grpid);
					else me.fnExecuteData('confirm');
					
				//아닌 경우,
				} else {
					//true: 기존 채널
					if(me.grpid != undefined) {
						fnRespring(me.grpid);
					
					//false: 신규 채널
					} else {
						//UUID로 생성된 GRPID OUTVAR로 로드
						var grpid = OUTVAR.grpid;

						//채널에 초대된 유저에게 알림 처리 시작
						me.dataSet["listAlert"] = [];
						selectEmp = me.dataSet["selectEmp"];

						//선택 유저 socket으로 전달할 데이터 가공
						selectEmp.forEach((row) => { 
							Object.assign(row, { grpid : grpid }); 
							
							//알림 데이터 가공
							var args = {
								grpid       : row.usid,
                        		comments    : row.grp_nick_nm + "에 초대되었습니다.",
                        		ref_info_tp : row.grpid,
                        		ref_id      : "CHAT",
                        		reg_usid    : row.reg_uid, //usid로 수정해야함
								reg_dt      : null
							}	
							me.dataSet["listAlert"].push(args);
						});

						//알림 데이터 전송
						var args = {};
						args["listAlert"] = me.dataSet["listAlert"];
						var invar = JSON.stringify(args);

						gfnTx("aweportal.frameset", "alertIU", { INVAR : invar }, function(OUTVAR) {
							if(OUTVAR.rtnCd == "OK") {

								//알림 socket 전송
								messages.emit("chatInvite", selectEmp);

								//필드 초기화
								gMDI.portletAlert();
								fnRespring(grpid);
							}
						}, true);
					}
				}
			} else {
				//gfnAlert("메세지 채널", "정보 저장 중 오류가 발생했습니다.");
				console.dir(OUTVAR);
			}
		});
	}

	//채널 유저 리스트 검색 이벤트
	me.fnEHSearchEmp = function() {
		//검색 영역 지정
		const search = document.getElementById('searchInput');
		const empDept = document.getElementById("empDept");
		const empDeptParents = document.getElementsByClassName("empDept")[0];
		const searchRun = () => {
			//keyup 입력 값
			const searchVal = search.value.toLowerCase();

			//필드 삭제 버튼
		 	if(searchVal.length > 0) {
				$(".searchInfo i.fas.fa-times-circle").removeClass("hidden");
				empDeptParents.style.backgroundColor = "hsl(0 0% 90%)";
				empDept.disabled = true;

			} else {
				$(".searchInfo i.fas.fa-times-circle").addClass("hidden");
				empDeptParents.style.backgroundColor = "hsl(210 100% 52%)";
				empDept.disabled = false;
			}
			//검색어에 일치하는 목록 리턴
			const args = { search : searchVal };
			const invar = JSON.stringify(args);

			gfnTx(appid + "." + pgmid, "empInfo", { INVAR : invar }, function(OUTVAR) {
				if(OUTVAR.rtnCd == "OK") {
					//데이터셋 초기화
					me.dataSet["selectEmpInfo"] = [];
					me.dataSet["selectEmpInfo"].push(OUTVAR.empInfo);
					const selectEmpInfo = me.dataSet["selectEmpInfo"][0];

					if(selectEmpInfo != undefined) {
						me.fnInitEmpList(selectEmpInfo);
					}
				};
			}, true);
		}
		search.addEventListener('keyup', searchRun);

		//검색어 입력 취소 버튼
		const searchCancel = document.querySelector(".searchInfo i.fas.fa-times-circle");
		searchCancel.addEventListener('click', () => {
			const searchField = document.querySelector("#searchInput");
			searchField.value = null;
			searchRun();
		})
	}

	//부서 선택 이벤트
	me.fnEHSearchDept = function() {
		//모든 유저 리스트
		const searchDept = document.getElementById('empDept');
		searchDept.addEventListener('change', () => {
			const dept = searchDept.options[searchDept.selectedIndex].value;
			me.fnInitSelectDept(dept);
		});
	};

	//유저 리스트 선택 이벤트
	me.fnEHSelectEmp = function() {
		const selectArr = document.getElementsByClassName('usid');

		Array.from(selectArr).forEach((select) => {
			//한번 클릭 이벤트
			select.addEventListener('click', () => {

				//유저 프로필 카드 열람 중 왼쪽 버튼 클릭 시, 프로필 카드 제거
				if(document.querySelector(".empList .empInfoCard")) {
					const card = document.querySelector(".empList .empInfoCard");
					document.querySelector(".empList").removeChild(card); 
				} 

				const selectUSID = select.getAttribute("value");

				//현재 채널 로그인 유저와 관리자를 선택할 수 없도록 필터
				if(selectUSID == me.usid || selectUSID == me.admin) { gfnStatus("채널 MEMBER 권한은 초대만 가능합니다."); return; }

				//현재 채널 로그인 유저가 MEMBER인 경우, 기존 채널 유저 내보내기 불가
				if(me.usid != me.admin) { if(select.getAttribute("type") == "registered") { gfnStatus("채널 MEMBER 권한은 초대만 가능합니다."); return; } };

				//선택한 유저 정보 수집
				const empInfo = { usid : selectUSID, nm : select.querySelector('.nm').textContent, role_tp : "MEMBER" };

				//선택한 유저가 기존 채널에서 신규 유저일 경우 grpid 부여 
				if(me.grpid != undefined) Object.assign(empInfo, { grpid : me.grpid });

				//매니저 변경 모드 선택 시, 필터
				if(me.mode) {

					//유저 선택 데이터셋에 매니저를 제외한 유저가 1명 이상 누적될 때
					if(me.dataSet["selectEmp"].length > 1) {
						$(".alertInfo #alertInput").val("매니저를 한명 선택하세요.").fadeIn(500);

						//선택되어있는 1명의 유저만 선택, 선택 해제가능하도록 필터
						if(select.getAttribute('class') == "usid selected") { me.fnSelectEmp(false, empInfo, false); return; } 
						else return; 
					}
				}

				//유저 선택, 선택 해제
				if(select.getAttribute('class') != "usid selected") me.fnSelectEmp(true, empInfo, false);
				else me.fnSelectEmp(false, empInfo, false);
			});

			//더블 클릭 이벤트 1:1 선택에서만 가동
			select.addEventListener('dblclick', () => {
				const selectUSID = select.getAttribute("value");

				//현재 채널 로그인 유저와 관리자를 선택할 수 없도록 필터
				if(selectUSID == me.usid || selectUSID == me.admin) { gfnStatus("채널 MEMBER 권한은 초대만 가능합니다."); return; }

				//현재 채널 로그인 유저가 MEMBER인 경우, 기존 채널 유저 내보내기 불가
				if(me.usid != me.admin) { if(select.getAttribute("type") == "registered") { gfnStatus("채널 MEMBER 권한은 초대만 가능합니다."); return; } };

				//선택한 유저 정보 수집
				const empInfo = { usid : selectUSID, nm : select.querySelector('.nm').textContent, role_tp : "MEMBER" };

				//선택한 유저가 기존 채널에서 신규 유저일 경우 grpid 부여 
				if(me.grpid != undefined) Object.assign(empInfo, { grpid : me.grpid });

				//매니저 변경 모드 선택 시, 필터
				if(me.mode) {

					//유저 선택 데이터셋에 매니저를 제외한 유저가 1명 이상 누적될 때
					if(me.dataSet["selectEmp"].length > 1) {
						$(".alertInfo #alertInput").val("매니저를 한명 선택하세요.").fadeIn(500);

						//선택되어있는 1명의 유저만 선택, 선택 해제가능하도록 필터
						if(select.getAttribute('class') == "usid selected") { me.fnSelectEmp(false, empInfo, false); return; } 
						else return; 
					}
				}

				//유저 선택, 선택 해제
				if(select.getAttribute('class') != "usid selected") me.fnSelectEmp(true, empInfo, false);
				
				//유저 정보 수집 및 유저 카운트
				empList = me.fnGetEmpData();

				//작업하던 부분 메세지 창 안뜨도록 설정
				//유저 카운트(제한 설정)
				if(me.mode && empList.select.length == 1) { $(".alertInfo #alertInput").val("유저를 선택 후, 확인하세요."); return; };

				//타이틀 생성
				title = me.fnGetTitle(empList, 'confirm');

				//데이터 수집
				me.fnGetData(title, 'confirm');

				//컨펌 후 전송(2명 제외)
				if(me.dataSet["selectEmp"].length == 2) { me.fnExecuteData('confirmDual'); } 
				else { gfnStatus("더블 클릭은 1:1 대화만 가능합니다."); return; }		
			});

			//마우스 오른쪽 버튼 유저 정보 표시 이벤트
			select.addEventListener('mousedown', () => {
				if((event.button == 2) || (event.which == 3)) {
					if(document.querySelector(".empList .empInfoCard")) {
						//같은 사람 오른쪽 클릭 시, 정보 창 꺼지도록 구현
						const card = document.querySelector(".empList .empInfoCard");
						document.querySelector(".empList").removeChild(card); 
					} 
					var info = document.createElement("div");
					info.setAttribute("oncontextmenu", "return false");
					info.classList.add("empInfoCard");
					
					
					var infoPhoto = document.createElement("i");
					infoPhoto.classList.add("fas");
					infoPhoto.classList.add("fa-user")
					info.append(infoPhoto);

					var infoName = document.createElement("div");
					infoName.classList.add("empInfoCardName");
					infoName.textContent = select.querySelector(".nm").textContent;
					info.append(infoName);

					var infoNick = document.createElement("div");
					infoNick.classList.add("empInfoCardNick");
					infoNick.textContent = select.querySelector(".nick_nm").textContent;
					info.append(infoNick);

					var infoPhone = document.createElement("div");
					infoPhone.classList.add("empInfoPhone");
					infoPhone.textContent = select.querySelector(".phone").textContent;
					info.append(infoPhone);

					var infoEmail = document.createElement("div");
					infoEmail.classList.add("empInfoEmail");
					infoEmail.textContent = select.querySelector(".email").textContent;
					info.append(infoEmail);

					document.querySelector(".empList").append(info);

					//유저 프로필 연락처 클릭 이벤트
					const empInfoPhone = document.querySelector(".empList .empInfoCard .empInfoPhone");
					const empInfoEmail = document.querySelector(".empList .empInfoCard .empInfoEmail");
					empInfoPhone.addEventListener('click', () => {
						const value = select.querySelector(".phone").textContent;
						const textArea = document.createElement('textarea'); 
						document.body.appendChild(textArea); 
						textArea.value = value;
						textArea.select(); 
						document.execCommand('copy');
						document.body.removeChild(textArea);
					})
					
					empInfoEmail.addEventListener('click', () => {
						const value = select.querySelector(".email").textContent;
						const textArea = document.createElement('textarea'); 
						document.body.appendChild(textArea); 
						textArea.value = value;
						textArea.select(); 
						document.execCommand('copy');
						document.body.removeChild(textArea);
					})

					//유저 프로필 카드 클릭 이벤트
					const empInfoCard = document.querySelector(".empList .empInfoCard");
					empInfoCard.addEventListener('click', () => {
						document.querySelector(".empList").removeChild(empInfoCard);
					})
				}
			})
    	});
	}
	
	//선택된 유저 chips 해제 이벤트
	me.fnEHCancelEmp = function(userid) {
		const target = document.querySelector("." + userid + " div i");
		const targetRun = () => {
			//현재 채널 로그인 유저와 관리자를 선택할 수 없도록 필터
			if(userid == me.usid || userid == me.admin) { gfnStatus("채널 MEMBER 권한은 초대만 가능합니다."); return; }
			
			//선택된 유저 ID
			const empInfo = { usid : userid };

			//선택된 유저 ID 선택 해제
			me.fnSelectEmp(false, empInfo, false);
		}
		target.addEventListener('click', targetRun);
	}

	//채널 버튼 이벤트
	me.fnEHBtn = function() {
		const header = "메세지 채널";
		let empList  = undefined;
		let title    = undefined;
		//let count    = undefined;

		//채널 확인 버튼 confirm
		const confirm = document.getElementById('confirm');
		
		confirm.addEventListener('click', () => {	
			//유저 정보 수집 및 유저 카운트
            empList = me.fnGetEmpData();
			//작업하던 부분 메세지 창 안뜨도록 설정
			//유저 카운트(제한 설정)
			if(me.mode && empList.select.length == 1) { $(".alertInfo #alertInput").val("매니저를 위임할 유저를 선택한 뒤, 확인 버튼을 눌러주세요."); return; };

			//타이틀 생성
			title = me.fnGetTitle(empList, 'confirm');

			//데이터 수집
			me.fnGetData(title, 'confirm');

			//컨펌 후 전송(2명 제외)
			if(me.dataSet["selectEmp"].length == 2) { me.fnExecuteData('confirmDual'); 
			} else {
				gfnConfirm(header, title.title, function(bConfirm) {
					if(bConfirm) me.fnExecuteData('confirm');
					else return;
				})
			}
		})

		//채널 나가기 버튼 leave
		const leave = document.getElementById('leave');
		leave.addEventListener('click', () => {
			title = me.fnGetTitle(empList, 'leave');

			gfnConfirm(header, title.title, function(bConfirm) {
				if(bConfirm) {
					//유저가 2명이상(로그인유저 포함) 매니저인 경우, 매니저 변경 호출
					const selectedEmp = me.dataSet["selectedEmp"];
					if(me.role_tp == "MNGR" && selectedEmp.length > 1) {
						me.fnSelectManager();

					//나가기
					} else {
						me.dataSet["selectEmp"] = [];
						selectedEmp.forEach((row, idx) => {
							if(row.usid == me.usid) { me.dataSet["selectEmp"].push(row); };
						});

						//로그인 유저 선택 처리
						me.fnGetData(title, 'confirm');

						//내보내기 처리
						me.fnExecuteData('leave');

						document.getElementsByClassName("manageframeChat")[0].remove();
					}

				} else {
					return;
				}
			})
		});

		//채널 매니저 변경 버튼 selectManager
		const selectManager = document.getElementsByClassName('selectManager')[0];
		selectManager.addEventListener('click', () => {
			//매니저 변경 프레임셋 로드
			me.fnSelectManager();
		})

		//닫기 버튼 
		const manageChatClose = document.querySelector('.alertInfo i.fas.fa-times');
		manageChatClose.addEventListener('click', () => {
			document.getElementsByClassName("manageframeChat")[0].remove();
		})
	}
	
	me.fnEHClose = function() {
		const body = document.querySelector("body");
		body.addEventListener('click', function(event) {
			var target = event.target;

		});
	}
	if (typeof(me.fnInit) == 'function') me.fnInit();
	}
);
</script>