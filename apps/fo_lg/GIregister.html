<style>[pgmid='RTNlist'].framepage .userClass { 
width:100%; 
}</style>

<!-- HTML autogen start ---------------------------------------------- -->            
<div class="pageNav"></div>
<div class="pageTop"></div>
<div class="pageCond"></div>
<div class="pageGuide"></div>
<div class="pageContent flexRow">
    <div style="flex:1 1 calc(33% - 3em)" class="flexColumn">
        <div id="mst"></div>
        <!--<div id="det" class="flexColumn"></div>-->
        <div id="det"></div>
    </div>  
    <div id="list" style="flex:1 1 66%" class="flexColumn"></div>
</div>
<div class = "barcode" style="display:none">

<!-- HTML autogen end ---------------------------------------------- -->
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "fo_lg";
    var pgmid = "GIregister"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"ver":6.1,"upd_dt":"2022-08-31 10:54:04","remark":"소팅된 패킹리스트를 참조하여 출고명세서를 작성함","pgmid":"GIregister","proc_mst_id":"","pgm_stat":"Y","sort_seq":23,"app_pgmid":"fo_lg","shortcut":"","reg_dt":"2022-08-31 10:54:04","reg_usid":"jjr","pgm_nm":"●출고 등록","upd_usid":"jjr","pgm_tp":"UX","pgm_grp_nm":"출고","proc_mst_nm":"","app_pgm_nm":"물류","":"트랜젝션(메뉴)","crud":""};
me.dataDef["_pgm_func"]=[{"func_icon":"fas fa-search","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"조회","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"DB_R","remark":null,"pgmid":"GIregister","sort_seq":"1","funcid":"search","content":"본사 출고지시내역 조회","crud":"R","id":"0"},{"func_icon":"fas fa-file","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"신규","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"EH","remark":null,"pgmid":"GIregister","sort_seq":"2","funcid":"new","content":null,"crud":"R","id":"1"},{"func_icon":"extra fas fa-file","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"출고정보 일괄등록(배분표없음)","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"EH","remark":null,"pgmid":"GIregister","sort_seq":"3","funcid":"registerAll","content":"매장출고 일괄등록","crud":"R","id":"2"},{"func_icon":"fas fa-save","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"저장","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"DB_W","remark":null,"pgmid":"GIregister","sort_seq":"4","funcid":"save","content":"입력내용 임시저장","crud":"R","id":"3"},{"func_icon":"fas fa-check","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"발송완료","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"DB_W","remark":null,"pgmid":"GIregister","sort_seq":"5","funcid":"cfm","content":"출고지시 수락(확정) 또는 수시출고예정정보 등록","crud":"R","id":"4"},{"func_icon":"fas fa-check","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"일괄발송완료","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"EH","remark":null,"pgmid":"GIregister","sort_seq":"6","funcid":"cfmAll","content":"지시/예정목록 선택 -> 묶음 발송완료 처리","crud":"R","id":"5"},{"func_icon":"fas fa-print","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"출고송장","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"EH","remark":null,"pgmid":"GIregister","sort_seq":"7","funcid":"print","content":"지시내역 발행","crud":"R","id":"6"},{"func_icon":"fas fa-print","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"패킹라벨","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"EH","remark":null,"pgmid":"GIregister","sort_seq":"8","funcid":"print2","content":"수락(확정)내역 박스라벨 발행","crud":"R","id":"7"},{"func_icon":"fas fa-print","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"패킹송장","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"EH","remark":null,"pgmid":"GIregister","sort_seq":"9","funcid":"print3","content":"수락(확정)내역 박스송장 발행","crud":"R","id":"8"},{"func_icon":"extra fas fa-print","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"초도출하 패킹라벨 발행","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"EH","remark":null,"pgmid":"GIregister","sort_seq":"10","funcid":"print5","content":"배분지시에 따른 패킹라벨 발행","crud":"R","id":"9"},{"func_icon":"extra fas fa-ban","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"발송완료 취소","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"DB_W","remark":null,"pgmid":"GIregister","sort_seq":"11","funcid":"cfmCancel","content":"발송완료 취소(발송완료전 상태로 돌아감)","crud":"R","id":"10"},{"func_icon":"extra fas fa-trash","reg_dt":"2022-08-31 10:54:04","reg_usid":"","func_nm":"예정삭제","upd_usid":"","upd_dt":"2022-08-31 10:54:04","func_tp":"DB_W","remark":null,"pgmid":"GIregister","sort_seq":"12","funcid":"reject","content":"출고지시 불가처리(거부) 또는 수신출고예정정보 삭제처리","crud":"R","id":"11"}];
me.dataDef["_pgm_data"] = {};
me.dataDef["_pgm_data"]["pageCond"]={"sort_seq":"1","data_id":"pageCond","data_nm":"조회조건","data_icon":null,"component_pgmid":"aweForm","component_option":null,"inout_tp":"IN","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_ord_no","colnm":"물류지시번호","dtype":"text","etype":"txt","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":"보내는창고","colid":"shopcd","colnm":"창고코드","dtype":"text","etype":"sel","attr":"pk","defval":"gUserinfo.deptcd","w":"12","h":null,"refcd":"whcd","option":"all:shopcd::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":"받는매장","colid":"whcd","colnm":"매장코드","dtype":"text","etype":"sel","attr":null,"defval":null,"w":"12","h":null,"refcd":"whcd","option":"all:whcd::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"dist_nm","colnm":"배분명","dtype":"text","etype":"txt","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_content","colnm":"배송정보","dtype":"text","etype":"txt","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":"이동일","colid":"rtn_dt_from","colnm":"일자From","dtype":"ymd","etype":"txt","attr":"ymd","defval":"date(\"today\")","w":"8","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":"이동일","colid":"rtn_dt_to","colnm":"일자To","dtype":"ymd","etype":"txt","attr":"ymd","defval":"date(\"last\")","w":"8","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"cd_stat","colnm":"상태","dtype":"text","etype":"sel","attr":null,"defval":null,"w":"10","h":null,"refcd":"LG_ORD_STAT","option":"multi:cd_stat::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_end_yn","colnm":"완결","dtype":"text","etype":"sel","attr":null,"defval":null,"w":null,"h":null,"refcd":"[\"Y\",\"N\"]","option":"all:ord_end_yn::cd","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"}]};
me.dataDef["_pgm_data"]["list"]={"sort_seq":"2","data_id":"list","data_nm":"지시/예정목록","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"chk"},"inout_tp":"OUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_ord_no","colnm":"물류지시번호","dtype":"text","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":"count('lg_ord_no')+\"건\"","remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"cd_stat","colnm":"상태","dtype":"text","etype":"sel","attr":"readonly ","defval":null,"w":null,"h":null,"refcd":"LG_ORD_STAT","option":"all:cd_stat::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_dt","colnm":"물류일자","dtype":"ymd","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_tp","colnm":"물류유형","dtype":"text","etype":"sel","attr":"readonly ","defval":null,"w":null,"h":null,"refcd":"LG_TP_I","option":"sel:lg_tp::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"dist_no","colnm":"배분번호","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"dist_nm","colnm":"배분명","dtype":"text","etype":null,"attr":"readonly","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_content","colnm":"배송정보","dtype":"text","etype":null,"attr":"readonly","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":"받는 매장","colid":"to_whcd","colnm":"코드","dtype":"text","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":"받는 매장","colid":"to_wh_nm","colnm":"명","dtype":"text","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":null,"section_icon":null,"colgrp":"창고출고","colid":"box_cnt","colnm":"박스수","dtype":"num","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"10"},{"sort_seq":12,"section":null,"section_icon":null,"colgrp":"창고출고","colid":"goods_qty","colnm":"출고수량","dtype":"num","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"},{"sort_seq":13,"section":null,"section_icon":null,"colgrp":"매장인수/입고","colid":"box_cnt_2","colnm":"박스수","dtype":"num","etype":null,"attr":"readonly","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"12"},{"sort_seq":14,"section":null,"section_icon":null,"colgrp":"매장인수/입고","colid":"goods_qty_2","colnm":"확정수량","dtype":"num","etype":null,"attr":"readonly","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"13"},{"sort_seq":15,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_dt","colnm":"매장접수일","dtype":"ymd","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"14"},{"sort_seq":16,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_usid","colnm":"매장담당자","dtype":"text","etype":"sel","attr":"readonly ","defval":null,"w":null,"h":null,"refcd":"USID","option":"sel:rcv_usid::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"15"},{"sort_seq":17,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_end_yn","colnm":"완결","dtype":"text","etype":null,"attr":"readonly ","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"16"}]};
me.dataDef["_pgm_data"]["mst"]={"sort_seq":"3","data_id":"mst","data_nm":"지시/예정내역","data_icon":null,"component_pgmid":"aweForm","component_option":null,"inout_tp":"INOUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_ord_no","colnm":"물류지시번호","dtype":"text","etype":"raw","attr":"pk readonly","defval":"TBD","w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_tp","colnm":"물류유형","dtype":"text","etype":"sel","attr":"keycol","defval":null,"w":null,"h":null,"refcd":"LG_TP_I","option":"sel:lg_tp::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_dt","colnm":"물류일자","dtype":"ymd","etype":"txt","attr":"ymd","defval":"date(\"today\")","w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":"보낸창고","colid":"from_whcd","colnm":"코드","dtype":"text","etype":"raw","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":"보낸창고","colid":"from_wh_nm","colnm":"명","dtype":"text","etype":"raw","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":"받는 매장","colid":"to_whcd","colnm":"코드","dtype":"text","etype":"txt","attr":"keycol pop","defval":null,"w":null,"h":null,"refcd":"whcd","option":"sel:to_whcd:to_wh_nm:cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":"받는 매장","colid":"to_wh_nm","colnm":"명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":"whcd","option":"sel:to_whcd:to_wh_nm:cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_fileid","colnm":"배송구분","dtype":"text","etype":"sel","attr":"keycol","defval":null,"w":"6","h":null,"refcd":"LG_DV","option":"sel:ord_fileid::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_content","colnm":"배송정보","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"20","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"20","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":null,"section_icon":null,"colgrp":null,"colid":"cd_stat","colnm":"상태코드","dtype":"text","etype":"sel","attr":"readonly ","defval":"\"D\"","w":null,"h":null,"refcd":"LG_ORD_STAT","option":"sel:cd_stat::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"10"},{"sort_seq":12,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_end_yn","colnm":"완결","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"}]};
me.dataDef["_pgm_data"]["det"]={"sort_seq":"4","data_id":"det","data_nm":"상품내역","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"chk","func":[{"funcid":"search","func_nm":"패킹가져오기","func_icon":"fas fa-search"},{"funcid":"makePack","func_nm":"패킹만들기","func_icon":"fas fa-box"},{"funcid":"delRow","func_nm":"줄삭제","func_icon":"fas fa-minus"},{"funcid":"changeQty","func_nm":"수량변경","func_icon":"fas fa-save"},{"funcid":"selprint","func_nm":"일부패킹발행","func_icon":"fas fa-print"},{"funcid":"seasonOrd2","func_nm":"**시즌별로쪼개기**","func_icon":"fas fa-box"},{"funcid":"boxOrd","func_nm":"박스별로분할","func_icon":"fas fa-box"},{"funcid":"pda","func_nm":"박스PDA스캔","func_icon":""}]},"inout_tp":"INOUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"box_no","colnm":"패킹번호","dtype":"text","etype":"txt","attr":"rowSpan readonly keycol ","defval":null,"w":"12","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"box_barcd","colnm":"패킹바코드","dtype":"text","etype":"txt","attr":"rowSpan readonly","defval":null,"w":"12","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":"\"Box:\"+count('box_barcd')+\"개\"","remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"goods_seq","colnm":"순번","dtype":"text","etype":"txt","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"goods_cd","colnm":"상품코드","dtype":"text","etype":"txt","attr":"readonly ","defval":null,"w":"11","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"qty","colnm":"출고수량","dtype":"num","etype":"txt","attr":null,"defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"}]};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */

    /* 사용자초기화 */
    me.fnInitExtra=function() { 
        me.fnNew(); //화면이 열리면 신규등록 모드 호출
        
        //Notice 알림 혹은 내 작업 내역 클릭 시, gParam["pgmLog"]로 lg_ord_no를 받아 페이지 열림
        if(!isNull(gParam) && !isNull(gParam["pgmLog"])) {
            var lg_ord_no = gParam["pgmLog"];
            me.pageObj["pageCond"].setVal("lg_ord_no", lg_ord_no);
            setTimeout(function() { me.fnSearch() }, 100);
            setTimeout(function() { me.fnSearchOrd(lg_ord_no) }, 100);
            gParam["pgmLog"] = null;
        }
    }
    
    
    /* 이벤트핸들러 */
    me.fnEH=function(component, evt, row, col, val) { 
        //console.log(evt+","+row+","+col+","+val);
        //화면기능버튼이 눌리면 
        if (component==me.pageObj["_pageFunc"]){ 
            if(typeof(me[col])=='function') me[col](); //col=기능명 me["fnSearch"]()=me.fnSearch(); 
        }
        
        //조회조건 받는곳 데이터를 마스터의 받는곳 데이터에 세팅
        if(component==me.pageObj["pageCond"]){ 
            if(evt=="change") {
                /*
                var whcd = me.pageObj.pageCond.exportData()[0].whcd; 
                me.pageObj.mst.setVal("to_whcd", whcd); //cd
                //console.log(me.pageObj.pageCond.exportData()[0]);
                
                var whcd_nm = gfnCdNm("whcd",whcd,"nm"); 
                me.pageObj.mst.setVal("to_wh_nm",whcd_nm); //nm
                
                if(whcd==""){
                    me.pageObj.mst.setVal("to_wh_nm", "");
                }*/
                /*
                var whcd_arr = subset(gds.comcd,"grpcd","whcd"); 
                for(var i = 0; i<whcd_arr.length; i++){
                    if(whcd==whcd_arr[i].cd){
                        me.pageObj.mst.setVal("to_wh_nm", whcd_arr[i].nm); //nm
                    }
                }
                */
            }
        }
        
        //목록 클릭시 지시내역 상세조회
        if (component==me.pageObj["list"]){ 
            if(evt=="focus") {
                if(row >= 0) {
                    //var goods_cnt = component.getVal(row,"goods_cnt");
                    //console.log(goods_cnt);
                    var lg_ord_no = component.getVal(row,"lg_ord_no");
                    me.fnSearchOrd(lg_ord_no);
                } 
            }
        }
        //등록-상품목록 상세
        if (component==me.pageObj["det"]){ 
            if(evt=="componentFunc") {
                //패킹가져오기
                if(row=="search") {
                    me.fnSearchPack();    
                }
                if(row=="makePack"){
                    me.fnMakePack();
                }
                //수량변경 저장
                if(row=="changeQty"){ 
                    me.fnSave();
                }
                //시즌별로쪼개기(숨김)  {"funcid":"seasonOrd","func_nm":"시즌별로쪼개기","func_icon":"fas fa-box"},
                if(row=="seasonOrd"){
                    me.fnSeasonOrd();
                }
                //시즌별로쪼개기
                if(row=="seasonOrd2"){
                    me.fnSeasonOrd2();
                }
                //박스별로쪼개기
                if(row=="boxOrd"){
                    me.fnBoxOrd();
                }
                if(row=="pda"){
                    me.fnPda();
                }
                //줄삭제
                if(row=="delRow") { 
                    
                    //선택된 row의 박스번호와 박스번호가 같은 row는 전부 선택하여 delRow해줌 
                    var box_nos = extract(me.pageObj.det.exportData("selected"),"box_no","distinct");
                    for(var i=0; i < me.pageObj.det.countRow(); i++) {
                        var rowid = me.pageObj.det.getNodeId(i);
                        if(inStr(box_nos,me.pageObj.det.getVal(rowid,"box_no")) >= 0) {
                            me.pageObj.det.selectRow(rowid);
                        }
                    }
                    component.delRow();
                    
                    if(component.exportData("selected")[0].crud == "D") { 
                        
                        var args = me.pageObj["mst"].exportData()[0];
                        var invar = JSON.stringify(args);
                        gfnTx(appid+"."+pgmid,"searchprtcnt",{INVAR:invar},function(OUTVAR){ //발행횟수 조회
                            console.log(OUTVAR);
                            if(OUTVAR.rtnCd=="OK") {
                                if(OUTVAR.prtcnt[0].print_cnt>0){
                                    gfnAlert("삭제확인","이미 패킹송장 또는 패킹라벨이 인쇄되었던 패킹입니다. 새로운 패킹등록시, 재발행해주세요. ");
                                }
                            } else {
                                gfnAlert("조회오류",OUTVAR.rtnMsg);
                            }
                        });
                    }
                }
                //일부패킹발행(선택한 패킹 재발행)
                if(row == "selprint"){ 
                    var box_nos = extract(me.pageObj.det.exportData("selected"),"box_no","distinct");
                    for(var i=0; i < me.pageObj.det.countRow(); i++) {
                        var rowid = me.pageObj.det.getNodeId(i);
                        if(inStr(box_nos, me.pageObj.det.getVal(rowid,"box_no")) >= 0) {
                            me.pageObj.det.selectRow(rowid);
                            var sellist = me.pageObj.det.exportData("selected");
                        }
                    }
                    me.fnPrintSel(sellist);
                }//endif - selprint
            }
        }
    }
    
    // 시즌별로 쪼개기(숨김)
    me.fnSeasonOrd=function() {
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("확인","출고지시/예정내역이 선택되지 않았습니다.");
            return;
        } 
        function _fnSeasonOrd(){
            var args = me.pageObj["mst"].exportData()[0];
            console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"seasonOrd",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    me.pageObj["list"].reset();
                    me.pageObj["mst"].reset();
                    me.pageObj["det"].reset();
                    gfnAlert("시즌별로 쪼개기","시즌별로 문서가 나누어졌습니다.");
                    me.fnSearch();
                } else {
                    gfnAlert("오류",OUTVAR.rtnMsg);
                }
            });    
        }
        
        var cd_stat = me.pageObj.mst.getVal("cd_stat");
        if(cd_stat == "D" || cd_stat =="X") {
            gfnConfirm("시즌별로 쪼개기","문서["+me.pageObj.mst.getVal("lg_ord_no")+"]를 시즌별로 나누시겠습니까?",function(rtn){
               if(rtn) _fnSeasonOrd(); 
            });
        }
        else{
            gfnAlert("실패","임시(D) 또는 작업취소(X)상태일 경우에만 가능합니다.");
        }
    }
    // 시즌별로 쪼개기
    me.fnSeasonOrd2=function() {
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("확인","출고지시/예정내역이 선택되지 않았습니다.");
            return;
        } 
        function _fnSeasonOrd2(){
            var args = me.pageObj["mst"].exportData()[0];
            console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"seasonOrd2",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    me.pageObj["list"].reset();
                    me.pageObj["mst"].reset();
                    me.pageObj["det"].reset();
                    gfnAlert("시즌별로 쪼개기","시즌별로 문서가 나누어졌습니다.");
                    me.fnSearch();
                } else {
                    gfnAlert("오류",OUTVAR.rtnMsg);
                }
            });    
        }
        
        var cd_stat = me.pageObj.mst.getVal("cd_stat");
        if(cd_stat == "D" || cd_stat =="X") {
            gfnConfirm("시즌별로 쪼개기","문서["+me.pageObj.mst.getVal("lg_ord_no")+"]를 시즌별로 나누시겠습니까?",function(rtn){
               if(rtn) _fnSeasonOrd2(); 
            });
        }
        else{
            gfnAlert("실패","임시(D) 또는 작업취소(X)상태일 경우에만 가능합니다.");
        }
    }
    
    //박스별로 쪼개기
    me.fnBoxOrd=function() {
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("확인","출고지시/예정내역이 선택되지 않았습니다.");
            return;
        } 
        
        
        var cd_stat = me.pageObj.mst.getVal("cd_stat");
        if(cd_stat !== "D" && cd_stat !=="X") {
            gfnAlert("실패","임시(D) 또는 작업취소(X)상태일 경우에만 가능합니다.");
            return;
        }
        
        var box_nos = extract(me.pageObj.det.exportData("selected"),"box_no","distinct");
        if(box_nos.length == 0) {
            gfnAlert("실패","분할할 박스를 선택해주세요.");
            return;
        }
        
        function _fnBoxOrd(){
            var args = me.pageObj["mst"].exportData()[0];
            var arr = [];
            for(let i=0;i<box_nos.length;i++){
                arr.push({'box_no': box_nos[i], 'lg_ord_no': args.lg_ord_no});
            }
            args.det = arr;
            
            console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"boxOrd",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    me.fnSearch();
                } else {
                    gfnAlert("조회오류",OUTVAR.rtnMsg);
                }
            });
        }
        
        gfnConfirm("박스별로 분할","문서["+me.pageObj.mst.getVal("lg_ord_no")+"]를 박스별로 나누시겠습니까?",function(rtn){
           if(rtn) _fnBoxOrd(); 
        });
        
        /*** 팝업사용 ***
        var lg_ord_no = me.pageObj.mst.exportData()[0].lg_ord_no;
        var searchPop = $("<div id='soPop' class='framepage active'></div>");
        var searchPopup = null;
        gfnLoad("fo_lg","GIregisterPop",searchPop,function(){
            searchPopup = gfnPopup("박스별로 분할",searchPop,{width:650, height:800});
        })

        function _fnBoxOrd(arrPacklist) {
            // var det = me.pageObj.det.exportData();
            // det = det.concat(arrPacklist);
            // me.pageObj.det.importData(det,"C");
            if(!isNull(searchPopup)) searchPopup.dialog("close");
            me.fnSearch();
            // me.pageObj.det.total("top");
        }
        //팝업호출해서 열기.. 
        gObj.lg_ord_no = lg_ord_no;
        gObj.fnBoxOrd = _fnBoxOrd; 
        **************/
        
        
        
    }
    
    me.fnPda=function() {
        // if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
        //     gfnAlert("확인","출고지시/예정내역이 선택되지 않았습니다.");
        //     return;
        // } 
        
        // var box_barcds = extract(me.pageObj.det.exportData(),"box_barcd");
        // // for(let i=0;i<box_nos.length;i++) {
        // //     box_nos[i] = box_nos[i].replace(/-/gi,'');
        // // }
        
        // gObj.box_barcds = box_barcds;
        
        //openpage
        var popId = null;
		function _fnOpenPage(boxs) {
            var searchPopup = $("#"+popId);
            if(!isNull(searchPopup)) gMDI.closeTab(popId);
            gfnAlert("분할 성공","박스가 분할 되었습니다.");
            me.fnSearch();
            
            // //선택초기화
            // me.pageObj.det.selectRows(undefined, false);
            // //선택
            // for(let i=0;i<boxs.length;i++){
            //     for(let j=0;j<box_barcds.length;j++){
            //         if(boxs[i] == box_barcds[j]){
            //             var nodeid = me.pageObj.det.getNodeId(j);
            //             me.pageObj.det.selectRow(nodeid);
            //         }
            //     }
            // }
            
        }
        gObj.from_whcd = me.pageObj.pageCond.exportData()[0].shopcd;
        gObj.to_whcd = me.pageObj.pageCond.exportData()[0].whcd;
        if(isNull(gObj.from_whcd) || isNull(gObj.to_whcd)) {
            gfnAlert("확인","보내는 창고 또는 받는매장이 선택되지 않았습니다. 조회조건에서 선택 후 진행해주세요.");
            return;
        }
		gObj.fnOpenPage = _fnOpenPage;  
		gMDI.openPage("GIpda(M)","출고등록 박스스캔",function(){},"fo_lg");
		popId = "page"+gMDI.idx;
    }
    
    //search: 출고문서 목록조회 
    me.fnSearch=function() {
        if( !me.pageObj["pageCond"].chkValid() ) return;
        var args = me.pageObj["pageCond"].exportData()[0];
        console.log(args);
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"search",{INVAR:invar},function(OUTVAR){
            console.log(OUTVAR);
            me.pageObj["list"].reset();
            me.pageObj["mst"].reset();
            me.pageObj["det"].reset();
            
            if(OUTVAR.rtnCd=="OK") {
                me.pageObj["list"].importData(OUTVAR.list);
                me.pageObj.list.total("top");
                me.pageObj.list.autoSizeAllColumns(true);
            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
            //console.log(OUTVAR.list);
        });
    }
    
    //searchOrd: 문서내역 조회
    me.fnSearchOrd=function(lg_ord_no) {
        if( !me.pageObj["pageCond"].chkValid() ) return;
        var args = me.pageObj["pageCond"].exportData()[0];
        args.lg_ord_no = lg_ord_no
        //console.log(args);
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"searchOrd",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                me.pageObj["mst"].importData(OUTVAR.mst);
                me.pageObj["det"].importData(OUTVAR.det);
                me.pageObj.det.total("top");
                
                //로그 저장(프로그램ID, pageCond, lg_ord_no, 로그 타입);
                gfnLog(pgmid, args, lg_ord_no, "read");
                
            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
        });
    }


    //fnSearchPack: 패킹박스 목록검색 및 가져오기
    me.fnSearchPack=function() {
        var shopcd = me.pageObj.pageCond.getVal("shopcd");
        var searchPop = $("<div id='soPop' class='framepage active'></div>");
        var searchPopup = null;
        gfnLoad("fo_pos","popupPacklist",searchPop,function(){
            searchPopup = gfnPopup("패킹 리스트",searchPop,{width:650, height:800});
        })

        function _fnSearchPack(arrPacklist) {
            var det = me.pageObj.det.exportData();
            det = det.concat(arrPacklist);
            me.pageObj.det.importData(det,"C");
            if(!isNull(searchPopup)) searchPopup.dialog("close");
            me.pageObj.det.total("top");
        }
        //팝업호출해서 열기.. 
        gParam.whcd = shopcd;
        gParam.myBoxlist = extract(me.pageObj.det.exportData(),"box_no","distinct");
        //console.log(gParam.myBoxlist);
        gParam.fnCallback = _fnSearchPack; 
    }
  
    //{"funcid":"makePack", "func_nm":"패킹만들기","func_icon":"fas fa-box"},
    //fnMakePack: 패킹만들기
    me.fnMakePack=function() {
        if( me.pageObj["det"].chkValid() ) {
            gfnAlert("패킹확인","이미 패킹정보가 존재합니다.");
            return;
        }
        if(me.pageObj.mst.getVal("cd_stat") != "D"){
            gfnAlert("패킹확인","임시상태의 문서만 [패킹만들기]가 가능합니다.");
            return;
        }
        var shopcd = me.pageObj.pageCond.getVal("shopcd"); //창고코드
        var to_whcd = me.pageObj.mst.getVal("to_whcd"); //매장코드
        var lg_ord_no = me.pageObj.mst.getVal("lg_ord_no");
        var searchPop = $("<div id='soPop' class='framepage active'></div>");
        var searchPopup = null;
        gfnLoad("fo_lg","popupMakePack",searchPop,function(){
            searchPopup = gfnPopup("패킹만들기",searchPop,{width:550, height:800});
        })
        function _fnMakePack() {
            me.fnSearch(); //목록재조회
            if(!isNull(searchPopup)) searchPopup.dialog("close");
        }
        //팝업호출해서 열기.. 
        gParam.whcd = shopcd;
        gParam.to_whcd = to_whcd;
        gParam.lg_ord_no = lg_ord_no;
        //gParam.myBoxlist = me.pageObj.det.exportData();
        gParam.fnCallback = _fnMakePack; 
    }  
  
  
  
    // cfmAll : 묶음 발송완료 처리
    me.fnCfmAll = function(){

        var rtn = me.pageObj.list.exportData("selected");
        if(rtn.length < 1) {
            gfnAlert("선택확인","선택된 예정목록이 없습니다.");
            return;
        }
        //var to_whcd = rtn[0].to_whcd;
        for(var i = 0; i<rtn.length; i++){
            if(rtn[i].cd_stat!="D"){
                gfnAlert("선택확인","'임시'상태의 문서만 발송완료처리가 가능합니다.");
                return;
            }
            // if(to_whcd != rtn[i].to_whcd){
            //     gfnAlert("선택확인","받는매장이 같아야 묶음발송처리가 가능합니다.");
            //     return;
            // }
        }
        var shopcd = me.pageObj.pageCond.getVal("shopcd");
        var searchPop = $("<div id='soPop' class='framepage active'></div>");
        var searchPopup = null;
        gfnLoad("fo_lg","cfmAllpopup",searchPop,function(){
            searchPopup = gfnPopup("묶음발송완료처리",searchPop,{width:600, height:400});
        })
        function _fncfmAll(cfmAll) {
            if(!isNull(searchPopup)) searchPopup.dialog("close");
            me.fnSearch(); //목록재조회
        }
        gParam.whcd = shopcd;
        gParam.rtn = rtn;
        gParam.fnCallback = _fncfmAll;
    }
    
    /*
    me.fnCfmAllTest = function(){
        
        var rtn = me.pageObj.list.exportData("selected");
        
        if(rtn.length < 1) {
            gfnAlert("선택확인","선택된 예정목록이 없습니다.");
            return;
        }
        //console.log(rtn);
        
        function _fnCfm(){
            
            var args = me.pageObj.mst.exportData()[0];
            args.list = rtn; 
            //console.log(me.rtn);
            var invar = JSON.stringify(args);
            console.log(args);
            gfnTx(appid+"."+pgmid,"cfmAllTest",{INVAR:invar},function(OUTVAR){
                //console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    //me.fnCallback();
                    gfnAlert("발송성공","발송 완료하였습니다.");
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
        }
        
        gfnConfirm("발송확인","예정정보를 묶음발송하시겠습니까?",function(rtnn){
            if(rtnn) _fnCfm();
        });
    }
    */
    //fnRegisterAll: 매장출고 일괄등록할 페이지
    me.fnRegisterAll=function() {
        var shopcd = me.pageObj.pageCond.getVal("shopcd");
        var lg_ord_no = me.pageObj.mst.getVal("lg_ord_no");
        gMDI.openPage("GIregisterAllshop","매장출고 일괄등록",undefined,"fo_lg");
        
        function _fnRegisterAll(registerAll) {
            console.log(registerAll);
            me.fnSearch(); //목록재조회
        }
        gParam.whcd = shopcd;
        //gParam.lg_ord_no = lg_ord_no;
        gParam.fnCallback = _fnRegisterAll;
    }
    
    //save:대상확정 
    me.fnSave=function() {
        if( !me.pageObj["mst"].chkValid() ) return;
        if( !me.pageObj["det"].chkValid() ) return;
        
        function _fnSave(){
            
            var args = me.pageObj["mst"].exportData()[0];
            args.from_whcd = me.pageObj.pageCond.getVal("shopcd");
            args.det = me.pageObj["det"].exportData();
            console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"save",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    
                    var lg_ord_no = OUTVAR.lg_ord_no;
                    gfnAlert("저장성공","입력한 정보가 저장되었습니다.");
                    me.fnSearch(); //목록재조회
                    me.fnSearchOrd(lg_ord_no);
                    
                    //로그 저장(프로그램ID, mst, lg_ord_no, 로그 타입, det의 개수 혹은 각각의 det);
                    const sub = args.det.length;
                    gfnLog(pgmid, args, lg_ord_no, "save", sub);
                    
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
        }
        
        var ch_cd_stat = me.pageObj["mst"].getVal("cd_stat");
        if(ch_cd_stat != "D"){
            gfnAlert("저장확인","수정할 수 없는 상태의 출고문서입니다. 임시저장 상태에서만 수정할 수 있습니다.");
        }else{
            gfnConfirm("저장확인","예정정보를 저장하시겠습니까?",function(rtn){
                if(rtn) _fnSave();
            }); 
        }
    }

/*
    //reject:지시불가/예정삭제 
    me.fnReject=function() {
        //VALIDATION  : 
        if( !me.pageObj["pageCond"].chkValid() ) return;
        //REQUEST OBJ : 
        var args = me.pageObj["pageCond"].exportData()[0];
        //SERVICE CALL: 
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"reject",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                //서비스 후처리 : 
                gfnAlert("성공","입력한 정보가 저장되었습니다."); 
                me.fnSearch();
                me.fnNew();
            } else {
                gfnAlert("오류",OUTVAR.rtnMsg);
            }
        });
    }
 */   
    //new: 신규문서 생성
    me.fnNew=function() {
        me.pageObj.mst.reset();
        me.pageObj.det.reset(); 
    }
    
    //reject: 예정정보 삭제
    me.fnReject=function() {
        //상태에 따라 삭제가능여부 validation
        if (false) {
            gfnAlert("삭제확인","삭제할 수 없는 상태입니다.");
            return;
        } 
        function _fnReject() {
            var args = me.pageObj["mst"].exportData()[0];
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"reject",{INVAR:invar},function(OUTVAR){
                //console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    var lg_ord_no = me.pageObj["mst"].getVal("lg_ord_no");
                    gfnAlert("성공","출고 예정정보가 삭제되었습니다.");
                    me.fnSearch(); //목록재조회
                    me.fnSearchOrd(lg_ord_no);
                    
                     //로그 저장(프로그램ID, mst, lg_ord_no, 로그 타입, det의 개수 혹은 각각의 det);
                    const sub = args.det.length;
                    gfnLog(pgmid, args, lg_ord_no, "reject", sub);
                    
                } else {
                    gfnAlert("오류",OUTVAR.rtnMsg);
                }
            }); 
        }
        
        var cfm_yn = me.pageObj.mst.getVal("cd_stat");
        if(cfm_yn != "D") gfnAlert("삭제 실패","이미 발송완료된 예정정보는 삭제할 수 없습니다.");
        else{
                gfnConfirm("삭제확인","출고 예정정보를 삭제하시겠습니까?",function(rtn){
                if(rtn) _fnReject();
            }); 
        }
    }
/*    
    //cfm : 발송완료
    me.fnCfm=function() {
        var selected = me.pageObj.list.selectedRows();
        var args = me.pageObj["list"].exportData("selected")[0];
        //var args = me.pageObj["list"].exportData()[0];
        
        if(isNull(args)){
            gfnAlert("발송확인","지시/예정목록에서 지시/예정내역을 선택해주세요.");
        }else{
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"cfm",{INVAR:invar},function(OUTVAR){
                //console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("발송성공","발송 완료하였습니다.");
                    me.fnSearch();
                } else {
                    gfnAlert("발송실패",OUTVAR.rtnMsg);
                }
            });
        }
    }
*/

    //cfm : 발송완료
    me.fnCfm=function() {
        
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("발송완료 확인","출고지시/예정내역이 선택되지 않았습니다.");
            return;
        } 
        if( !me.pageObj["mst"].chkValid() ) return;
        if( !me.pageObj["det"].chkValid() ) return;
        //gfnAlert("패킹정보 확인", "패킹정보가 있어야 발송완료가 가능합니다. <br>[패킹만들기]로 패킹정보를 생성해주세요.");
        
        function _fnCfm(){
            //컨펌시 저장과 동일한 로직
            var args = me.pageObj["mst"].exportData()[0];
            args.from_whcd = me.pageObj.pageCond.getVal("shopcd");
            args.det = me.pageObj["det"].exportData();
            
            console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"cfm",{INVAR:invar},function(OUTVAR){
                //console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    
                    var lg_ord_no = OUTVAR.lg_ord_no;
                    gfnAlert("발송성공","발송 완료하였습니다.");
                    me.fnSearch(); //목록재조회
                    me.fnSearchOrd(lg_ord_no);
                    
                    //로그 저장
                    const sub = args.det.length;
                    gfnLog(pgmid, args, lg_ord_no, "confirm", sub);
                    
                    //알림 전송
                    const app         = "RTNaccept";       //타겟 APP
                    const empList     = args.to_whcd;      //메세지 전송 대상(DEPTCD, USERID)
                    const msgKey      = lg_ord_no;         //타겟 APP 참조키
                    const from_wh_nm  = args.from_wh_nm;   //보내는 곳 이름 할당
            
                    const register    = gUserinfo.userid;
                    const register_nm = gUserinfo.usernm;
            
                    const pgm_nm      = subset(gds.menu, "pgmid", me.pgmid)[0].pgm_nm;
            
                    const msg         = "[" + from_wh_nm + "점]에서 #" + lg_ord_no + " 건이 [" + pgm_nm + "] 되었습니다.<br>(등록자 : " + register_nm +")";
                    gfnNotice(empList, app, msgKey, msg, register);
                    
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            }); 
            
        }
        
        var cfm_yn = me.pageObj.mst.getVal("cd_stat");
        if(cfm_yn == "Y" || cfm_yn == "F") gfnAlert("발송처리 확인","이미 발송완료된 예정정보입니다.");
        else{
                var selected = me.pageObj.list.selectedRows();
                var args = me.pageObj["list"].exportData("selected")[0];
            
                if(isNull(args)){
                    gfnAlert("발송확인","지시/예정목록에서 지시/예정내역을 선택해주세요.");
                }else{
                    gfnConfirm("발송확인","출고 예정정보를 발송하시겠습니까?",function(rtn){
                        if(rtn) _fnCfm();
                    }); 
                }
        }
    }
    
    //cfmCancel : 발송완료 취소
    me.fnCfmCancel=function() {
        
        function _fnCfmCancel() {
            var args = me.pageObj["mst"].exportData()[0];
            args.det = me.pageObj["det"].exportData();
            var invar = JSON.stringify(args);
            console.log(args);
            gfnTx(appid+"."+pgmid,"cfmCancel",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    var lg_ord_no = me.pageObj["mst"].getVal("lg_ord_no");
                    gfnAlert("성공","지시내용에 대해 발송취소 처리 되었습니다.");
                    me.fnSearch(); //목록재조회
                    me.fnSearchOrd(lg_ord_no);
                } else {
                    gfnAlert("오류",OUTVAR.rtnMsg);
                }
            }); 
        }
        
        //상태에 따라 취소가능여부 validation
        var cfm_yn = me.pageObj.mst.getVal("cd_stat");

        if(cfm_yn != "Y") gfnAlert("발송취소 실패","발송완료 상태의 이동문서만 발송 취소가 가능합니다.");
        else{
            gfnConfirm("발송취소 확인","발송을 취소하시겠습니까?",function(rtn){
                if(rtn) _fnCfmCancel();
            }); 
        }
    }
    
    
    //print : 출고송장 발행
    me.fnPrint=function() {
        
        var rtn = me.pageObj.list.exportData("selected");
        if(rtn.length < 1){
            gfnAlert("출고송장 발행확인","지시/예정목록에서 지시/예정내역이 선택되지 않았습니다.");
            return;
        }
        
        for(var i = 0; i<rtn.length; i++){
            if(rtn[i].cd_stat == "D"){
                gfnAlert("선택확인","발송완료된 문서만 출고송장 발행이 가능합니다.");
                return;
            }
        }        
        /*
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("출고송장 발행확인","지시/예정목록에서 지시/예정내역이 선택되지 않았습니다.");
            return;
        } 
        */
        var args = me.pageObj["pageCond"].exportData()[0];
        var args_mst = me.pageObj["mst"].exportData()[0]; // lg_dt: 물류일자, to_whcd: 받는창고
        var args_det = me.pageObj["det"].exportData(); //box_barcd: 박스번호,바코드
        var selected = me.pageObj.list.selectedRows();
        var args_list = me.pageObj["list"].exportData("selected")[0];

        //console.log(args_det);
        
        var lg_tp = args_mst.lg_tp;
        var lg_tp_nm = gfnCdNm("LG_TP_I",lg_tp,"nm");
        var box_lst = extract(args_det, "box_barcd", "distinct");
        var box_no_lst = extract(args_det, "box_no", "distinct"); //매장 박스번호
        
        var j = 0;

        if(rtn.length === 1) { //예정목록 중 한개 선택
            
            var html = "<html>";
            //사이즈 조절, css
            html += "<head><style type='text/css'> .boxLabel .tfhid{font-size:5px; border-left:hidden; border-right:hidden;} .boxLabel {border-collapse:collapse; border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;} .boxLabel .tag{ background-color: rgb(220, 220, 220); border-top: 3px black solid;}.boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; }.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; } /*.boxLabel .goods{border-right: 3px black solid;}*/ .boxLabel th{ font-size:12px; border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;} .footer{padding: 0; text-align: center; vertical-align: middle; line-height: normal; margin: 0; position: fixed; bottom: 0px; width: 100%;} /*Web Print*/ .boxLabel{border: 2px black solid; width:100% height:100%} .page {width: 210mm; min-height: 297mm;} @media print { div.footer {position: fixed; bottom: 0;} .page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; /*padding-top:38;*/}}</style></head>";
            html += "<body>";
            html += "<div class='page'>";
            html += "<table class='boxLabel' style='table-layout:fixed'>";
            html += "<thead>";
            
            //일자 형식 변환  ex) 2021-04-27
            function dateSub(x){
                return x.substring(0, 4)+"-"+ x.substring(4, 6)+"-"+ x.substring(6, 8);
            }
            
            //물류지시번호 바코드 - 데이터
            var data   = args_mst.lg_ord_no;
            var format = "code128"; 
            
            //console.log(data+":"+format);
            $(".barcode").barcode(data, format, {
                "barWidth"   : 1,
    		    "barHeight"  : 30,
    		    "moduleSize" : 5,
    		    "bgColor"    : 'hsl(0 0% 100%)',
    		    "color"      : 'hsl(0 0% 0%)',
    		    "fontSize"   : 10,
    		    "showHRI"    : true, // false시에 숫자 안보임
    		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
            }).css("width","150%");
    
            src = $(".barcode object").attr("data");
            
            /*
            var total_qty_lst = [];
            var total_box_qty = 0;
            
            for(var h = 0; h<box_lst.length; h++){
                var total_qty = 0;
                for(var i = 0; i<args_det.length; i++){
                    if(box_lst[j]==args_det[i].box_barcd){
                        total_qty += Number(args_det[i].qty);
                    }
                }
                j++;
                total_qty_lst.push(total_qty);
            }
            for(var i = 0; i<total_qty_lst.length; i++){
                total_box_qty += Number(total_qty_lst[i]);
            }
            */
            html += "<h3 style='text-align:center;'>인 수 증</h3>";
            
            //출고송장 브랜드 및 패킹수 목록, 주소 및 담당자 연락처 DB에서 가져오기
            var args = {lg_ord_no : args_list.lg_ord_no, to_whcd : args_list.to_whcd, shopcd : args.shopcd};
            var invar = JSON.stringify(args);
    
            //console.log(args);
       
            gfnTx(appid+"."+pgmid,"print",{INVAR:invar},function(OUTVAR){
            
            if(OUTVAR.rtnCd=="OK") {
            console.log(OUTVAR);
            //html += "<h5>출고 배송정보: " + args_mst.ord_content + "</h5>";
            html += "<h5>출고 배송정보: " + nzl(args_mst.ord_content,"") +" "+ nzl(args_mst.remark,"") +"<br>주소(도착지): "+ OUTVAR.usrto[0].addr + "<br>담당자&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: "+ OUTVAR.usrto[0].adm_nm + "&nbsp;/&nbsp;" + OUTVAR.usrto[0].adm_tel +"</h5>";

            //1
            html += "<tr><th></th>";
            html += "<th rowspan='2' colspan='3'><div class='barcode_img'><object style='width:160px; height:40px;' type='image/bmp' data="+src+"></object></div></th>"; //바코드
            html += "<th style='width:15mm'>물류유형</th>";
            html += "<th style='width:15mm'>일자</th>";
            html += "<th style='width:45mm' colspan='3'>보내는곳</th>";
            html += "<th style='width:45mm' colspan='3'>받는곳</th></tr>";
            
            //var whcd_nm = gfnCdNm("whcd", args.shopcd, "nm");
            
            //2
            html += "<tr><th rowspan='2' style='border-top:hidden; vertical-align:middle;'>물류"+"<br>"+"지시번호</th>";
            html += "<th style='border-bottom:hidden; font-size:15px;'>"+ lg_tp +"</th>"; //REA 
            html += "<th rowspan='2' style='font-size:10px'>"+ dateSub(args_mst.lg_dt) +"</th>"; //일자
            html += "<th rowspan='2' style='width:15mm'>"+ args.shopcd +"</th>"; //보내는곳코드 LF001
            html += "<th rowspan = '2' colspan = '2'>"+ gUserinfo.deptnm +"</th>"; // 가산 gfnCdNm("whcd",whcd,"nm") , gUserinfo.deptnm
    
            html += "<th rowspan='2' style='width:15mm'>"+ args_mst.to_whcd +"</th>"; //받는곳코드
            html += "<th rowspan='2' colspan='2'>"+ args_mst.to_wh_nm +"</th></tr>"; //받는곳이름
            
            //3
            html += "<tr><th colspan='3'>"+ args_mst.lg_ord_no +"</th>"; //물류지시번호
            html += "<th style='font-size:14px;'>"+ lg_tp_nm +"</th>"; //시즌반품
            html += "</tr>";
           
           
            html += "<tr class='tag'><th colspan='2'>패킹구분</th>";
            html += "<th colspan='3'>브랜드</th>";
            html += "<th>패킹수</th>";
            html += "<th>입수량</th>";
            html += "<th colspan='5'>비고</th></tr>";
            
            html += "</thead>";
            html += "<tbody>";
    
            //console.log(OUTVAR.prnt);
            
            var cnt = 0;
            
            for(var i = 0; i<OUTVAR.prnt.length; i++){ 
                
                cnt++;
                html += "<tr style='font-size:12px;'><td colspan='2'>"+ OUTVAR.prnt[i].pack_tp +"</td>";
                html += "<td colspan='3'>"+ OUTVAR.prnt[i].brand +"</td>";
                html += "<td>"+ OUTVAR.prnt[i].boxcnt +"</td>";
                html += "<td>"+OUTVAR.prnt[i].qty+"</td>";
                html += "<td colspan='5'>"+"<br>"+"</td></tr>";
                
            }
            for(var i = 0; i<28-cnt; i++){
                
                html += "<tr><td colspan='2'>"+"<br>"+"</td>";
                html += "<td colspan='3'>"+"<br>"+"</td>";
                html += "<td>"+"<br>"+"</td>";
                html += "<td>"+"<br>"+"</td>";
                html += "<td colspan='5'>"+"<br>"+"</td></tr>";
            }
            
            var total_boxcnt = 0;
            var total_qty = 0;
            
            //총 패킹수
            for(var i = 0; i<OUTVAR.prnt.length; i++){
                total_boxcnt += Number(OUTVAR.prnt[i].boxcnt);
            }
            //총 입수량
            for(var i = 0; i<OUTVAR.prnt.length; i++){
                total_qty += Number(OUTVAR.prnt[i].qty);
            }
            
            //총 패킹수, 총 입수량
            html += "<tr style='font-size:12px;'><td colspan='5'>"+"<br>"+"</td>";
            html += "<td style='background-color: rgb(220, 220, 220);'>"+ total_boxcnt +"</td>";
            html += "<td style='background-color: rgb(220, 220, 220);'>"+ total_qty +"</td>";
            html += "<td colspan='5'>"+"<br>"+"</td></tr>";
            html += "</tbody>";
            
            html += "<tfoot>"; /*style='position: fixed';*/
            html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>상기 제품을 LF네트웍스가 지정하는 일자 장소까지 정히 송품하겠으며</td></tr>";
            html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>만약 송품도중 지연도착, 도난, 파손, 침수등 기타 물품에</td></tr>";
            html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>손실이 발생시는 (주)네트웍스에서 요구하는 모든 변상조치에 응할 것을 확약합니다.</td></tr>";
            
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='12'>"+"<br>"+"</td>";
            html += "</tr>";
            
            //출고송장 매장/창고 주소 및 담당자 연락처 _보내는매장
        
            html += "<tr style='background-color: rgb(220, 220, 220); border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='12'>인계자: "+ OUTVAR.usr[0].adm_nm + "&nbsp;&nbsp;P. " + OUTVAR.usr[0].adm_tel+"</td>";
            html += "</tr>";
                
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid'>인수자:</td>";
            html += "<td class='tfhid'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>차량회사:</td>";
            html += "<td class='tfhid' colspan='5'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>(성명)</td>";
            html += "<td class='tfhid' colspan='3'>"+"<br>"+"</td>";
            html += "</tr>";
            
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='2'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>차량번호:</td>";
            html += "<td class='tfhid' colspan='5'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>핸드폰:</td>";
            html += "<td class='tfhid' colspan='3'>"+"<br>"+"</td>";
            html += "</tr>";
            
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='2'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>차량톤수:</td>";
            html += "<td class='tfhid' colspan='9'>"+"<br>"+"</td>";
            html += "</tr>";
            
            html += "<tr><td class='tfhid' colspan='12' style='font-size:15px;'>LF 네트웍스</td></tr>";
            
            html += "</tfoot>";
            
            html += "</table>";
            html += "</div>";
            html += "</body>";
            html += "</html>";
            
            //새로운 페이지로 열어서 인쇄
            var newPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024');
            
            newPage.document.write(html);
            newPage.focus();
            newPage.print(); 

            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
        });
            
        }else{ //예정목록 선택 2개이상
        
            var to_whcd = rtn[0].to_whcd;
            //var dist_no = rtn[0].dist_no;
            var ord_content = rtn[0].ord_content;
            //console.log(rtn);
            for(var i = 0; i<rtn.length; i++){
                if(rtn[i].cd_stat!="Y"){
                    gfnAlert("선택확인","'발송완료'상태의 문서만 출고송장 발행이 가능합니다.");
                    return;
                }
                if(to_whcd != rtn[i].to_whcd){
                    gfnAlert("선택확인","받는매장이 같아야 묶음발송 출고송장 발행이 가능합니다.");
                    return;
                }
                if(ord_content != rtn[i].ord_content){
                    gfnAlert("선택확인","같은 초도출하 배분건에 대해서만 발행이 가능합니다.");
                    return;
                }
            }
        
            gfnConfirm("발행확인","묶음발송완료건 출고송장(인수증)을 발행하시겠습니까?",function(rtnn){
                if(rtnn) {
                    
                    var args = me.pageObj["pageCond"].exportData()[0];
                    var args_mst = me.pageObj["mst"].exportData()[0]; // lg_dt: 물류일자, to_whcd: 받는창고
                    var args_det = me.pageObj["det"].exportData(); //box_barcd: 박스번호,바코드
                    var selected = me.pageObj.list.selectedRows();
                    var args_list = me.pageObj["list"].exportData("selected")[0];
            
                    //console.log(args_det);
                    
                    var lg_tp = rtn[0].lg_tp;
                    var lg_tp_nm = gfnCdNm("LG_TP_I",lg_tp,"nm");
                    var box_lst = extract(args_det, "box_barcd", "distinct");
                    var box_no_lst = extract(args_det, "box_no", "distinct"); //매장 박스번호
                    
                    var j = 0;
            
                    //출고송장 브랜드 및 패킹수 목록, 주소 및 담당자 연락처 DB에서 가져오기
                    var args = {lg_ord_no : args_list.lg_ord_no, to_whcd : args_list.to_whcd, shopcd : args.shopcd};
                    args.list = rtn;
                    var invar = JSON.stringify(args);
            
                    gfnTx(appid+"."+pgmid,"printCfmAll",{INVAR:invar},function(OUTVAR){
                    
                    if(OUTVAR.rtnCd=="OK") {
                        console.log(OUTVAR);
                        
                        var html = "<html>";
                        //사이즈 조절, css
                        html += "<head><style type='text/css'> .boxLabel .tfhid{font-size:5px; border-left:hidden; border-right:hidden;} .boxLabel {border-collapse:collapse; border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;} .boxLabel .tag{ background-color: rgb(220, 220, 220); border-top: 3px black solid;}.boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; }.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; } /*.boxLabel .goods{border-right: 3px black solid;}*/ .boxLabel th{ font-size:12px; border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;} .footer{padding: 0; text-align: center; vertical-align: middle; line-height: normal; margin: 0; position: fixed; bottom: 0px; width: 100%;} /*Web Print*/ .boxLabel{border: 2px black solid; width:100% height:100%} .page {width: 210mm; min-height: 297mm;} @media print { div.footer {position: fixed; bottom: 0;} .page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; /*padding-top:38;*/}}</style></head>";
                        html += "<body>";
                        html += "<div class='page'>";
                        html += "<table class='boxLabel' style='table-layout:fixed'>";
                        html += "<thead>";
                        
                        //일자 형식 변환  ex) 2021-04-27
                        function dateSub(x){
                            return x.substring(0, 4)+"-"+ x.substring(4, 6)+"-"+ x.substring(6, 8);
                        }
                        
                        //물류지시번호 바코드 - 데이터
                        var data   = args_mst.lg_ord_no;
                        var format = "code128"; 
                        
                        //console.log(data+":"+format);
                        $(".barcode").barcode(data, format, {
                            "barWidth"   : 1,
                		    "barHeight"  : 30,
                		    "moduleSize" : 5,
                		    "bgColor"    : 'hsl(0 0% 100%)',
                		    "color"      : 'hsl(0 0% 0%)',
                		    "fontSize"   : 10,
                		    "showHRI"    : true, // false시에 숫자 안보임
                		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
                        }).css("width","150%");
                
                        src = $(".barcode object").attr("data");
                        
                        /*
                        var total_qty_lst = [];
                        var total_box_qty = 0;
                        
                        for(var h = 0; h<box_lst.length; h++){
                            var total_qty = 0;
                            for(var i = 0; i<args_det.length; i++){
                                if(box_lst[j]==args_det[i].box_barcd){
                                    total_qty += Number(args_det[i].qty);
                                }
                            }
                            j++;
                            total_qty_lst.push(total_qty);
                        }
                        for(var i = 0; i<total_qty_lst.length; i++){
                            total_box_qty += Number(total_qty_lst[i]);
                        }
                        */
                        html += "<h3 style='text-align:center;'>인 수 증</h3>";
                        
                        //html += "<h5>주소(도착지): "+ OUTVAR.usrto[0].addr + "&nbsp;&nbsp;&nbsp;&nbsp;담당자: "+ OUTVAR.usrto[0].adm_nm + " " + OUTVAR.usrto[0].adm_tel +"</h5>";
                        //html += "<h5>주소(도착지): "+ OUTVAR.usrto[0].addr + "<br>담당자&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: "+ OUTVAR.usrto[0].adm_nm + "&nbsp;/&nbsp;" + OUTVAR.usrto[0].adm_tel +"</h5>";
                        html += "<h5>출고 배송정보: " + nzl(rtn[0].ord_content,"") +" "+ nzl(rtn[0].remark,"") +"<br>주소(도착지): "+ OUTVAR.usrto[0].addr + "<br>담당자&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: "+ OUTVAR.usrto[0].adm_nm + "&nbsp;/&nbsp;" + OUTVAR.usrto[0].adm_tel +"</h5>";

                        //1
                        html += "<tr><th></th>";
                        html += "<th rowspan='2' colspan='3'><div class='barcode_img'><object style='width:160px; height:40px;' type='image/bmp' data="+src+"></object></div></th>"; //바코드
                        html += "<th style='width:15mm'>물류유형</th>";
                        html += "<th style='width:15mm'>일자</th>";
                        html += "<th style='width:45mm' colspan='3'>보내는곳</th>";
                        html += "<th style='width:45mm' colspan='3'>받는곳</th></tr>";
                        
                        //var whcd_nm = gfnCdNm("whcd", args.shopcd, "nm");
                        
                        //2
                        html += "<tr><th rowspan='2' style='border-top:hidden; vertical-align:middle;'>물류"+"<br>"+"지시번호</th>";
                        html += "<th style='border-bottom:hidden; font-size:15px;'>"+ rtn[0].lg_tp +"</th>"; //REA 
                        html += "<th rowspan='2' style='font-size:10px'>"+ dateSub(rtn[0].lg_dt) +"</th>"; //일자
                        html += "<th rowspan='2' style='width:15mm'>"+ rtn[0].from_whcd +"</th>"; //보내는곳코드 LF001
                        html += "<th rowspan = '2' colspan = '2'>"+ rtn[0].from_wh_nm +"</th>"; // 가산 gfnCdNm("whcd",whcd,"nm") , gUserinfo.deptnm
                
                        html += "<th rowspan='2' style='width:15mm'>"+ rtn[0].to_whcd +"</th>"; //받는곳코드
                        html += "<th rowspan='2' colspan='2'>"+ rtn[0].to_wh_nm +"</th></tr>"; //받는곳이름
                        
                        //3
                        html += "<tr><th colspan='3'>"+ rtn[0].lg_ord_no +"</th>"; //물류지시번호
                        html += "<th style='font-size:14px;'>"+ lg_tp_nm +"</th>"; //시즌반품
                        html += "</tr>";
                       
                        html += "<tr class='tag'><th colspan='2'>패킹구분</th>";
                        html += "<th colspan='3'>브랜드</th>";
                        html += "<th>패킹수</th>";
                        html += "<th>입수량</th>";
                        html += "<th colspan='5'>비고</th></tr>";
                        
                        html += "</thead>";
                        html += "<tbody>";
                
                        //console.log(OUTVAR.prnt);
                        
                        var cnt = 0;
                        
                        for(var i = 0; i<OUTVAR.prtCfm.length; i++){ 
                            cnt++;
                            html += "<tr style='font-size:12px;'><td colspan='2'>"+ OUTVAR.prtCfm[i].pack_tp +"</td>";
                            html += "<td colspan='3'>"+ OUTVAR.prtCfm[i].brand +"</td>";
                            html += "<td>"+ OUTVAR.prtCfm[i].boxcnt +"</td>";
                            html += "<td>"+OUTVAR.prtCfm[i].qty+"</td>";
                            html += "<td colspan='5'>"+"<br>"+"</td></tr>";
                        }
                        for(var i = 0; i<29-cnt; i++){
                            html += "<tr><td colspan='2'>"+"<br>"+"</td>";
                            html += "<td colspan='3'>"+"<br>"+"</td>";
                            html += "<td>"+"<br>"+"</td>";
                            html += "<td>"+"<br>"+"</td>";
                            html += "<td colspan='5'>"+"<br>"+"</td></tr>";
                        }
                        
                        var total_boxcnt = 0;
                        var total_qty = 0;
                        
                        //총 패킹수
                        for(var i = 0; i<OUTVAR.prtCfm.length; i++){
                            total_boxcnt += Number(OUTVAR.prtCfm[i].boxcnt);
                        }
                        //총 입수량
                        for(var i = 0; i<OUTVAR.prtCfm.length; i++){
                            total_qty += Number(OUTVAR.prtCfm[i].qty);
                        }
                        
                        //총 패킹수, 총 입수량
                        html += "<tr style='font-size:12px;'><td colspan='5'>"+"<br>"+"</td>";
                        html += "<td style='background-color: rgb(220, 220, 220);'>"+ total_boxcnt +"</td>";
                        html += "<td style='background-color: rgb(220, 220, 220);'>"+ total_qty +"</td>";
                        html += "<td colspan='5'>"+"<br>"+"</td></tr>";
            
                        html += "</tbody>";
                        
                        html += "<tfoot>"; /*style='position: fixed';*/
                        html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>상기 제품을 LF네트웍스가 지정하는 일자 장소까지 정히 송품하겠으며</td></tr>";
                        html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>만약 송품도중 지연도착, 도난, 파손, 침수등 기타 물품에</td></tr>";
                        html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>손실이 발생시는 (주)네트웍스에서 요구하는 모든 변상조치에 응할 것을 확약합니다.</td></tr>";
                        
                        html += "<tr style='border-bottom:hidden;'>";
                        html += "<td class='tfhid' colspan='12'>"+"<br>"+"</td>";
                        html += "</tr>";
                        
                        //출고송장 매장/창고 주소 및 담당자 연락처 _보내는매장
                        html += "<tr style='background-color: rgb(220, 220, 220); border-bottom:hidden;'>";
                        html += "<td class='tfhid' colspan='12'>인계자: "+ OUTVAR.usr[0].adm_nm + "&nbsp;&nbsp;P. " + OUTVAR.usr[0].adm_tel+"</td>";
                        html += "</tr>";
                            
                        html += "<tr style='border-bottom:hidden;'>";
                        html += "<td class='tfhid'>인수자:</td>";
                        html += "<td class='tfhid'>"+"<br>"+"</td>";
                        html += "<td class='tfhid'>차량회사:</td>";
                        html += "<td class='tfhid' colspan='5'>"+"<br>"+"</td>";
                        html += "<td class='tfhid'>(성명)</td>";
                        html += "<td class='tfhid' colspan='3'>"+"<br>"+"</td>";
                        html += "</tr>";
                        
                        html += "<tr style='border-bottom:hidden;'>";
                        html += "<td class='tfhid' colspan='2'>"+"<br>"+"</td>";
                        html += "<td class='tfhid'>차량번호:</td>";
                        html += "<td class='tfhid' colspan='5'>"+"<br>"+"</td>";
                        html += "<td class='tfhid'>핸드폰:</td>";
                        html += "<td class='tfhid' colspan='3'>"+"<br>"+"</td>";
                        html += "</tr>";
                        
                        html += "<tr style='border-bottom:hidden;'>";
                        html += "<td class='tfhid' colspan='2'>"+"<br>"+"</td>";
                        html += "<td class='tfhid'>차량톤수:</td>";
                        html += "<td class='tfhid' colspan='9'>"+"<br>"+"</td>";
                        html += "</tr>";
                        
                        html += "<tr><td class='tfhid' colspan='12' style='font-size:15px;'>LF 네트웍스</td></tr>";
                        html += "</tfoot>";
                        
                        html += "</table>";
                        html += "</div>";
                        html += "</body>";
                        html += "</html>";
                        
                        //새로운 페이지로 열어서 인쇄
                        var newPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024');
                        
                        newPage.document.write(html);
                        newPage.focus();
                        newPage.print(); 
        
                    } else {
                        gfnAlert("조회오류",OUTVAR.rtnMsg);
                    }
                }); //gfnTx
                
                }//if(rtnn)
                
            });//gfnConfirm   
            
        }//else
    }
    
    //print2 : 박스라벨 생성/발행
    me.fnPrint2=function() {
        /*
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("cd_stat")!="F") {
            gfnAlert("박스라벨 발행확인","반품지시/예정내역이 선택되지 않았거나 확정상태가 아닙니다.");
            return;
        } 
        */
        function _fnPrintLabel(args, args_mst, args_det, args_list) {
            var lg_tp = args_mst.lg_tp;
            var lg_tp_nm = gfnCdNm("LG_TP_I",lg_tp,"nm");
            
            var box_lst = extract(args_det, "box_barcd", "distinct"); //박스바코드
            var box_no_lst = extract(args_det, "box_no", "distinct"); //매장 박스번호
    
            var j = 0;
    
            // 콤마 추가
            function numComma(x) {
                if(isNull(x)) return "";
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            }
                    
            var html_lst = [];
            for(var i = 0; i<box_lst.length; i++){
                html_lst.push("html"+i);
            }
                
            //패킹수만큼 찍어낸다
            for(var k = 0; k<box_lst.length; k++){ 
    
                html_lst[k] = "<html>";
                //사이즈 조절, css
                html_lst[k] += "<head><style type='text/css'> .boxLabel {border-collapse:collapse;border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;}.boxLabel .change{font-size:30px; font-weight: bold; border-bottom:hidden} .boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel .date{font-size: 15px;}.boxLabel .from{ font-size: 15px;} .boxLabel .to{font-size: 15px;}.boxLabel .code{font-size: 15px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 1;}.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 15px;}.boxLabel th{border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;} .boxLabel .goods{border-right: 4px black solid;} .boxLabel .boxNum_data{font-weight: bold; text-align:center; vertical-align:middle; font-size: 30px;} .barcode_img>object {width: 80%; height: 50px;} .boxLabel .boxNum{font-weight: bold; text-align:center; vertical-align:middle;}.boxLabel .allcnt_data{font-weight: bold; text-align:center; vertical-align:middle; font-size:30px;} /*Web Print*/ body {margin: 0; padding-left: 28; padding-top:18; padding-bottom:10;} .boxLabel{border: 3px black solid; width: 200mm/*112mm*/; /*225*/height: 140mm/*84mm*/; /*175*/}@page {size: 140mm 110mm; /*7.62cm 5.08cm 94 64 96 62*/ /*인쇄기본설정 => w:66mm, h:88mm*/margin: 0;}@media print {.page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; padding-top:38;}}</style></head>";
                html_lst[k] += "<body>";
                html_lst[k] += "<div class='page'>";
                html_lst[k] += "<table class='boxLabel' style='table-layout:fixed'>";
                html_lst[k] += "<thead>";
                
                html_lst[k] += "<tr><th class='date' style='width:25mm'>일자</th><th class='from'>보내는곳</th><th class='code' style='width:25mm;'>코드</th><th class='code' style='width:25mm;'>패킹번호</th><th class='to'>받는곳</th><th class='code' style='width:25mm;'>코드</th></tr>";
                
                //일자 형식 변환  ex) 2021-04-27
                var date = (args_mst.lg_dt).substring(0, 4)+"-"+(args_mst.lg_dt).substring(4, 6)+"-"+(args_mst.lg_dt).substring(6, 8);
    
                //매장 박스번호 - 박스번호에서 뒤에 4자리 가져오기 -> ex. ITS-20211213-0001
                var box_no_sub = box_no_lst[k].split("-"); //box_no_lst[k].slice(-4); // ex.0001
                box_no_sub = box_no_sub[box_no_sub.length-1];
                if(inStr(nzl((args_list.dist_nm),"").substr(0,4),"20SS")>=0) box_no_sub = (args_det[0].goods_cd).substr(2,7);
                
                //일자, 보내는곳, 보내는곳코드, 받는곳, 받는곳코드
                html_lst[k] += "<tr><td style='font-size:17px;'>"+date+"</td>";
                html_lst[k] += "<td class = 'data'>" +gUserinfo.deptnm+ "</td>";
                html_lst[k] += "<td class = 'data'>" + args.shopcd+ "</td>";
                html_lst[k] += "<td class = 'data'>" + box_no_sub + "</td>"; //박스번호 0001
                html_lst[k] += "<td class = 'data' style='font-size: 27px;'>" +args_mst.to_wh_nm+ "</td>";
                html_lst[k] += "<td  class = 'data' style='font-size: 27px;'>" + args_mst.to_whcd+ "</td></tr>";
                html_lst[k] += "</thead>";
                html_lst[k] += "<tbody>";
            
                var total_qty = 0; //총수량
                var goodscd = []; //박스별 상품코드 담아두는 리스트
                var goodsqty = []; //박스별 상품수량 담아두는 리스트
                
                for(var i = 0; i<args_det.length; i++){
                    if(box_lst[j]==args_det[i].box_barcd){
                        total_qty += Number(args_det[i].qty);
                        //goodscd.push(args_det[i].goods_cd);
                        goodscd.push((args_det[i].goods_cd).substr(0,4)+" "+(args_det[i].goods_cd).substr(4,5)+" "+(args_det[i].goods_cd).substr(9,2)+" "+(args_det[i].goods_cd).substr(11,3));
                        goodsqty.push(args_det[i].qty);
                    }
                }
                j++;    
                
                //박스바코드 - 데이터
                var data   = box_lst[k]; 
                var format = "code128"; 
                
                //console.log(data+":"+format);
                $(".barcode").barcode(data, format, {
                    "barWidth"   : 1,
        		    "barHeight"  : 50,
        		    "moduleSize" : 5,
        		    "bgColor"    : 'hsl(0 0% 100%)',
        		    "color"      : 'hsl(0 0% 0%)',
        		    "fontSize"   : 10,
        		    "showHRI"    : true, // false시에 숫자 안보임
        		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
                }).css("width","100%");
        
                src = $(".barcode object").attr("data");
    
                //출하(이동구분명) GIA,GIB...
                html_lst[k] += "<tr><td class='change'>"+lg_tp+"</td>";
                
                //박스바코드
                html_lst[k] += "<td class='barcode' colspan='5'><div class='barcode_img'><object type='image/bmp' data="+src+"></object></div></td></tr>";
            
                html_lst[k] += "<tr><td>"+ lg_tp_nm +"</td>";
                
                //박스바코드번호
                //박스바코드번호 형식 변환 (공백추가)
                var boxnum_sp = data.substr(0,5)+" "+data.substr(5,5)+" "+data.substring(10, );
                if(inStr(nzl((args_list.dist_nm),"").substr(0,4),"20SS")>=0 || args_list.lg_tp=="GIB") boxnum_sp = data.substr(0,5)+" "+data.substr(5,6)+" "+data.substring(11, );
    
                // if(isNull(args_list.dist_nm)){
                    
                // }else if(inStr((args_list.dist_nm).substr(0,4),"20SS")>=0) boxnum_sp = data.substr(0,5)+" "+data.substr(5,6)+" "+data.substring(11, );
                
                html_lst[k] += "<td class='boxNum_data' colspan='4'>"+ boxnum_sp +"</td>";
    
                //박스별 총수량
                html_lst[k] += "<td class='allcnt_data' >"+ numComma(total_qty) +"ea</td></tr>";
            
                if(goodscd.length <= 10){ //상품 갯수가 10개 이하일때
                    var cnt = 0;
                    var cnt_right = 0;
                    
                    for(var i = 0; i<goodscd.length; i++){ 
                        cnt++;
                        html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                        html_lst[k] += "<td>"+(i+1)+"</td>";
                        html_lst[k] += "<td>"+goodscd[i]+"</td>";
                        html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "</tr>";
                    }
                    for(var i = 0; i<10-cnt; i++){
                        html_lst[k] += "<tr>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td class='goods'>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "</tr>";
                    }
                }else { //상품 갯수가 10개 이상일 때
                    var cnt_right = 0;
                    if(goodscd.length <= 20){ //상품 갯수가 20개이하
                        
                        for(var i = 0; i<goodscd.length-10; i++){
                            cnt_right++;
                            html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                            html_lst[k] += "<td>"+(i+1)+"</td>";
                            html_lst[k] += "<td>"+goodscd[i]+"</td>";
                            html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                            html_lst[k] += "<td>"+(i+11)+"</td>";
                            html_lst[k] += "<td>"+goodscd[i+10]+"</td>";
                            html_lst[k] += "<td>"+goodsqty[i+10]+"</td>";
                            html_lst[k] += "</tr>";
                        }
                        //console.log(cnt_right);
                        for(var i = cnt_right; i<10; i++){
                            html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                            html_lst[k] += "<td>"+(i+1)+"</td>";
                            html_lst[k] += "<td>"+goodscd[i]+"</td>";
                            html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                            html_lst[k] += "<td>"+"<br>"+"</td>";
                            html_lst[k] += "<td>"+"<br>"+"</td>";
                            html_lst[k] += "<td>"+"<br>"+"</td>";
                            html_lst[k] += "</tr>";
                        }
                    }else{ //상품 갯수가 20개 이상일때
                        for(var i = 0; i<9; i++){
                            html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                            html_lst[k] += "<td>"+(i+1)+"</td>";
                            html_lst[k] += "<td>"+goodscd[i]+"</td>";
                            html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                            html_lst[k] += "<td>"+(i+11)+"</td>";
                            html_lst[k] += "<td>"+goodscd[i+11]+"</td>";
                            html_lst[k] += "<td>"+goodsqty[i+11]+"</td>";
                            html_lst[k] += "</tr>";
                        } 
                        html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                        html_lst[k] += "<td>"+10+"</td>";
                        html_lst[k] += "<td>"+goodscd[9]+"</td>";
                        html_lst[k] += "<td class='goods'>"+goodsqty[9]+"</td>";
                        html_lst[k] += "<td>...</td>";
                        html_lst[k] += "<td>... 외 "+ Number(goodscd.length-19) +"</td>";
                        html_lst[k] += "<td>...</td>";
                        html_lst[k] += "</tr>";
                    }
                }
                html_lst[k] += "</tbody>";
                html_lst[k] += "</table>";
                html_lst[k] += "</div>";
                html_lst[k] += "</body>";
                html_lst[k] += "</html>";
            }
            
            //패킹라벨 발행 횟수 카운팅
            var args_mst = me.pageObj["mst"].exportData()[0];
            var invar = JSON.stringify(args_mst);
    
            gfnTx(appid+"."+pgmid,"printcnt",{INVAR:invar},function(OUTVAR){
                
                if(OUTVAR.rtnCd=="OK") {
                    //console.log(OUTVAR);
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
            
            //새로운 페이지로 열어서 인쇄
            var newPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024');
            
            //패킹수를 담은 변수갯수만큼(패킹수만큼) newpage에 붙여준다
            for(var i = 0; i<html_lst.length; i++){
                newPage.document.write(html_lst[i]);
            }
            //newPage.document.write(html);
            newPage.focus();
            newPage.print(); 
            
            //로그 저장
            const lg_ord_no = me.pageObj.mst.getVal("lg_ord_no");
            $.extend(args, me.pageObj.mst.exportData()[0]);
            const sub = "패킹라벨";
            gfnLog(pgmid, args, lg_ord_no, "print", sub);
            
        }

        if(me.pageObj.list.exportData("selected").length > 1) {
            gfnStatus("선택된 출고전표에 해당하는 패킹라벨을 일괄 발행합니다.");
            //fnPrint5            
            me.fnPrint6();
            
        } else if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("패킹라벨 발행확인","출고지시/예정내역이 선택되지 않았습니다.");
            return;
        } else {
            var args = me.pageObj["pageCond"].exportData()[0];
            var args_mst = me.pageObj["mst"].exportData()[0]; // lg_dt: 물류일자, to_whcd: 받는창고
            var args_det = me.pageObj["det"].exportData(); //box_barcd: 박스번호,바코드
            var args_list = me.pageObj["list"].exportData("selected")[0];
            _fnPrintLabel(args,args_mst,args_det,args_list);    
        }  
    }
    
    /*******************************************************/
    
    //me.fnPrintSel : 일부패킹발행 (선택한 패킹 발행)
    me.fnPrintSel = function(sellist){
        console.log(sellist);
        /*
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("cd_stat")!="F") {
            gfnAlert("박스라벨 발행확인","반품지시/예정내역이 선택되지 않았거나 확정상태가 아닙니다.");
            return;
        } 
        */
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("패킹라벨 발행확인","출고지시/예정내역이 선택되지 않았습니다.");
            return;
        } 
        if(isNull(sellist)){
            gfnAlert("패킹라벨 발행확인","일부 패킹이 선택되지 않았습니다. 패킹을 선택해주세요.");
            return;
        }
        var args = me.pageObj["pageCond"].exportData()[0];
        var args_mst = me.pageObj["mst"].exportData()[0]; // lg_dt: 물류일자, to_whcd: 받는창고
        var args_det = me.pageObj["det"].exportData(); //box_barcd: 박스번호,바코드
        var args_list = me.pageObj["list"].exportData("selected")[0];

        var lg_tp = args_mst.lg_tp;
        var lg_tp_nm = gfnCdNm("LG_TP_I",lg_tp,"nm");
        
        var box_lst = extract(sellist, "box_barcd", "distinct"); //박스바코드
        var box_no_lst = extract(sellist, "box_no", "distinct"); //매장 박스번호

        var j = 0;

        var html_lst = [];
        for(var i = 0; i<box_lst.length; i++){
            html_lst.push("html"+i);
        }
            
        //패킹수만큼 찍어낸다
        for(var k = 0; k<box_lst.length; k++){ 

            html_lst[k] = "<html>";
            //사이즈 조절, css
            html_lst[k] += "<head><style type='text/css'> .boxLabel {border-collapse:collapse;border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;}.boxLabel .change{font-size:30px; font-weight: bold; border-bottom:hidden} .boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel .date{font-size: 15px;}.boxLabel .from{ font-size: 15px;} .boxLabel .to{font-size: 15px;}.boxLabel .code{font-size: 15px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 1;}.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 15px;}.boxLabel th{border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;} .boxLabel .goods{border-right: 4px black solid;} .boxLabel .boxNum_data{font-weight: bold; text-align:center; vertical-align:middle; font-size: 30px;} .barcode_img>object {width: 80%; height: 50px;} .boxLabel .boxNum{font-weight: bold; text-align:center; vertical-align:middle;}.boxLabel .allcnt_data{font-weight: bold; text-align:center; vertical-align:middle; font-size:30px;} /*Web Print*/ body {margin: 0; padding-left: 28; padding-top:18; padding-bottom:10;} .boxLabel{border: 3px black solid; width: 200mm/*112mm*/; /*225*/height: 140mm/*84mm*/; /*175*/}@page {size: 140mm 110mm; /*7.62cm 5.08cm 94 64 96 62*/ /*인쇄기본설정 => w:66mm, h:88mm*/margin: 0;}@media print {.page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; padding-top:38;}}</style></head>";
            html_lst[k] += "<body>";
            html_lst[k] += "<div class='page'>";
            html_lst[k] += "<table class='boxLabel' style='table-layout:fixed'>";
            html_lst[k] += "<thead>";
            
            html_lst[k] += "<tr><th class='date' style='width:25mm'>일자</th><th class='from'>보내는곳</th><th class='code' style='width:25mm;'>코드</th><th class='code' style='width:25mm;'>패킹번호</th><th class='to'>받는곳</th><th class='code' style='width:25mm;'>코드</th></tr>";
            
            //일자 형식 변환  ex) 2021-04-27
            var date = (args_mst.lg_dt).substring(0, 4)+"-"+(args_mst.lg_dt).substring(4, 6)+"-"+(args_mst.lg_dt).substring(6, 8);

            //매장 박스번호 - 박스번호에서 뒤에 4자리 가져오기 -> ex. ITS-20211213-0001
            var box_no_sub = box_no_lst[k].slice(-4); // ex.0001
            if(inStr(nzl((args_list.dist_nm),"").substr(0,4),"20SS")>=0) box_no_sub = (sellist[k].goods_cd).substr(2,7);
            
            //일자, 보내는곳, 보내는곳코드, 받는곳, 받는곳코드
            html_lst[k] += "<tr><td style='font-size:17px;'>"+date+"</td>";
            html_lst[k] += "<td class = 'data'>" +gUserinfo.deptnm+ "</td>";
            html_lst[k] += "<td class = 'data'>" + args.shopcd+ "</td>";
            html_lst[k] += "<td class = 'data'>" + box_no_sub + "</td>"; //박스번호 0001
            html_lst[k] += "<td class = 'data' style='font-size: 27px;'>" +args_mst.to_wh_nm+ "</td>";
            html_lst[k] += "<td  class = 'data' style='font-size: 27px;'>" + args_mst.to_whcd+ "</td></tr>";
            html_lst[k] += "</thead>";
            html_lst[k] += "<tbody>";
        
            var total_qty = 0; //총수량
            var goodscd = []; //박스별 상품코드 담아두는 리스트
            var goodsqty = []; //박스별 상품수량 담아두는 리스트
            
            for(var i = 0; i<sellist.length; i++){
                if(box_lst[j]==sellist[i].box_barcd){
                    total_qty += Number(sellist[i].qty);
                    //goodscd.push(sellist[i].goods_cd);
                    goodscd.push((sellist[i].goods_cd).substr(0,4)+" "+(sellist[i].goods_cd).substr(4,5)+" "+(sellist[i].goods_cd).substr(9,2)+" "+(sellist[i].goods_cd).substr(11,3));
                    goodsqty.push(sellist[i].qty);
                }
            }
            j++;    
            
            //박스바코드 - 데이터
            var data   = box_lst[k]; 
            var format = "code128"; 
            
            //console.log(data+":"+format);
            $(".barcode").barcode(data, format, {
                "barWidth"   : 1,
    		    "barHeight"  : 50,
    		    "moduleSize" : 5,
    		    "bgColor"    : 'hsl(0 0% 100%)',
    		    "color"      : 'hsl(0 0% 0%)',
    		    "fontSize"   : 10,
    		    "showHRI"    : true, // false시에 숫자 안보임
    		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
            }).css("width","100%");
    
            src = $(".barcode object").attr("data");

            //출하(이동구분명) GIA,GIB...
            html_lst[k] += "<tr><td class='change'>"+lg_tp+"</td>";
            
            //박스바코드
            html_lst[k] += "<td class='barcode' colspan='5'><div class='barcode_img'><object type='image/bmp' data="+src+"></object></div></td></tr>";
        
            html_lst[k] += "<tr><td>"+ lg_tp_nm +"</td>";
            
            //박스바코드번호
            //박스바코드번호 형식 변환 (공백추가)
            var boxnum_sp = data.substr(0,5)+" "+data.substr(5,5)+" "+data.substring(10, );
            if(inStr(nzl((args_list.dist_nm),"").substr(0,4),"20SS")>=0 || args_list.lg_tp=="GIB") boxnum_sp = data.substr(0,5)+" "+data.substr(5,6)+" "+data.substring(11, );
            
            html_lst[k] += "<td class='boxNum_data' colspan='4'>"+ boxnum_sp +"</td>";

            //박스별 총수량
            html_lst[k] += "<td class='allcnt_data' >"+total_qty+"ea</td></tr>";
        
            if(goodscd.length <= 10){ //상품 갯수가 10개 이하일때
                var cnt = 0;
                var cnt_right = 0;
                
                for(var i = 0; i<goodscd.length; i++){ 
                    cnt++;
                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                    html_lst[k] += "<td>"+(i+1)+"</td>";
                    html_lst[k] += "<td>"+goodscd[i]+"</td>";
                    html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "</tr>";
                }
                for(var i = 0; i<10-cnt; i++){
                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "<td class='goods'>"+"<br>"+"</td>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "<td>"+"<br>"+"</td>";
                    html_lst[k] += "</tr>";
                }
            }else { //상품 갯수가 10개 이상일 때
                var cnt_right = 0;
                if(goodscd.length <= 20){ //상품 갯수가 20개이하
                    
                    for(var i = 0; i<goodscd.length-10; i++){
                        cnt_right++;
                        html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                        html_lst[k] += "<td>"+(i+1)+"</td>";
                        html_lst[k] += "<td>"+goodscd[i]+"</td>";
                        html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                        html_lst[k] += "<td>"+(i+11)+"</td>";
                        html_lst[k] += "<td>"+goodscd[i+10]+"</td>";
                        html_lst[k] += "<td>"+goodsqty[i+10]+"</td>";
                        html_lst[k] += "</tr>";
                    }
                    //console.log(cnt_right);
                    for(var i = cnt_right; i<10; i++){
                        html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                        html_lst[k] += "<td>"+(i+1)+"</td>";
                        html_lst[k] += "<td>"+goodscd[i]+"</td>";
                        html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "</tr>";
                    }
                }else{ //상품 갯수가 20개 이상일때
                    for(var i = 0; i<9; i++){
                        html_lst[k] += "<tr>";
                        html_lst[k] += "<td>"+(i+1)+"</td>";
                        html_lst[k] += "<td>"+goodscd[i]+"</td>";
                        html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                        html_lst[k] += "<td>"+(i+11)+"</td>";
                        html_lst[k] += "<td>"+goodscd[i+11]+"</td>";
                        html_lst[k] += "<td>"+goodsqty[i+11]+"</td>";
                        html_lst[k] += "</tr>";
                    } 
                    html_lst[k] += "<tr>";
                    html_lst[k] += "<td>"+10+"</td>";
                    html_lst[k] += "<td>"+goodscd[9]+"</td>";
                    html_lst[k] += "<td class='goods'>"+goodsqty[9]+"</td>";
                    html_lst[k] += "<td>...</td>";
                    html_lst[k] += "<td>... 외 "+ Number(goodscd.length-19) +"</td>";
                    html_lst[k] += "<td>...</td>";
                    html_lst[k] += "</tr>";
                }
            }
            html_lst[k] += "</tbody>";
            html_lst[k] += "</table>";
            html_lst[k] += "</div>";
            html_lst[k] += "</body>";
            html_lst[k] += "</html>";
        }
        
        //패킹라벨 발행 횟수 카운팅
        var args_mst = me.pageObj["mst"].exportData()[0];
        var invar = JSON.stringify(args_mst);

        gfnTx(appid+"."+pgmid,"printcnt",{INVAR:invar},function(OUTVAR){
            
            if(OUTVAR.rtnCd=="OK") {
                //console.log(OUTVAR);
            } else {
                gfnAlert("저장오류",OUTVAR.rtnMsg);
            }
        });
        
        //새로운 페이지로 열어서 인쇄
        var newPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024');
        
        //패킹수를 담은 변수갯수만큼(패킹수만큼) newpage에 붙여준다
        for(var i = 0; i<html_lst.length; i++){
            newPage.document.write(html_lst[i]);
        }
        //newPage.document.write(html);
        newPage.focus();
        newPage.print(); 
        
        //로그 저장
        const lg_ord_no = me.pageObj.mst.getVal("lg_ord_no");
        $.extend(args, me.pageObj.mst.exportData()[0]);
        const sub = "패킹라벨";
        gfnLog(pgmid, args, lg_ord_no, "print", sub);
    }
    
    
    /*******************************************************/
    //print3 : 박스송장 발행
    me.fnPrint3=function() {
        /* 
        if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("cd_stat")!="F") {
            gfnAlert("박스라벨 발행확인","반품지시/예정내역이 선택되지 않았거나 확정상태가 아닙니다.");
            return;
        } */ 
        
        function _fnPrint3(args, args_mst, args_det, args_list) {
            
            var lg_tp = args_mst.lg_tp;
            var lg_tp_nm = gfnCdNm("LG_TP_I",lg_tp,"nm");
            var box_lst = extract(args_det, "box_barcd", "distinct");
            var box_no_lst = extract(args_det, "box_no", "distinct"); //매장 박스번호
    
    
            var j = 0;
    
            var html_lst = [];
            for(var i = 0; i<box_lst.length; i++){
                html_lst.push("html"+i);
            }
                
            //패킹수만큼 찍어낸다
            for(var k = 0; k<box_lst.length; k++){ 
    
                html_lst[k] = "<html>";
                //사이즈 조절, css
                html_lst[k] += "<head><style type='text/css'> .boxLabel {border-collapse:collapse;border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;}.boxLabel .change{font-size:30px; font-weight: bold; border-bottom:hidden}.boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel .date{font-size: 15px;}.boxLabel .from{ font-size: 15px;} .boxLabel .to{font-size: 15px;}.boxLabel .code{font-size: 15px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 1;}.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 13px;} .boxLabel th{border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;}.boxLabel .boxNum_data{font-weight: bold; text-align:center; vertical-align:middle; font-size: 30px;} .boxLabel .boxNum{font-weight: bold; text-align:center; vertical-align:middle;}.boxLabel .allcnt_data{font-weight: bold; text-align:center; vertical-align:middle; font-size:30px;} /*Web Print*/ body {margin: 0; padding-top:18;} .barcode_img>object {width: 80%; height: 50px;} .boxLabel{border: 3px black solid; width:100% height:100%}  .page {width: 210mm; min-height: 297mm;} @media print {.page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; /*padding-top:38;*/}}</style></head>";
                html_lst[k] += "<body>";
                html_lst[k] += "<div class='page'>";
                html_lst[k] += "<table class='boxLabel' style='table-layout:fixed; width:500px; overflow:hidden;white-space:nowrap; text-overflow:ellipsis;'>";
                html_lst[k] += "<thead>";
                
                html_lst[k] += "<tr><th class='date' style='width:25mm'>일자</th><th class='from' style='width:35mm;'>보내는곳</th><th class='code' style='width:45mm;'>코드</th><th class='to' colspan='2' style='width:35mm;'>받는곳</th><th class='code' style='width:35mm;'>코드</th></tr>";
                
                //일자 형식 변환  ex) 2021-04-27
                var date = (args_mst.lg_dt).substring(0, 4)+"-"+(args_mst.lg_dt).substring(4, 6)+"-"+(args_mst.lg_dt).substring(6, 8);
    
                
                //일자, 보내는곳, 보내는곳코드, 받는곳, 받는곳코드
                html_lst[k] += "<tr><td style='font-size:17px;'>"+ date +"</td>";
                html_lst[k] += "<td class = 'data'>" + args_mst.from_wh_nm + "</td>";
                html_lst[k] += "<td class = 'data'>" + args_mst.from_whcd+ "</td>";
                html_lst[k] += "<td colspan='2'  class = 'data'>" +args_mst.to_wh_nm+ "</td>";
                html_lst[k] += "<td  class = 'data'>" + args_mst.to_whcd+ "</td></tr>";
                html_lst[k] += "</thead>";
                html_lst[k] += "<tbody>";
            
                var total_qty = 0; //총수량
                var goodscd = []; //박스별 상품코드 담아두는 리스트
                var goodsqty = []; //박스별 상품수량 담아두는 리스트
                var goodsnm = []; //박스별 상품명 담아두는 리스트
                
                for(var i = 0; i<args_det.length; i++){
                    if(box_lst[j]==args_det[i].box_barcd){
                        total_qty += Number(args_det[i].qty);
                        
                        //goodscd.push(args_det[i].goods_cd);
                        goodscd.push((args_det[i].goods_cd).substr(0,4)+" "+(args_det[i].goods_cd).substr(4,5)+" "+(args_det[i].goods_cd).substr(9,2)+" "+(args_det[i].goods_cd).substr(11,3));
                        goodsqty.push(args_det[i].qty);
                        goodsnm.push(args_det[i].goods_nm);
                    }
                }
                j++;    
               
               //상품명 뒤에 상품코드 자르고 상품명만 가져오기
                function goodsNm(x) {
                    return (goodsnm[x]).substr(0, (goodsnm[x]).length - 11);
                }
                
                //박스바코드 - 데이터
                var data   = box_lst[k];  
                var format = "code128"; 
                
                //console.log(data+":"+format);
                $(".barcode").barcode(data, format, {
                    "barWidth"   : 1,
        		    "barHeight"  : 50,
        		    "moduleSize" : 5,
        		    "bgColor"    : 'hsl(0 0% 100%)',
        		    "color"      : 'hsl(0 0% 0%)',
        		    "fontSize"   : 10,
        		    "showHRI"    : true, // false시에 숫자 안보임
        		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
                }).css("width","100%");
        
                src = $(".barcode object").attr("data");
    
    
                //매장 박스번호 - 박스번호에서 뒤에 4자리 가져오기 -> ex. ITS-20211213-0001
                var box_no_sub = box_no_lst[k].slice(-4); // ex.0001
                
                //출하(이동구분명) GIA,GIB...
                html_lst[k] += "<tr><td rowspan='2' style='border-bottom:hidden;' class='change'>"+lg_tp+"</td>";
                html_lst[k] += "<td style='font-size:15px;'>"+ "패킹번호" +"</td>";
                //박스바코드
                html_lst[k] += "<td class='barcode' rowspan='2' colspan='4'><div class='barcode_img' style='width:400px;'><object type='image/bmp' data="+src+"></object></div></td></tr>";
    
            
                //매장박스번호
                html_lst[k] += "<td class = 'data'>"+ box_no_sub +"</td>";
                
                //박스바코드
                //html_lst[k] += "<td class='barcode' colspan='4'><div class='barcode_img' style='width:400px;'><object type='image/bmp' data="+src+"></object></div></td></tr>";
            
                //박스번호 형식 변환 (공백추가)
                //var boxnum_sp = box_lst[k].substring(0,4)+" "+box_lst[k].substring(4,8)+" "+box_lst[k].substring(8, );
                
                html_lst[k] += "<tr><td>"+ lg_tp_nm +"</td>";
                
                //박스번호
                html_lst[k] += "<td class='boxNum_data' colspan='4'>"+ box_lst[k] +"</td>";
    
                //박스별 총수량
                html_lst[k] += "<td class='allcnt_data' >"+total_qty+"ea</td></tr>";
            
                //배송구분, 배송정보
                html_lst[k] += "<tr>";
                html_lst[k] += "<td style='font-size:14px'>"+"배송구분"+"</td>";
                html_lst[k] += "<td style='font-size:14px'>"+ nzl(args_mst.ord_fileid,"") +"</td>";
                html_lst[k] += "<td style='font-size:14px'>"+"배송정보"+"</td>";
                html_lst[k] += "<td colspan='3' style='font-size:14px'>"+ nzl(args_mst.ord_content,"") +"</td>"; 
                html_lst[k] += "</tr>";
            
                //상품순번, 상품코드, 상품명, 수량, 확인수량, 비고
                
                html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                html_lst[k] += "<td style='font-size:14px'>"+"No."+"</td>";
                html_lst[k] += "<td style='font-size:14px' colspan='2'>"+"상품코드"+"</td>";
                //html_lst[k] += "<td style='font-size:15px'>"+"상품명"+"</td>";
                html_lst[k] += "<td style='font-size:14px'>"+"수량"+"</td>"; 
                html_lst[k] += "<td style='font-size:14px'>"+"확인수량"+"</td>"; 
                html_lst[k] += "<td style='font-size:14px'>"+"비고"+"</td>"; 
                html_lst[k] += "</tr>";
                
                
                if(goodscd.length < 35){ 
                
                    var cnt = 0;
    
                    for(var i = 0; i<goodscd.length; i++){ 
                        cnt++;
                        html_lst[k] += "<tr>"; /*white-space:nowrap;*/
                        html_lst[k] += "<td>"+ (i+1) +"</td>";
                        html_lst[k] += "<td style='font-size:14px' colspan='2'>"+ goodscd[i] +"</td>";
                        //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                        //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                        html_lst[k] += "<td style='font-size:14px'>"+ goodsqty[i] +"</td>"; 
                        html_lst[k] += "<td style='font-size:14px'>"+""+"</td>"; 
                        html_lst[k] += "<td>"+ args_mst.remark +"</td>"; 
                        html_lst[k] += "</tr>";
                        
                    }
                    for(var i = 0; i<34-cnt; i++){
                        html_lst[k] += "<tr>";
                        html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td colspan='2'>"+"<br>"+"</td>";
                        //html_lst[k] += "<td>"+"<br>"+"</td>";
                        html_lst[k] += "<td>"+"<br>"+"</td>"; 
                        html_lst[k] += "<td>"+"<br>"+"</td>"; 
                        html_lst[k] += "<td>"+"<br>"+"</td>"; 
                        html_lst[k] += "</tr>";
                    }
                }else {
                    /*
                    for(var i = 0; i<goodscd.length; i++){
                       if(typeof goodscd[i]== "undefined"){
                           
                            html_lst[k] += "<tr>";
                            html_lst[k] += "<td>"+"<br>"+"</td>";
                            html_lst[k] += "<td colspan='2'>"+"<br>"+"</td>";
                            //html_lst[k] += "<td>"+"<br>"+"</td>";
                            html_lst[k] += "<td>"+"<br>"+"</td>"; 
                            html_lst[k] += "<td>"+"<br>"+"</td>"; 
                            html_lst[k] += "<td>"+"<br>"+"</td>"; 
                            html_lst[k] += "</tr>";
                       }else{
                           
                        html_lst[k] += "<tr>";
                        html_lst[k] += "<td>"+ (i+1) +"</td>";
                        html_lst[k] += "<td style='font-size:14px' colspan='2'>"+ goodscd[i] +"</td>";
                        //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                        //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                        html_lst[k] += "<td style='font-size:14px'>"+ goodsqty[i] +"</td>"; 
                        html_lst[k] += "<td>"+""+"</td>"; 
                        html_lst[k] += "<td>"+ print[k][0].remark +"</td>"; 
                        html_lst[k] += "</tr>";
                       }
                    }*/
                    for(var i = 0; i<35; i++){ 
                        cnt++;
                        html_lst[k] += "<tr>"; /*white-space:nowrap;*/
                        html_lst[k] += "<td>"+ (i+1) +"</td>";
                        html_lst[k] += "<td style='font-size:14px' colspan='2'>"+ goodscd[i] +"</td>";
                        //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                        //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                        html_lst[k] += "<td style='font-size:14px'>"+ goodsqty[i] +"</td>"; 
                        html_lst[k] += "<td style='font-size:14px'>"+""+"</td>"; 
                        html_lst[k] += "<td>"+ args_mst.remark +"</td>"; 
                        html_lst[k] += "</tr>";
                    }
                        html_lst[k] += "<tr>"; /*white-space:nowrap;*/
                        html_lst[k] += "<td>...</td>";
                        html_lst[k] += "<td style='font-size:14px' colspan='2'> ... </td>";
                        //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                        //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                        html_lst[k] += "<td style='font-size:14px'>...</td>"; 
                        html_lst[k] += "<td style='font-size:14px'>"+""+"</td>"; 
                        html_lst[k] += "<td>"+""+"</td>"; 
                        html_lst[k] += "</tr>";
                }
                    
                html_lst[k] += "</tbody>";
                html_lst[k] += "</table>";
                html_lst[k] += "</div>";
                html_lst[k] += "</body>";
                html_lst[k] += "</html>";
            }
            
            var args_mst = me.pageObj["mst"].exportData()[0];
            var invar = JSON.stringify(args_mst);
            
            gfnTx(appid+"."+pgmid,"printcnt",{INVAR:invar},function(OUTVAR){
                
                if(OUTVAR.rtnCd=="OK") {
                    //console.log(OUTVAR);
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
            
            //새로운 페이지로 열어서 인쇄
            var newPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024');
            
            //패킹수를 담은 변수갯수만큼(패킹수만큼) newpage에 붙여준다
            for(var i = 0; i<html_lst.length; i++){
                newPage.document.write(html_lst[i]);
            }
            //newPage.document.write(html);
            newPage.focus();
            newPage.print();
            
            //로그 저장
            const lg_ord_no = me.pageObj.mst.getVal("lg_ord_no");
            $.extend(args, me.pageObj.mst.exportData()[0]);
            const sub = "패킹송장";
            gfnLog(pgmid, args, lg_ord_no, "print", sub);
        
        }
        
        if(me.pageObj.list.exportData("selected").length > 1) {
            gfnStatus("선택된 출고전표에 해당하는 패킹송장을 일괄 발행합니다.");
            //fnPrint5            
            me.fnPrint7();
            
        } else if(isNull(me.pageObj.mst.getVal("lg_ord_no")) || me.pageObj.mst.getVal("lg_ord_no")=="TBD"){
            gfnAlert("패킹송장 발행확인","출고지시/예정내역이 선택되지 않았습니다.");
            return;
        } else {
            var args = me.pageObj["pageCond"].exportData()[0];
            var args_mst = me.pageObj["mst"].exportData()[0]; // lg_dt: 물류일자, to_whcd: 받는창고
            var args_det = me.pageObj["det"].exportData(); //box_barcd: 박스번호,바코드
            _fnPrint3(args,args_mst,args_det);    
        }  
        
    }
    
    //print7 : 목록에서 선택된 모든 출고전표의 패킹송장 발행
    me.fnPrint7=function() {
        var args = me.pageObj.pageCond.exportData()[0];
        args.list = extract( me.pageObj["list"].exportData("selected"), "lg_ord_no", "distinct"); 
         
        var invar = JSON.stringify(args);
        console.log(args); 
        gfnTx(appid+"."+pgmid,"print6",{INVAR:invar},function(OUTVAR){
            $("#onloading1").remove(); 
            if(OUTVAR.rtnCd=="OK") {
                console.log(OUTVAR);
                var prtData = [];
                for(var i = 0; i<OUTVAR.list.length; i++){
                    prtData.push(eval("OUTVAR.arlist.goodslist"+i));
                }
                var total = prtData.length;

                function _fnPrint100(print) {
                    var html_lst = [];
                    for(var i = 0; i<print.length; i++){
                        html_lst.push("html"+i);
                    }
                    
                    //패킹수만큼 찍어낸다
                    for(var k = 0; k<print.length; k++){ 
            
                        html_lst[k] = "<html>";
                        //사이즈 조절, css
                        html_lst[k] += "<head><style type='text/css'> .boxLabel {border-collapse:collapse;border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;}.boxLabel .change{font-size:30px; font-weight: bold; border-bottom:hidden}.boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel .date{font-size: 15px;}.boxLabel .from{ font-size: 15px;} .boxLabel .to{font-size: 15px;}.boxLabel .code{font-size: 15px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 1;}.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 13px;} .boxLabel th{border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;}.boxLabel .boxNum_data{font-weight: bold; text-align:center; vertical-align:middle; font-size: 30px;} .boxLabel .boxNum{font-weight: bold; text-align:center; vertical-align:middle;}.boxLabel .allcnt_data{font-weight: bold; text-align:center; vertical-align:middle; font-size:30px;} /*Web Print*/ body {margin: 0;padding-top:10;} .barcode_img>object {width: 80%; height: 50px;} .boxLabel{border: 3px black solid; width:100% height:100%} .page {width: 210mm; min-height: 297mm;} @media print {.page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; /*padding-top:38;*/}}</style></head>";
                        html_lst[k] += "<body>";
                        html_lst[k] += "<div class='page'>";
                        html_lst[k] += "<table class='boxLabel' style='table-layout:fixed; width:500px; overflow:hidden;white-space:nowrap; text-overflow:ellipsis;'>";
                        html_lst[k] += "<thead>";
                        
                        html_lst[k] += "<tr><th class='date' style='width:25mm'>일자</th><th class='from' style='width:35mm;'>보내는곳</th><th class='code' style='width:45mm;'>코드</th><th class='to' colspan='2' style='width:35mm;'>받는곳</th><th class='code' style='width:35mm;'>코드</th></tr>";
                        
                        //일자 형식 변환  ex) 2021-04-27
                        var date = (print[k][0].lg_dt).substring(0, 4)+"-"+(print[k][0].lg_dt).substring(4, 6)+"-"+(print[k][0].lg_dt).substring(6, 8);
            
                        //물류,매장 이름
                        var whcd_nm = gfnCdNm("whcd", print[k][0].from_whcd, "nm");
                        var to_whcd_nm = gfnCdNm("whcd", print[k][0].to_whcd, "nm");
                        
                        //일자, 보내는곳, 보내는곳코드, 받는곳, 받는곳코드
                        html_lst[k] += "<tr><td style='font-size:17px;'>"+ date +"</td>";
                        html_lst[k] += "<td class = 'data'>" + whcd_nm + "</td>";
                        html_lst[k] += "<td class = 'data'>" + print[k][0].from_whcd+ "</td>";
                        html_lst[k] += "<td colspan='2'  class = 'data'>" +to_whcd_nm+ "</td>";
                        html_lst[k] += "<td  class = 'data'>" + print[k][0].to_whcd + "</td></tr>";
                        html_lst[k] += "</thead>";
                        html_lst[k] += "<tbody>";
                    
                        //상품순번, 상품코드, 수량
                        var goodscd = [];
                        var goodsqty = [];
                        //goodscd.push(OUTVAR.prnt2[k].goods_cd);
                        print[k].forEach((row) => {
                            goodscd.push((row.goods_cd).substr(0,4)+" "+(row.goods_cd).substr(4,5)+" "+(row.goods_cd).substr(9,2)+" "+(row.goods_cd).substr(11,3));
                            goodsqty.push(row.qty);
                        })
                        
                        //박스별 총수량
                        var total_qty = 0;
                        for(var j = 0; j<goodsqty.length; j++){
                            total_qty += Number(goodsqty[j]);
                        }
                       
                       /*
                       //상품명 뒤에 상품코드 자르고 상품명만 가져오기
                        function goodsNm(x) {
                            return (goodsnm[x]).substr(0, (goodsnm[x]).length - 11);
                        }
                        */
                        
                        //박스바코드 - 데이터
                        var data   = print[k][0].box_barcd;  
                        var format = "code128"; 
                        
                        //console.log(data+":"+format);
                        $(".barcode").barcode(data, format, {
                            "barWidth"   : 1,
                		    "barHeight"  : 50,
                		    "moduleSize" : 5,
                		    "bgColor"    : 'hsl(0 0% 100%)',
                		    "color"      : 'hsl(0 0% 0%)',
                		    "fontSize"   : 10,
                		    "showHRI"    : true, // false시에 숫자 안보임
                		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
                        }).css("width","100%");
                
                        src = $(".barcode object").attr("data");
            
            
                        //매장 박스번호 - 박스번호에서 뒤에 4자리 가져오기 -> ex. ITS-20211213-0001
                        var box_no_sub = (print[k][0].box_no).substr(-4); // ex.0001
                        //if(inStr((print[k][0].dist_nm).substr(0,4),"20SS")>=0) box_no_sub = (print[k][0].goods_cd).substr(2,7);
                        if(inStr((print[k][0].ord_content).substr(0,4),"20SS")>=0) box_no_sub = print[k][0].dist_nm;
                        
                        //출하(이동구분명) GIA,GIB...
                        html_lst[k] += "<tr><td rowspan='2' style='border-bottom:hidden;' class='change'>"+print[k][0].lg_tp+"</td>";
                        html_lst[k] += "<td style='font-size:15px;'>"+ "패킹번호" +"</td>";
                        //박스바코드
                        html_lst[k] += "<td class='barcode' rowspan='2' colspan='4'><div class='barcode_img' style='width:400px;'><object type='image/bmp' data="+src+"></object></div></td></tr>";
            
                    
                        //매장박스번호
                        html_lst[k] += "<td class = 'data'>"+ box_no_sub +"</td>";
                        
                        //박스바코드
                        //html_lst[k] += "<td class='barcode' colspan='4'><div class='barcode_img' style='width:400px;'><object type='image/bmp' data="+src+"></object></div></td></tr>";
                    
                        //박스번호 형식 변환 (공백추가)
                        //var boxnum_sp = box_lst[k].substring(0,4)+" "+box_lst[k].substring(4,8)+" "+box_lst[k].substring(8, );
                        
                        var lg_tp_nm = gfnCdNm("LG_TP_I", print[k][0].lg_tp, "nm");
                        html_lst[k] += "<tr><td>"+ lg_tp_nm +"</td>";
                        
                        //박스번호
                        html_lst[k] += "<td class='boxNum_data' colspan='4'>"+ data +"</td>";
            
                        //박스별 총수량
                        html_lst[k] += "<td class='allcnt_data' >"+total_qty+"ea</td></tr>";
                    
                        //배송구분, 배송정보
                        html_lst[k] += "<tr>";
                        html_lst[k] += "<td style='font-size:14px'>"+"배송구분"+"</td>";
                        html_lst[k] += "<td style='font-size:14px'>"+ nzl(print[k][0].ord_fileid,"") +"</td>";
                        html_lst[k] += "<td style='font-size:14px'>"+"배송정보"+"</td>";
                        html_lst[k] += "<td colspan='3' style='font-size:14px'>"+ nzl(print[k][0].ord_content,"") +"</td>"; 
                        html_lst[k] += "</tr>";
                    
                        //상품순번, 상품코드, 상품명, 수량, 확인수량, 비고
                        
                        html_lst[k] += "<tr>";
                        html_lst[k] += "<td style='font-size:14px'>"+"No."+"</td>";
                        html_lst[k] += "<td style='font-size:14px' colspan='2'>"+"상품코드"+"</td>";
                        //html_lst[k] += "<td style='font-size:15px'>"+"상품명"+"</td>";
                        html_lst[k] += "<td style='font-size:14px'>"+"수량"+"</td>"; 
                        html_lst[k] += "<td style='font-size:14px'>"+"확인수량"+"</td>"; 
                        html_lst[k] += "<td style='font-size:14px'>"+"비고"+"</td>"; 
                        html_lst[k] += "</tr>";
                        
                        
                        if(goodscd.length < 35){ 
            
                            var cnt = 0;
            
                            for(var i = 0; i<goodscd.length; i++){ 
                                cnt++;
                                html_lst[k] += "<tr>"; /*white-space:nowrap;*/
                                html_lst[k] += "<td>"+ (i+1) +"</td>";
                                html_lst[k] += "<td style='font-size:14px' colspan='2'>"+ goodscd[i] +"</td>";
                                //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                                //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                                html_lst[k] += "<td style='font-size:14px'>"+ goodsqty[i] +"</td>"; 
                                html_lst[k] += "<td style='font-size:14px'>"+""+"</td>"; 
                                html_lst[k] += "<td>"+ print[k][0].remark +"</td>"; 
                                html_lst[k] += "</tr>";
                                
                            }
                            for(var i = 0; i<34-cnt; i++){
                                html_lst[k] += "<tr>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td colspan='2'>"+"<br>"+"</td>";
                                //html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>"; 
                                html_lst[k] += "<td>"+"<br>"+"</td>"; 
                                html_lst[k] += "<td>"+"<br>"+"</td>"; 
                                html_lst[k] += "</tr>";
                            }
                        }else {
                            /*
                            for(var i = 0; i<goodscd.length; i++){
                               if(typeof goodscd[i]== "undefined"){
                                   
                                    html_lst[k] += "<tr>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "<td colspan='2'>"+"<br>"+"</td>";
                                    //html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>"; 
                                    html_lst[k] += "<td>"+"<br>"+"</td>"; 
                                    html_lst[k] += "<td>"+"<br>"+"</td>"; 
                                    html_lst[k] += "</tr>";
                               }else{
                                   
                                html_lst[k] += "<tr>";
                                html_lst[k] += "<td>"+ (i+1) +"</td>";
                                html_lst[k] += "<td style='font-size:14px' colspan='2'>"+ goodscd[i] +"</td>";
                                //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                                //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                                html_lst[k] += "<td style='font-size:14px'>"+ goodsqty[i] +"</td>"; 
                                html_lst[k] += "<td>"+""+"</td>"; 
                                html_lst[k] += "<td>"+ print[k][0].remark +"</td>"; 
                                html_lst[k] += "</tr>";
                               }
                            }*/
                            for(var i = 0; i<35; i++){ 
                                cnt++;
                                html_lst[k] += "<tr>"; /*white-space:nowrap;*/
                                html_lst[k] += "<td>"+ (i+1) +"</td>";
                                html_lst[k] += "<td style='font-size:14px' colspan='2'>"+ goodscd[i] +"</td>";
                                //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                                //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                                html_lst[k] += "<td style='font-size:14px'>"+ goodsqty[i] +"</td>"; 
                                html_lst[k] += "<td style='font-size:14px'>"+""+"</td>"; 
                                html_lst[k] += "<td>"+ print[k][0].remark +"</td>"; 
                                html_lst[k] += "</tr>";
                            }
                                html_lst[k] += "<tr>"; /*white-space:nowrap;*/
                                html_lst[k] += "<td>...</td>";
                                html_lst[k] += "<td style='font-size:14px' colspan='2'> ... </td>";
                                //html_lst[k] += "<td>"+ goodscd[i] +"</td>";
                                //html_lst[k] += "<td>"+ goodsNm(i) +"</td>";
                                html_lst[k] += "<td style='font-size:14px'>...</td>"; 
                                html_lst[k] += "<td style='font-size:14px'>"+""+"</td>"; 
                                html_lst[k] += "<td>"+""+"</td>"; 
                                html_lst[k] += "</tr>";
                        }    
                        
                            
                        html_lst[k] += "</tbody>";
                        html_lst[k] += "</table>";
                        html_lst[k] += "</div>";
                        html_lst[k] += "</body>";
                        html_lst[k] += "</html>";
                    }
                    //새로운 페이지로 열어서 인쇄
                    var prtPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024, modal=yes');
                    
                    //패킹수를 담은 변수갯수만큼(패킹수만큼) newpage에 붙여준다
                    for(var i = 0; i<html_lst.length; i++){
                        prtPage.document.write(html_lst[i]);
                    }
                    prtPage.focus();
                    prtPage.print(); 
                    console.log("print done");
                    
                    //인쇄페이지에서 벗어났을 때
                    prtPage.onbeforeunload = function(){
                        console.log("win unload");
                    
                        if(prtData.length > 100) {
                            gfnConfirm("연속출력 확인","발행대상(대상: "+prtData.length+" / 총 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                                if(rtn) {
                                    var data = prtData.splice(0,100);
                                    //console.log(data);
                                    _fnPrint100(data);
                                }
                            });    
                        }else{
                            //console.log(data);
                            if(prtData.length == 0){
                                gfnAlert("연속출력 확인","패킹송장 발행, 총: "+total+"건이 완료되었습니다.");
                                return;
                            }
                            gfnConfirm("연속출력 확인","발행대상(대상: "+prtData.length+" / 총 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                                if(rtn) {
                                    var data = prtData.splice(0,100);
                                    _fnPrint100(data);
                                }
                            }); 
                        }
                    }
                }
                //패킹수 100개 이상일 경우 100건씩 나누어 발행
                if(total > 100) {
                    gfnConfirm("연속출력 확인","발행대상(건수 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                        if(rtn) {
                            var data = prtData.splice(0,100);
                            //console.log(data);
                            
                            _fnPrint100(data);
                        }
                    });
                } else {
                    var data = prtData.splice(0,100);
                    _fnPrint100(data);
                }
            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
        });
    } 
    
    
    //print5 : 초도출하 패킹라벨 발행
    me.fnPrint5=function() {

        var args_list = me.pageObj["list"].exportData("selected")[0];
        if(isNull(args_list.dist_no)){
            gfnAlert("발행확인","초도출하 배분건에 대해서만 발행이 가능합니다.");
            return;
        } 
        var invar = JSON.stringify(args_list);
        //console.log(args);
        
        gfnTx(appid+"."+pgmid,"print5",{INVAR:invar},function(OUTVAR){
            $("#onloading1").remove(); 
            if(OUTVAR.rtnCd=="OK") {
                console.log(OUTVAR);
                var prtData = [];
                for(var i = 0; i<OUTVAR.list.length; i++){
                    prtData.push(eval("OUTVAR.arlist.goodslist"+i));
                }
                var total = prtData.length;

                function _fnPrint100(print) {
                    var html_lst = [];
                    for(var i = 0; i<print.length; i++){
                        html_lst.push("html"+i);
                    }
                    
                    for(var k = 0; k<print.length; k++){ 
                        
                        html_lst[k] = "<html>";
                        //사이즈 조절, css
                        html_lst[k] += "<head><style type='text/css'> .boxLabel {border-collapse:collapse;border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;}.boxLabel .change{font-size:30px; font-weight: bold; border-bottom:hidden} .boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel .date{font-size: 15px;}.boxLabel .from{ font-size: 15px;} .boxLabel .to{font-size: 15px;}.boxLabel .code{font-size: 15px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 1;}.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 15px;}.boxLabel th{border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;} .boxLabel .goods{border-right: 4px black solid;} .boxLabel .boxNum_data{font-weight: bold; text-align:center; vertical-align:middle; font-size: 30px;} .barcode_img>object {width: 80%; height: 50px;} .boxLabel .boxNum{font-weight: bold; text-align:center; vertical-align:middle;}.boxLabel .allcnt_data{font-weight: bold; text-align:center; vertical-align:middle; font-size:30px;} /*Web Print*/ body {margin: 0; padding-left: 28; padding-top:18; padding-bottom:10;} .boxLabel{border: 3px black solid; width: 200mm/*112mm*/; /*225*/height: 140mm/*84mm*/; /*175*/}@page {size: 140mm 110mm; /*7.62cm 5.08cm 94 64 96 62*/ /*인쇄기본설정 => w:66mm, h:88mm*/margin: 0;}@media print {.page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; padding-top:38;}}</style></head>";
                        html_lst[k] += "<body>";
                        html_lst[k] += "<div class='page'>";
                        html_lst[k] += "<table class='boxLabel' style='table-layout:fixed'>";
                        html_lst[k] += "<thead>";
                        
                        html_lst[k] += "<tr><th class='date' style='width:25mm'>일자</th><th class='from'>보내는곳</th><th class='code' style='width:25mm;'>코드</th><th class='code' style='width:25mm;'>패킹번호</th><th class='to'>받는곳</th><th class='code' style='width:25mm;'>코드</th></tr>";
                        
                        //일자 형식 변환  ex) 2021-04-27
                        var date = (print[k][0].lg_dt).substring(0, 4)+"-"+(print[k][0].lg_dt).substring(4, 6)+"-"+(print[k][0].lg_dt).substring(6, 8);
                        
                        //매장 박스번호 - 박스번호에서 뒤에 4자리 가져오기 -> ex. ITS-20211213-0001
                        var box_no_sub = (print[k][0].box_no).slice(-4); // ex.0001
                        if(inStr(nzl((args_list.dist_nm),"").substr(0,4),"20SS")>=0) box_no_sub = (print[k][0].goods_cd).substr(2,7);
                        //if(inStr(args.stat_cd,"20SS")>=0) box_no_sub = (print[k][0].goods_cd).substr(2,7);
                        
                        //물류,매장 이름
                        var whcd_nm = gfnCdNm("whcd", print[k][0].from_whcd, "nm");
                        var to_whcd_nm = gfnCdNm("whcd", print[k][0].to_whcd, "nm");
                        
                        //일자, 보내는곳, 보내는곳코드, 받는곳, 받는곳코드
                        html_lst[k] += "<tr><td style='font-size:17px;'>"+date+"</td>";
                        html_lst[k] += "<td class = 'data'>" + whcd_nm + "</td>";
                        html_lst[k] += "<td class = 'data'>" + print[k][0].from_whcd + "</td>";
                        html_lst[k] += "<td class = 'data'>" + box_no_sub + "</td>"; //박스번호 0001
                        html_lst[k] += "<td class = 'data' style='font-size: 27px;'>" + to_whcd_nm+ "</td>";
                        html_lst[k] += "<td  class = 'data' style='font-size: 27px;'>" + print[k][0].to_whcd+ "</td></tr>";
                        html_lst[k] += "</thead>";
                        html_lst[k] += "<tbody>";
                    
                        //박스바코드 - 데이터
                        var data   = print[k][0].box_barcd; 
                        var format = "code128"; 
                        //console.log(data+":"+format);
                        $(".barcode").barcode(data, format, {
                            "barWidth"   : 1,
                		    "barHeight"  : 50,
                		    "moduleSize" : 5,
                		    "bgColor"    : 'hsl(0 0% 100%)',
                		    "color"      : 'hsl(0 0% 0%)',
                		    "fontSize"   : 10,
                		    "showHRI"    : true, // false시에 숫자 안보임
                		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
                        }).css("width","100%");
                
                        src = $(".barcode object").attr("data");
            
                        //물류유형 - 초도출하
                        html_lst[k] += "<tr><td class='change'>"+ print[k][0].lg_tp+"</td>";
                        
                        //박스바코드
                        html_lst[k] += "<td class='barcode' colspan='5'><div class='barcode_img'><object type='image/bmp' data="+src+"></object></div></td></tr>";
                    
                        var lg_tp_nm = gfnCdNm("LG_TP_I", print[k][0].lg_tp, "nm");
                        html_lst[k] += "<tr><td>"+ lg_tp_nm +"</td>";
                        
                        //박스바코드번호
                        //박스바코드번호 형식 변환 (공백추가)
                        var boxnum_sp = data.substr(0,5)+" "+data.substr(5,5)+" "+data.substring(10, );
                        if(inStr(nzl((args_list.dist_nm),"").substr(0,4),"20SS")>=0) boxnum_sp = data.substr(0,5)+" "+data.substr(5,6)+" "+data.substring(11, );
                        //if(inStr(args.stat_cd,"20SS")>=0) boxnum_sp = data.substr(0,5)+" "+data.substr(5,6)+" "+data.substring(11, );
                        
                        html_lst[k] += "<td class='boxNum_data' colspan='4'>"+ boxnum_sp +"</td>";
            
                        //상품순번, 상품코드, 수량
                        var goodscd = [];
                        var goodsqty = [];
                        //goodscd.push(OUTVAR.prnt2[k].goods_cd);
                        print[k].forEach((row) => {
                            //goodscd.push(row.goods_cd);
                            goodscd.push((row.goods_cd).substr(0,4)+" "+(row.goods_cd).substr(4,5)+" "+(row.goods_cd).substr(9,2)+" "+(row.goods_cd).substr(11,3));
                            goodsqty.push(row.qty);
                        })
                        
                        //박스별 총수량
                        var total_qty = 0;
                        for(var j = 0; j<goodsqty.length; j++){
                            total_qty += Number(goodsqty[j]);
                        }
                        html_lst[k] += "<td class='allcnt_data' >"+ total_qty +"ea</td></tr>"; ///////////////////
                        
                        if(goodscd.length <= 10){ //상품 갯수가 10개 이하일때
                            var cnt = 0;
                            var cnt_right = 0;
                            for(var i = 0; i<goodscd.length; i++){ 
                                cnt++;
                                html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                html_lst[k] += "<td>"+(i+1)+"</td>";
                                html_lst[k] += "<td>"+ goodscd[i]+"</td>";
                                html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "</tr>";
                            }
                            for(var i = 0; i<10-cnt; i++){
                                html_lst[k] += "<tr>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td class='goods'>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "</tr>";
                            }
                        }else { //상품 갯수가 10개 이상일 때
                        
                            var cnt_right = 0;
            
                            if(goodscd.length <= 20){ //상품 갯수가 20개이하
                                
                                for(var i = 0; i<goodscd.length-10; i++){
                                    cnt_right++;
                                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                    html_lst[k] += "<td>"+(i+1)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i]+"</td>";
                                    html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                    html_lst[k] += "<td>"+(i+11)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i+10]+"</td>";
                                    html_lst[k] += "<td>"+goodsqty[i+10]+"</td>";
                                    html_lst[k] += "</tr>";
                                }
                                //console.log(cnt_right);
                                for(var i = cnt_right; i<10; i++){
                                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                    html_lst[k] += "<td>"+(i+1)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i]+"</td>";
                                    html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "</tr>";
                                }
                            }else{ //상품 갯수가 20개 이상일때
                                for(var i = 0; i<9; i++){
                                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                    html_lst[k] += "<td>"+(i+1)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i]+"</td>";
                                    html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                    html_lst[k] += "<td>"+(i+11)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i+11]+"</td>";
                                    html_lst[k] += "<td>"+goodsqty[i+11]+"</td>";
                                    html_lst[k] += "</tr>";
                                } 
                                html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                html_lst[k] += "<td>"+10+"</td>";
                                html_lst[k] += "<td>"+goodscd[9]+"</td>";
                                html_lst[k] += "<td class='goods'>"+goodsqty[9]+"</td>";
                                html_lst[k] += "<td>...</td>";
                                html_lst[k] += "<td>... 외 "+ Number(goodscd.length-19) +"</td>";
                                html_lst[k] += "<td>...</td>";
                                html_lst[k] += "</tr>";
                            }
                        }
                        html_lst[k] += "</tbody>";
                        html_lst[k] += "</table>";
                        html_lst[k] += "</div>";
                        html_lst[k] += "</body>";
                        html_lst[k] += "</html>";
                    }
                    //새로운 페이지로 열어서 인쇄
                    var prtPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024, modal=yes');
                    
                    //패킹수를 담은 변수갯수만큼(패킹수만큼) newpage에 붙여준다
                    for(var i = 0; i<html_lst.length; i++){
                        prtPage.document.write(html_lst[i]);
                    }
                    prtPage.focus();
                    prtPage.print(); 
                    console.log("print done");
                    
                    //인쇄페이지에서 벗어났을 때
                    prtPage.onbeforeunload = function(){
                        console.log("win unload");
                    
                        if(prtData.length > 100) {
                            gfnConfirm("연속출력 확인","발행대상(대상: "+prtData.length+" / 총 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                                if(rtn) {
                                    var data = prtData.splice(0,100);
                                    //console.log(data);
                                    _fnPrint100(data);
                                }
                            });    
                        }else{
                            //console.log(data);
                            if(prtData.length == 0){
                                gfnAlert("연속출력 확인","패킹라벨 발행, 총: "+total+"건이 완료되었습니다.");
                                return;
                            }
                            gfnConfirm("연속출력 확인","발행대상(대상: "+prtData.length+" / 총 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                                if(rtn) {
                                    var data = prtData.splice(0,100);
                                    _fnPrint100(data);
                                }
                            }); 
                        }
                    }
                }
                //패킹수 100개 이상일 경우 100건씩 나누어 발행
                if(total > 100) {
                    gfnConfirm("연속출력 확인","발행대상(건수 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                        if(rtn) {
                            var data = prtData.splice(0,100);
                            //console.log(data);
                            
                            _fnPrint100(data);
                        }
                    });
                } else {
                    var data = prtData.splice(0,100);
                    _fnPrint100(data);
                }
            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
        });
    }
    
    
    //print6 : 목록에서 선택된 모든 출고전표의 패킹라벨 발행
    me.fnPrint6=function() {
        var args = me.pageObj.pageCond.exportData()[0];
        args.list = extract( me.pageObj["list"].exportData("selected"), "lg_ord_no", "distinct"); 
         
        var invar = JSON.stringify(args);
        console.log(args); 
        gfnTx(appid+"."+pgmid,"print6",{INVAR:invar},function(OUTVAR){
            $("#onloading1").remove(); 
            if(OUTVAR.rtnCd=="OK") {
                console.log(OUTVAR);
                var prtData = [];
                for(var i = 0; i<OUTVAR.list.length; i++){
                    prtData.push(eval("OUTVAR.arlist.goodslist"+i));
                }
                var total = prtData.length;

                function _fnPrint100(print) {
                    var html_lst = [];
                    for(var i = 0; i<print.length; i++){
                        html_lst.push("html"+i);
                    }
                    
                    for(var k = 0; k<print.length; k++){ 
                        
                        html_lst[k] = "<html>";
                        //사이즈 조절, css
                        html_lst[k] += "<head><style type='text/css'> .boxLabel {border-collapse:collapse;border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;}.boxLabel .change{font-size:30px; font-weight: bold; border-bottom:hidden} .boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel .date{font-size: 15px;}.boxLabel .from{ font-size: 15px;} .boxLabel .to{font-size: 15px;}.boxLabel .code{font-size: 15px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 1;}.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; font-size: 15px;}.boxLabel th{border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;} .boxLabel .goods{border-right: 4px black solid;} .boxLabel .boxNum_data{font-weight: bold; text-align:center; vertical-align:middle; font-size: 30px;} .barcode_img>object {width: 80%; height: 50px;} .boxLabel .boxNum{font-weight: bold; text-align:center; vertical-align:middle;}.boxLabel .allcnt_data{font-weight: bold; text-align:center; vertical-align:middle; font-size:30px;} /*Web Print*/ body {margin: 0; padding-left: 28; padding-top:18; padding-bottom:10;} .boxLabel{border: 3px black solid; width: 200mm/*112mm*/; /*225*/height: 140mm/*84mm*/; /*175*/}@page {size: 140mm 110mm; /*7.62cm 5.08cm 94 64 96 62*/ /*인쇄기본설정 => w:66mm, h:88mm*/margin: 0;}@media print {.page { margin: 0;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; padding-top:38;}}</style></head>";
                        html_lst[k] += "<body>";
                        html_lst[k] += "<div class='page'>";
                        html_lst[k] += "<table class='boxLabel' style='table-layout:fixed'>";
                        html_lst[k] += "<thead>";
                        
                        html_lst[k] += "<tr><th class='date' style='width:25mm'>일자</th><th class='from'>보내는곳</th><th class='code' style='width:25mm;'>코드</th><th class='code' style='width:25mm;'>패킹번호</th><th class='to'>받는곳</th><th class='code' style='width:25mm;'>코드</th></tr>";
                        
                        //일자 형식 변환  ex) 2021-04-27
                        var date = (print[k][0].lg_dt).substring(0, 4)+"-"+(print[k][0].lg_dt).substring(4, 6)+"-"+(print[k][0].lg_dt).substring(6, 8);
                        
                        //매장 박스번호 - 박스번호에서 뒤에 4자리 가져오기 -> ex. ITS-20211213-0001
                        var box_no_sub = print[k][0].dist_nm; // ex.0001
                        //if(inStr((args_list.dist_nm).substr(0,4),"20SS")>=0) box_no_sub = (print[k][0].goods_cd).substr(2,7);
                        //if(inStr(args.stat_cd,"20SS")>=0) box_no_sub = (print[k][0].goods_cd).substr(2,7);
                        
                        //물류,매장 이름
                        var whcd_nm = gfnCdNm("whcd", print[k][0].from_whcd, "nm");
                        var to_whcd_nm = gfnCdNm("whcd", print[k][0].to_whcd, "nm");
                        
                        //일자, 보내는곳, 보내는곳코드, 받는곳, 받는곳코드
                        html_lst[k] += "<tr><td style='font-size:17px;'>"+date+"</td>";
                        html_lst[k] += "<td class = 'data'>" + whcd_nm + "</td>";
                        html_lst[k] += "<td class = 'data'>" + print[k][0].from_whcd + "</td>";
                        html_lst[k] += "<td class = 'data'>" + box_no_sub + "</td>"; //박스번호 0001
                        html_lst[k] += "<td class = 'data' style='font-size: 27px;'>" + to_whcd_nm+ "</td>";
                        html_lst[k] += "<td  class = 'data' style='font-size: 27px;'>" + print[k][0].to_whcd+ "</td></tr>";
                        html_lst[k] += "</thead>";
                        html_lst[k] += "<tbody>";
                    
                        //박스바코드 - 데이터
                        var data   = print[k][0].box_barcd; 
                        var format = "code128"; 
                        //console.log(data+":"+format);
                        $(".barcode").barcode(data, format, {
                            "barWidth"   : 1,
                		    "barHeight"  : 50,
                		    "moduleSize" : 5,
                		    "bgColor"    : 'hsl(0 0% 100%)',
                		    "color"      : 'hsl(0 0% 0%)',
                		    "fontSize"   : 10,
                		    "showHRI"    : true, // false시에 숫자 안보임
                		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
                        }).css("width","100%");
                
                        src = $(".barcode object").attr("data");
            
                        //물류유형 - 초도출하
                        html_lst[k] += "<tr><td class='data'>"+ print[k][0].ord_content+"</td>";
                        
                        //박스바코드
                        html_lst[k] += "<td class='barcode' colspan='5'><div class='barcode_img'><object type='image/bmp' data="+src+"></object></div></td></tr>";
                    
                        var lg_tp_nm = gfnCdNm("LG_TP_I", print[k][0].lg_tp, "nm");
                        html_lst[k] += "<tr><td>"+ lg_tp_nm +"</td>";
                        
                        //박스바코드번호
                        //박스바코드번호 형식 변환 (공백추가)
                        var boxnum_sp = data.substr(0,5)+" "+data.substr(5,5)+" "+data.substring(10, );
                        //if(inStr((args_list.dist_nm).substr(0,4),"20SS")>=0) boxnum_sp = data.substr(0,5)+" "+data.substr(5,6)+" "+data.substring(11, );
                        //if(inStr(args.stat_cd,"20SS")>=0) boxnum_sp = data.substr(0,5)+" "+data.substr(5,6)+" "+data.substring(11, );
                        
                        html_lst[k] += "<td class='boxNum_data' colspan='4'>"+ boxnum_sp +"</td>";
            
                        //상품순번, 상품코드, 수량
                        var goodscd = [];
                        var goodsqty = [];
                        //goodscd.push(OUTVAR.prnt2[k].goods_cd);
                        print[k].forEach((row) => {
                            //goodscd.push(row.goods_cd);
                            goodscd.push((row.goods_cd).substr(0,4)+" "+(row.goods_cd).substr(4,5)+" "+(row.goods_cd).substr(9,2)+" "+(row.goods_cd).substr(11,3));
                            goodsqty.push(row.qty);
                        })
                        
                        //박스별 총수량
                        var total_qty = 0;
                        for(var j = 0; j<goodsqty.length; j++){
                            total_qty += Number(goodsqty[j]);
                        }
                        html_lst[k] += "<td class='allcnt_data' >"+ total_qty +"ea</td></tr>"; ///////////////////
                        
                        if(goodscd.length <= 10){ //상품 갯수가 10개 이하일때
                            var cnt = 0;
                            var cnt_right = 0;
                            for(var i = 0; i<goodscd.length; i++){ 
                                cnt++;
                                html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                html_lst[k] += "<td>"+(i+1)+"</td>";
                                html_lst[k] += "<td>"+ goodscd[i]+"</td>";
                                html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "</tr>";
                            }
                            for(var i = 0; i<10-cnt; i++){
                                html_lst[k] += "<tr>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td class='goods'>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "<td>"+"<br>"+"</td>";
                                html_lst[k] += "</tr>";
                            }
                        }else { //상품 갯수가 10개 이상일 때
                        
                            var cnt_right = 0;
            
                            if(goodscd.length <= 20){ //상품 갯수가 20개이하
                                
                                for(var i = 0; i<goodscd.length-10; i++){
                                    cnt_right++;
                                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                    html_lst[k] += "<td>"+(i+1)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i]+"</td>";
                                    html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                    html_lst[k] += "<td>"+(i+11)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i+10]+"</td>";
                                    html_lst[k] += "<td>"+goodsqty[i+10]+"</td>";
                                    html_lst[k] += "</tr>";
                                }
                                //console.log(cnt_right);
                                for(var i = cnt_right; i<10; i++){
                                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                    html_lst[k] += "<td>"+(i+1)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i]+"</td>";
                                    html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "<td>"+"<br>"+"</td>";
                                    html_lst[k] += "</tr>";
                                }
                            }else{ //상품 갯수가 20개 이상일때
                                for(var i = 0; i<9; i++){
                                    html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                    html_lst[k] += "<td>"+(i+1)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i]+"</td>";
                                    html_lst[k] += "<td class='goods'>"+goodsqty[i]+"</td>";
                                    html_lst[k] += "<td>"+(i+11)+"</td>";
                                    html_lst[k] += "<td>"+goodscd[i+11]+"</td>";
                                    html_lst[k] += "<td>"+goodsqty[i+11]+"</td>";
                                    html_lst[k] += "</tr>";
                                } 
                                html_lst[k] += "<tr style='text-overflow:clip; white-space:nowrap; overflow:hidden;'>";
                                html_lst[k] += "<td>"+10+"</td>";
                                html_lst[k] += "<td>"+goodscd[9]+"</td>";
                                html_lst[k] += "<td class='goods'>"+goodsqty[9]+"</td>";
                                html_lst[k] += "<td>...</td>";
                                html_lst[k] += "<td>... 외 "+ Number(goodscd.length-19) +"</td>";
                                html_lst[k] += "<td>...</td>";
                                html_lst[k] += "</tr>";
                            }
                        }
                        html_lst[k] += "</tbody>";
                        html_lst[k] += "</table>";
                        html_lst[k] += "</div>";
                        html_lst[k] += "</body>";
                        html_lst[k] += "</html>";
                    }
                    //새로운 페이지로 열어서 인쇄
                    var prtPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024, modal=yes');
                    
                    //패킹수를 담은 변수갯수만큼(패킹수만큼) newpage에 붙여준다
                    for(var i = 0; i<html_lst.length; i++){
                        prtPage.document.write(html_lst[i]);
                    }
                    prtPage.focus();
                    prtPage.print(); 
                    console.log("print done");
                    
                    //인쇄페이지에서 벗어났을 때
                    prtPage.onbeforeunload = function(){
                        console.log("win unload");
                    
                        if(prtData.length > 100) {
                            gfnConfirm("연속출력 확인","발행대상(대상: "+prtData.length+" / 총 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                                if(rtn) {
                                    var data = prtData.splice(0,100);
                                    //console.log(data);
                                    _fnPrint100(data);
                                }
                            });    
                        }else{
                            //console.log(data);
                            if(prtData.length == 0){
                                gfnAlert("연속출력 확인","패킹라벨 발행, 총: "+total+"건이 완료되었습니다.");
                                return;
                            }
                            gfnConfirm("연속출력 확인","발행대상(대상: "+prtData.length+" / 총 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                                if(rtn) {
                                    var data = prtData.splice(0,100);
                                    _fnPrint100(data);
                                }
                            }); 
                        }
                    }
                }
                //패킹수 100개 이상일 경우 100건씩 나누어 발행
                if(total > 100) {
                    gfnConfirm("연속출력 확인","발행대상(건수 : "+total+")을 100건씩 나누어 발행합니다.",function(rtn){
                        if(rtn) {
                            var data = prtData.splice(0,100);
                            //console.log(data);
                            
                            _fnPrint100(data);
                        }
                    });
                } else {
                    var data = prtData.splice(0,100);
                    _fnPrint100(data);
                }
            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
        });
    } 
    

/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>