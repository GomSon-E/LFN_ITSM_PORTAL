<style>[pgmid='RTNaccept'].framepage .userClass { 
width:100%; 
}

/*[pgmid='RTNaccept'] button[colid='denied'] {*/
/*    background-color: hsl(3 100% 61.4%) !important;*/
/*}*/</style>

<!-- HTML autogen start ---------------------------------------------- -->            
<div class="pageNav"></div>
<div class="pageTop"></div>
<div class="pageCond"></div>
<div class="pageGuide"></div>
<div class="pageContent flexRow">
    <div id="list" style="flex:1 1 60%" class="flexColumn"></div>
    <div style="flex:1 1 calc(40% - 3em)" class="flexColumn">
        <div id="mst"></div>
        <div class="flexColumn">
            <ul id="tabs">
                <li refid="boxlist">박스목록</li> 
                <li refid="det">상품목록</li>
            </ul> 
            <div id="boxlist" class="flexColumn"></div> 
            <div id="det" class="flexColumn"></div> 
        </div> 
    </div> 
</div>
<!-- HTML autogen end ---------------------------------------------- -->
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "fo_lg";
    var pgmid = "RTNaccept"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"pgmid":"RTNaccept","pgm_nm":"매장 반품 인수 등록(PC)","pgm_tp":"UX","proc_mst_id":"","proc_mst_nm":"","remark":"시즌반품/수시반품 : 매장에서 창고로 입고된 박스라벨을 스캔하여 인수 등록하거나 거부합니다.","ver":2.4,"pgm_stat":"Y","reg_usid":"jjr","reg_dt":"2022-04-01 10:39:13","upd_usid":"jjr","upd_dt":"2022-04-01 10:39:13","app_pgmid":"fo_lg","pgm_grp_nm":"반품","sort_seq":30,"shortcut":"","crud":"","app_pgm_nm":"물류"};
me.dataDef["_pgm_func"]=[{"func_icon":"fas fa-search","reg_dt":"2022-04-01 10:39:13","reg_usid":"","func_nm":"조회","upd_usid":"","upd_dt":"2022-04-01 10:39:13","func_tp":"DB_R","remark":null,"pgmid":"RTNaccept","sort_seq":1,"funcid":"search","content":"반품정보를 조회하여 반품등록을 진행함","crud":"R","id":"0"},{"func_icon":"fas fa-print","reg_dt":"2022-04-01 10:39:13","reg_usid":"","func_nm":"인수송장","upd_usid":"","upd_dt":"2022-04-01 10:39:13","func_tp":"EH","remark":null,"pgmid":"RTNaccept","sort_seq":2,"funcid":"print","content":"지시내역 발행","crud":"R","id":"1"},{"func_icon":"fas fa-save","reg_dt":"2022-04-01 10:39:13","reg_usid":"","func_nm":"인수등록","upd_usid":"","upd_dt":"2022-04-01 10:39:13","func_tp":"DB_W","remark":null,"pgmid":"RTNaccept","sort_seq":3,"funcid":"save","content":"반품예정정보 확인 후 박스별 인수등록","crud":"R","id":"2"},{"sort_seq":4,"funcid":"cancel","func_nm":"인수취소","func_icon":"fas fa-ban","func_tp":"DB_W","content":null,"remark":null,"crud":"C","id":"3"}];
me.dataDef["_pgm_data"] = {};
me.dataDef["_pgm_data"]["pageCond"]={"sort_seq":"1","data_id":"pageCond","data_nm":"조회조건","data_icon":null,"component_pgmid":"aweForm","component_option":null,"inout_tp":"IN","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_ord_no","colnm":"물류송장번호","dtype":"text","etype":"txt","attr":"center","defval":null,"w":"12","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":"받는창고","colid":"whcd","colnm":"창고코드","dtype":"text","etype":"sel","attr":"center","defval":"gUserinfo.deptcd","w":"12","h":null,"refcd":"whcd","option":"all:whcd::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":"보낸매장","colid":"shopcd","colnm":"매장코드","dtype":"text","etype":"sel","attr":"center","defval":null,"w":"12","h":null,"refcd":"whcd","option":"all:shopcd::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":"이동일","colid":"rtn_dt_from","colnm":"일자From","dtype":"ymd","etype":"txt","attr":"center ymd","defval":"date(\"today\")","w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":"이동일","colid":"rtn_dt_to","colnm":"일자To","dtype":"ymd","etype":"txt","attr":"center ymd","defval":"date(\"last\")","w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"cd_stat","colnm":"문서상태","dtype":"text","etype":"sel","attr":"center","defval":null,"w":"10","h":null,"refcd":"LG_ORD_STAT","option":"multi:cd_stat::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_end_yn","colnm":"완결","dtype":"text","etype":"sel","attr":"center","defval":null,"w":"10","h":null,"refcd":"DONE_YN","option":"all:ord_end_yn:cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"}]};
me.dataDef["_pgm_data"]["list"]={"sort_seq":"2","data_id":"list","data_nm":"반품예정 목록","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"chk"},"inout_tp":"OUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_ord_no","colnm":"물류송장번호","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_dt","colnm":"물류일자","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"7","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_tp","colnm":"물류유형","dtype":"text","etype":"sel","attr":"center readonly","defval":null,"w":"12","h":null,"refcd":"LG_TP","option":"sel:lg_tp::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":"보낸매장","colid":"from_whcd","colnm":"코드","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"7","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":"보낸매장","colid":"from_wh_nm","colnm":"명","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"7","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_dt","colnm":"등록일자","dtype":"ymd","etype":"raw","attr":"center","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_usid","colnm":"등록자","dtype":"text","etype":"sel","attr":"center readonly","defval":null,"w":"8","h":null,"refcd":"USID","option":"sel:ord_usid::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":"이동","colid":"box_cnt","colnm":"박스수","dtype":"num","etype":"raw","attr":"center","defval":null,"w":"5","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":"이동","colid":"goods_qty","colnm":"수량","dtype":"num","etype":"raw","attr":"center","defval":null,"w":"5","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":"입고","colid":"rcv_box_cnt","colnm":"박스수","dtype":"num","etype":"raw","attr":"center","defval":null,"w":"5","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":null,"section_icon":null,"colgrp":"입고","colid":"rcv_goods_qty","colnm":"수량","dtype":"num","etype":"raw","attr":"center hidden","defval":null,"w":"5","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"10"},{"sort_seq":12,"section":null,"section_icon":null,"colgrp":null,"colid":"cd_stat","colnm":"문서상태","dtype":"text","etype":"sel","attr":"center readonly","defval":null,"w":null,"h":null,"refcd":"LG_ORD_STAT","option":"sel:cd_stat::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"},{"sort_seq":13,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_end_yn","colnm":"완결","dtype":"text","etype":"sel","attr":"center readonly","defval":null,"w":null,"h":null,"refcd":"DONE_YN","option":"sel:ord_end_yn:cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"12"},{"sort_seq":14,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"16","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"13"}]};
me.dataDef["_pgm_data"]["mst"]={"sort_seq":"3","data_id":"mst","data_nm":"지시/예정내역","data_icon":null,"component_pgmid":"aweForm","component_option":null,"inout_tp":"INOUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_ord_no","colnm":"물류송장번호","dtype":"text","etype":"raw","attr":"center readonly keycol","defval":null,"w":"10","h":"2","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_tp","colnm":"물류 유형","dtype":"text","etype":"sel","attr":"center readonly","defval":"TBD","w":"10","h":"2","refcd":"LG_TP","option":"sel:lg_tp::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"lg_dt","colnm":"물류 일자","dtype":"ymd","etype":"raw","attr":"center","defval":null,"w":"10","h":"2","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"from_whcd","colnm":"보낸 매장","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"8","h":"2","refcd":"whcd","option":"sel:from_whcd::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"from_wh_nm","colnm":"명","dtype":"text","etype":"raw","attr":"hidden","defval":null,"w":null,"h":"2","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":"받는 창고","colid":"to_whcd","colnm":"코드","dtype":"text","etype":"raw","attr":"hidden","defval":null,"w":null,"h":"2","refcd":"whcd","option":"sel:to_whcd:to_wh_nm:cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":"받는 창고","colid":"to_wh_nm","colnm":"명","dtype":"text","etype":"raw","attr":"hidden","defval":null,"w":null,"h":"2","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"cd_stat","colnm":"문서 상태","dtype":"text","etype":"sel","attr":"center readonly","defval":"TBD","w":null,"h":"2","refcd":"LG_ORD_STAT","option":"sel:cd_stat::cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":null,"colid":"ord_end_yn","colnm":"완결","dtype":"text","etype":"sel","attr":"center readonly","defval":"TBD","w":null,"h":"2","refcd":"DONE_YN","option":"sel:ord_end_yn:cdnm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":"txt","attr":"center","defval":null,"w":"20","h":"2","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"}]};
me.dataDef["_pgm_data"]["boxlist"]={"sort_seq":"4","data_id":"boxlist","data_nm":"박스목록","data_icon":null,"component_pgmid":"agGrid","component_option":null,"inout_tp":"INOUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"denied","colnm":"인수거부","dtype":"text","etype":"btn","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"box_barcd","colnm":"박스바코드","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"box_no","colnm":"박스번호","dtype":"text","etype":"raw","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"qty","colnm":"입수량","dtype":"num","etype":"raw","attr":"center","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_yn","colnm":"인수여부","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"accept","colnm":"인수등록","dtype":"text","etype":"btn","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":"txt","attr":"center","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"}]};
me.dataDef["_pgm_data"]["det"]={"sort_seq":"5","data_id":"det","data_nm":"상품내역","data_icon":null,"component_pgmid":"agGrid","component_option":null,"inout_tp":"OUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"goods_seq","colnm":"순번","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"box_no","colnm":"박스번호","dtype":"text","etype":"raw","attr":"center hidden","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"box_barcd","colnm":"박스바코드","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"goods_cd","colnm":"상품코드","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"qty","colnm":"반품수량","dtype":"num","etype":"raw","attr":"center","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"cfm_qty","colnm":"확정수량","dtype":"num","etype":"raw","attr":"center hidden","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"18","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"}]};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */
    /* 사용자초기화 */
    me.fnInitExtra=function() {
        //탭 설정
        gfnTab(pageid, "tabs");
        
        //프로그램 이름
        me.dataSet[me.pgmid +"pgm_nm"] = subset(gds.menu, "pgmid", me.pgmid)[0].pgm_nm;
        
        //물류 송장 번호 포커스
        me.pageObj.pageCond.col.lg_ord_no.focus();
        
        //Notice 알림 혹은 내 작업 내역 클릭 시, gParam["pgmLog"]로 lg_ord_no를 받아 페이지 열림
        if(!isNull(gParam) && !isNull(gParam["pgmLog"])) {
            var lg_ord_no = gParam["pgmLog"];
            me.pageObj["pageCond"].setVal("lg_ord_no", lg_ord_no);
            setTimeout(function() { me.fnSearch() }, 100);
            setTimeout(function() { me.fnSearchOrd(lg_ord_no) }, 100);
            gParam["pgmLog"] = null;
        }
    }
    
    /* 이벤트핸들러 */
    me.fnEH=function(component, evt, row, col, val) { 
        //console.log(evt+","+row+","+col+","+val);
        //화면기능버튼이 눌리면 
        if (component == me.pageObj["_pageFunc"]){ 
            if(typeof(me[col])=='function') me[col](); //col=기능명 me["fnSearch"]()=me.fnSearch(); 
        }
        
        //검색 조건 입력 창에서 엔터키 발생 시 조회 이벤트 실행
        else if(component == me.pageObj["pageCond"]) {
            if(evt=="enter") {
                me.fnSearch();
            }
        }

        //list:반품예정 목록 이벤트처리     
        else if(component==me.pageObj["list"]) {
            if(evt=="focus") {
                if(row >= 0) {
                    var lg_ord_no = component.getVal(row,"lg_ord_no");
                    me.fnSearchMst(lg_ord_no);
                } 
            }
        }
        
        //boxlist: 박스 목록 이벤트 처리
        else if(component == me.pageObj["boxlist"]) {
            if(evt == "click" && col == "accept") {
                if(row < 0) return;
                
                const boxInfo = me.pageObj["boxlist"].getRowData(row);
                me.fnAcceptBox(boxInfo.box_barcd);
            
            } else if(evt == "click" && col == "denied") {
                if(row < 0) return;
                
                const boxInfo = me.pageObj["boxlist"].getRowData(row);
                if(boxInfo.rcv_yn == "Y") {
                    gfnConfirm(me.dataSet[me.pgmid +"pgm_nm"], "박스 바코드 [" + boxInfo.box_barcd + "]는 이미 인수 등록된 건입니다. 인수 등록을 취소하시겠습니까?", function(bConfirm) {
                        if(bConfirm) me.fnDeniedCancelBox(boxInfo.box_barcd);
                    })
                
                } else if(boxInfo.rcv_yn == "X") {
                    gfnConfirm(me.dataSet[me.pgmid +"pgm_nm"], "박스 바코드 [" + boxInfo.box_barcd + "]는 이미 인수 등록된 건입니다. 인수 거부를 취소하시겠습니까?", function(bConfirm) {
                        if(bConfirm) me.fnDeniedCancelBox(boxInfo.box_barcd);
                    })
                    
                } else {
                    if(!boxInfo.remark) {
                        gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], "박스 바코드 [" + boxInfo.box_barcd + "]의 인수 거부 사유를 비고란에 입력한 후, 입고 거부 처리하세요.");
                        
                    } else {
                        me.fnDeniedBox(boxInfo.box_barcd, boxInfo.remark);
                    }
                }

            } else if(evt == "dblclick" && col == "box_barcd") {
                if(row < 0) return;
                
                me.page.find("li[refid='det']").trigger("click");
            }
        }
    }

    //me.fnSearch: 조건 조회
    me.fnSearch = function() {
        if( !me.pageObj["pageCond"].chkValid() ) return;
        const args  = me.pageObj["pageCond"].exportData()[0];
        const invar = JSON.stringify(args);
        gfnTx(appid + "." + pgmid, "search", { INVAR : invar }, function(OUTVAR) {
            //필드 초기화
            me.fnNew();
            
            if(OUTVAR.rtnCd == "OK") {
                //DB에서 조회되지 않는 물류 송장 번호
                if(OUTVAR.lg_ord_no == "NULL") {
                    
                    //화면 물류 송장 번호가 입력된 경우,
                    if(!isNull(args.lg_ord_no)) {
                        gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", "물류 송장 번호 [" + args.lg_ord_no + "]는 유효하지 않는 번호입니다.");
                        return;
                    
                    //입력되지 않은 경우, 물류 송장 번호를 제외한 조건에 따라 조회
                    } else {
                        me.pageObj["list"].importData(OUTVAR.list);
                        
                    }
    
                //DB에서 조회되는 물류 송장 번호
                } else {
                    //조회된 송장 번호가 받는 창고와 일치하지 않는 경우,
                    const listChk = OUTVAR.list[0];
                    if(listChk.to_whcd != args.whcd) {
                        gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", "물류 송장 번호 [" + args.lg_ord_no + "]는 선택된 창고에서 처리할 수 없습니다.");
                        return;
                    
                    //일치하는 경우, 해당 건 출력
                    } else {
                        me.pageObj["list"].importData(OUTVAR.list);
                    }
                }
                me.pageObj["list"].total("top");
                
            } else {
                console.log(OUTVAR);
                gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
            }
        })
    }

    //me.fnSearchMst : 물류 송장 번호 기준 조회
    me.fnSearchMst = function(lg_ord_no) {
        if( !me.pageObj["pageCond"].chkValid() ) return;
        
        var args  = me.pageObj["pageCond"].exportData()[0];
        $.extend(args, { lg_ord_no : lg_ord_no });
        var invar =  JSON.stringify(args);
        gfnTx(appid + "." + pgmid, "searchMst", { INVAR : invar }, function(OUTVAR) {
            me.fnNew();
            
            if(OUTVAR.rtnCd == "OK") {
                me.pageObj["mst"].importData(OUTVAR.mst);
                me.pageObj["boxlist"].importData(OUTVAR.boxlist);
                me.pageObj["det"].importData(OUTVAR.det);
                
                const mst     = me.pageObj["mst"].exportData()[0];
                const boxlist = me.pageObj["boxlist"].exportData();
                
                //물류 송장 완료인 건,
                if(mst.ord_end_yn == "Y") {
                    boxlist.forEach((box) => {
                        me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=accept]").addClass("hidden");
                        me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=denied]").addClass("hidden");
                        
                        if(box.rcv_yn == "X") {
                            me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell").css("background-color", "red");
                        }
                    })
                    
                //물류 송장 완료가 아닌 건,
                } else {
                    //문서 상태 발송 완료가 아닌 건,
                    if(mst.cd_stat != "Y") {
                        boxlist.forEach((box) => {
                            me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=accept]").addClass("hidden");
                            me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=denied]").addClass("hidden");
                            
                            if(box.rcv_yn == "X") {
                                me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell").css("background-color", "red");
                            }
                        })
      
                    //문서 상태 발송 완료인 건,
                    } else {
                        boxlist.forEach((box) => {
                            //박스 인수된 건,
                            if(box.rcv_yn == "Y") {
                                me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=accept]").addClass("hidden");
                                me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=denied]").addClass("hidden");
                            
                            //박스 인수 거부된 건,
                            } else if(box.rcv_yn == "X") {
                                me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=accept]").addClass("hidden");
                                me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell[col-id=denied]").addClass("hidden");
                                me.page.find("#boxlist .ag-row[row-index= "+ box.id + "] .ag-cell").css("background-color", "red");
                            }
                        })
                    }
                }
                //로그 저장
                gfnLog(pgmid, args, lg_ord_no, "read");
                
            } else {
                gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
            }
        })
    }

    
    //필드 초기화
    me.fnNew = function() {
        me.pageObj["mst"].reset();
        me.pageObj["boxlist"].reset();
        me.pageObj["det"].reset();
    }

    //me.fnAcceptBox(barcd) : 박스 인수 등록
    me.fnAcceptBox = function(barcd) {
        if( !me.pageObj["mst"].chkValid() ) return;

        //0. 물류 송장 번호 조회
        const mstChk    = me.pageObj["mst"].exportData()[0];
        const lg_ord_no = mstChk.lg_ord_no;
        let mst         = null;
        
        //3. 매장 반품 인수 등록 처리
        function fnSaveBox(box_no) {
            //3-1. 매장 반품 인수 등록
            const args = me.pageObj["mst"].exportData()[0];
            $.extend(args, { box_no : box_no });
            const invar = JSON.stringify(args);
            gfnTx(appid + "." + pgmid, "acceptBox", { INVAR : invar }, function(OUTVAR) {
                if(OUTVAR.rtnCd == "OK") {
                    //3-2. 마스터 정보 재조회
                    me.fnSearchMst(lg_ord_no);
                    
                    //3-3. 완료 카운트 조회
                    const boxlist = me.pageObj["boxlist"].exportData();
                    let cnt = 0;
                    boxlist.forEach((row) => {
                        if(row.rcv_yn == "Y") {
                            cnt++;
                        }
                    })
                    
                    //3-4. 로그 저장
                    const sub = barcd;
                    gfnLog(pgmid, args, lg_ord_no, "save", sub);
                    
                    //3-5. 박스 스캔 완료 확인
                    if(cnt == boxlist.length) {
                        me.fnSave();
                    }

                } else {
                    gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
                }
            })
        }     
        
        //2. 박스 인수 상태 확인
        function fnChkBox() {
            const boxlist = me.pageObj["boxlist"].exportData();
            
            boxlist.forEach((row) => {
                if(row.box_barcd == barcd) {
                    if(row.rcv_yn == "Y") {
                        gfnStatus("박스 바코드 [" + barcd + "]는 이미 인수 등록되었습니다.");
                        return;
                        
                    } else if(row.rcv_yn == "X") {
                        gfnStatus("박스 바코드 [" + barcd + "]는 이미 인수 거부되었습니다.");
                        return;
                        
                    } else {
                        fnSaveBox(row.box_no);
                    }
                }
            })
        }
        
        //1. 인수 등록 여부 확인
        function fnChkComplete() {
            //1-1. 마스터 정보 재조회
            me.fnSearchMst(lg_ord_no);
            const mst = me.pageObj["mst"].exportData()[0];
            
            //1-2. 마스터 정보 상태에 따른 조건 수행
            if(mst.cd_stat != "Y") {
                if(mst.cd_stat == "N") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 삭제된 문서입니다.";
                    
                } else if(mst.cd_stat == "D") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 임시 대기 문서입니다.";
                    
                } else if(mst.cd_stat == "F") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 인수 완료되었습니다.";
                }
                
            } else {
                if(mst.ord_end_yn == "Y") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 반품 인수 등록되었습니다.";
                    
                } else {
                    fnChkBox();
                    return;
                } 
            }
            gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], msg);
        }
        fnChkComplete();
    }
    
    //me.fnDeniedBox(barcd, remark) : 박스 인수거부
    me.fnDeniedBox = function(barcd, remark) {
        if( !me.pageObj["mst"].chkValid() ) return;
        
        //0. 물류 송장 번호 조회
        const mstChk    = me.pageObj["mst"].exportData()[0];
        const lg_ord_no = mstChk.lg_ord_no;
        let msg         = null;
        
        //3. 박스 인수 거부 처리
        function fnSaveBox(box_no) {
            //3-1. 박스 인수 거부 등록
            const args = me.pageObj["mst"].exportData()[0];
            $.extend(args, { box_no : box_no, remark : remark });
            const invar = JSON.stringify(args);
            gfnTx(appid + "." + pgmid, "deniedBox", { INVAR : invar }, function(OUTVAR) {
                if(OUTVAR.rtnCd == "OK") {
                    //3-2. 마스터 정보 재조회
                    me.fnSearchMst(lg_ord_no);
                    
                    //3-3. 로그 저장
                    const sub = barcd;
                    gfnLog(pgmid, args, lg_ord_no, "denied", sub);

                } else {
                    gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
                }
            })
        }        
        
        //2. 박스 인수 상태 확인
        function fnChkBox() {
            const boxlist = me.pageObj["boxlist"].exportData();
            
            boxlist.forEach((row) => {
                if(row.box_barcd == barcd) {
                    if(row.rcv_yn == "X") {
                        gfnStatus("박스 바코드 [" + boxInfo.box_barcd + "]는 이미 인수 거부되었습니다.");
                        
                    } else {
                        fnSaveBox(row.box_no);
                    }
                }
            })
        }
        
        //1. 인수 거부 여부 확인
        function fnChkComplete() {
            //1-1. 마스터 정보 재조회
            me.fnSearchMst(lg_ord_no);
            const mst = me.pageObj["mst"].exportData()[0];
            
            //1-2. 마스터 정보 상태에 따른 조건 수행 
            if(mst.cd_stat != "Y") {
                if(mst.cd_stat == "N") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 삭제된 문서입니다.";
                    
                } else if(mst.cd_stat == "D") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 임시 대기 문서입니다.";
                    
                } else if(mst.cd_stat == "F") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 인수 완료되었습니다.";
                }
                
            } else {
                if(mst.ord_end_yn == "Y") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 반품 인수 등록되었습니다.";
                    
                } else {
                    fnChkBox();
                    return;
                } 
            }
            gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], msg);
        }
        fnChkComplete();
    }
    
    ////me.fnDeniedCancelBox(barcd, remark) : BOX 인수거부 취소
    // me.fnDeniedCancelBox = function(barcd, remark) {
    //     if( !me.pageObj["mst"].chkValid() ) return;
        
    //     //0. 물류 송장 번호 조회
    //     const mstChk    = me.pageObj["mst"].exportData()[0];
    //     const lg_ord_no = mstChk.lg_ord_no;
    //     let msg         = null;
        
    //     //3. 박스 인수 거부 취소 처리
    //     function fnSaveBox(box_no) {
    //         //3-1. 박스 인수 거부 취소 등록
    //         const args = me.pageObj["mst"].exportData()[0];
    //         $.extend(args, { box_no : box_no, remark : remark });
    //         const invar = JSON.stringify(args);
    //         gfnTx(appid + "." + pgmid, "deniedCancelBox", { INVAR : invar }, function(OUTVAR) {
    //             if(OUTVAR.rtnCd == "OK") {
    //                 //3-2. 마스터 정보 재조회
    //                 me.fnSearchMst(lg_ord_no);
                    
    //                 //3-3. 로그 저장
    //                 const sub = barcd;
    //                 gfnLog(pgmid, args, lg_ord_no, "deniedR", sub);

    //             } else {
    //                 gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
    //             }
    //         })
    //     }      
        
    //     //2. 박스 인수 상태 확인
    //     function fnChkBox() {
    //         const boxlist = me.pageObj["boxlist"].exportData();
            
    //         boxlist.forEach((row) => {
    //             if(row.box_barcd == barcd) {
    //                 if(row.rcv_yn == "Y") {
    //                     gfnStatus("박스 바코드 [" + boxInfo.box_barcd + "]는 이미 인수 거부 취소되었습니다.");
                    
    //                 } else if(row.rcv_yn == "N") {
    //                     gfnStatus("박스 바코드 [" + boxInfo.box_barcd + "]는 인수거부 되지 않았습니다.");    
                    
    //                 } else {
    //                     fnSaveBox(row.box_no);
    //                 }
    //             }
    //         })
    //     }
        
    //     //1. 인수 거부 여부 확인
    //     function fnChkComplete() {
    //         //1-1. 마스터 정보 재조회
    //         me.fnSearchMst(lg_ord_no);
    //         const mst = me.pageObj["mst"].exportData()[0];
            
    //         //1-2. 마스터 정보 상태에 따른 조건 수행 
    //         if(mst.cd_stat != "Y") {
    //             if(mst.cd_stat == "N") {
    //                 msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 삭제된 문서입니다.";
                    
    //             } else if(mst.cd_stat == "D") {
    //                 msg = "물류 송장 번호 [" + lg_ord_no + "]는 임시 대기 문서입니다.";
                    
    //             } else if(mst.cd_stat == "F") {
    //                 msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 인수 완료되었습니다.";
    //             }
                
    //         } else {
    //             if(mst.ord_end_yn == "Y") {
    //                 msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 반품 인수 등록되었습니다.";
                    
    //             } else {
    //                 fnChkBox();
    //                 return;
    //             } 
    //         }
    //         gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], msg);
    //     }
    //     fnChkComplete();
    // }
    
    //save: 인수 등록
    me.fnSave = function() {
        if( !me.pageObj.mst.chkValid() ) return;
        
        //0. 물류 송장 번호 조회
        const mstChk    = me.pageObj["mst"].exportData()[0];
        const lg_ord_no = mstChk.lg_ord_no;
        let msg         = null;
        
        //3. 인수 확인
        function fnSaveOrd() {
            //3-1. 마스터 정보 재조회
            me.fnSearchMst(lg_ord_no);
            
            //3-2. 인수 등록
            const args   = me.pageObj["mst"].exportData()[0];
            args.boxlist = me.pageObj["boxlist"].exportData();
            const invar  = JSON.stringify(args);
            gfnTx(appid + "." + pgmid, "save", { INVAR : invar }, function(OUTVAR) {
                if(OUTVAR.rtnCd == "OK") {
                    //3-3. 로그 저장
                    const sub = args.boxlist.length;
                    gfnLog(pgmid, args, lg_ord_no, "confirm", sub);
                    
                    gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], "물류 송장 번호 [" + lg_ord_no + "]가 반품 인수 등록되었습니다.");
                    me.fnSearch();
                    
                } else {
                    gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
                    return;
                }
            })
        }
        
        //2. 박스 인수 상태 확인
        function fnChkBox() {
            let cnt = 0;
            const boxlist = me.pageObj["boxlist"].exportData();
            
            boxlist.forEach((box) => {
                if(box.rcv_yn == "Y") {
                    cnt++;
                } else if(box.rcv_yn == "X") {
                    cnt++;
                }
            })
            
            if(cnt != boxlist.length) {
                msg = "물류 송장 번호 [" + lg_ord_no + "]에 반품 인수 등록 하지 않은 박스가 존재합니다. 인수 등록 하시겠습니까?";
                
            } else {
                msg = "물류 송장 번호 [" + lg_ord_no + "]를 반품 인수 등록 하시겠습니까?";
            }
            
            gfnConfirm(me.dataSet[me.pgmid +"pgm_nm"], msg, function(rtn) {
                if(rtn) fnSaveOrd();
            });
        }
        
        //1. 매장 반품 인수 등록 여부 확인
        function fnChkComplete() {
            //1-1. 마스터 정보 재조회
            me.fnSearchMst(lg_ord_no);
            const mst = me.pageObj["mst"].exportData()[0];

            //1-2. 마스터 정보 상태에 따른 조건 수행 
            if(mst.cd_stat != "Y") {
                if(mst.cd_stat == "N") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 삭제된 문서입니다.";
                    
                } else if(mst.cd_stat == "D") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 임시 대기 문서입니다.";
                    
                } else if(mst.cd_stat == "F") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 인수 완료되었습니다.";
                }
                
            } else {
                if(mst.ord_end_yn == "Y") {
                    msg = "물류 송장 번호 [" + lg_ord_no + "]는 이미 반품 인수 등록되었습니다.";
                    
                } else {
                    fnChkBox();
                    return;
                } 
            }
            gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], msg);
        }
        fnChkComplete();
    }
    
    //반품인수등록 취소
    me.fnCancel = function(){
        const mstChk    = me.pageObj["mst"].exportData()[0];
        const lg_ord_no = mstChk.lg_ord_no;

        function _fnCancel(){
            
            const args   = me.pageObj["mst"].exportData()[0];
            args.boxlist = me.pageObj["boxlist"].exportData();
            
            const invar  = JSON.stringify(args);
            gfnTx(appid + "." + pgmid, "cancel", { INVAR : invar }, function(OUTVAR) {
                if(OUTVAR.rtnCd == "OK") {
                    
                    gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], "물류 송장 번호 [" + lg_ord_no + "]가 반품 인수 등록 취소 되었습니다.");
                    me.fnSearch();
                    
                } else {
                    gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
                    return;
                }
            })
            
        }
        
        var ord_end_yn = me.pageObj.mst.getVal("ord_end_yn");
        if(ord_end_yn == "Y") gfnAlert("취소 실패","이미 완결된 문서는 취소할 수 없습니다.");
        else{
                gfnConfirm("취소 확인","물류 송장 번호 [" + lg_ord_no + "]에 해당하는 모든 박스가 인수등록 취소됩니다. 취소하시겠습니까?",function(rtn){
                    if(rtn) _fnCancel();
                });
            }
        
    }
    
    //print: 인수 송장 출력
    me.fnPrint = function() {
        //0-1. 새 페이지
        let newPage = undefined;
        
        //0-2. 출력 리스트 수집
        const list  = me.pageObj["list"].exportData("selected");
        
        //4. 송장 페이지 출력
        function fnPrint() {
            setTimeout(function() {
                newPage.focus();
                newPage.print();
            }, 100);
        }
        
        //3. 송장 페이지 생성
        function fnCreatePage(boxList, data) {
            let rowMax = 29;
            let cnt    = 0;
            let html   = "<html>";

            //사이즈 조절, css
            html += "<head><style type='text/css'> .boxLabel .tfhid{font-size:5px; border-left:hidden; border-right:hidden;} .boxLabel {border-collapse:collapse; border-spacing:0;text-align:center; vertical-align:middle; font-weight: bold;} .boxLabel .tag{ background-color: rgb(220, 220, 220); border-top: 3px black solid;}.boxLabel .data{font-size:20px; padding:5px 2px;} .boxLabel tr{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; }.boxLabel td{border-color:black; border-style:solid; border-width:1px; overflow:hidden; word-break:normal; } /*.boxLabel .goods{border-right: 3px black solid;}*/ .boxLabel th{ font-size:12px; border-color:black; border-style:solid; border-width:1px; font-weight:bold;overflow:hidden; word-break:normal;} .footer{padding: 0; text-align: center; vertical-align: middle; line-height: normal; margin: 0; position: fixed; bottom: 0px; width: 100%;} /*Web Print*/ .boxLabel{border: 2px black solid; width:100% height:100%} .page {width: 210mm; min-height: 297mm;} @media print { div.footer {position: fixed; bottom: 0;} .page { margin: 5px;border: initial; border-radius: initial; width: initial; min-height: initial; box-shadow: initial; background: initial; page-break-after: always; /*padding-top:38;*/}}</style></head>";
            html += "<body style='margin:5px'>";
            html += "<div class='page'>";
            html += "<table class='boxLabel' style='table-layout:fixed'>";
            html += "<thead>";
            
            html += "<h3 style='text-align:center;'>인 수 증</h3>";
            
            html += "<h5>주소(도착지): "+ data.to_addr + "&nbsp;&nbsp;&nbsp;&nbsp;담당자: " + data.to_adm_nm + " " + data.to_adm_tel + "</h5>"; //도착지, 담당자 이름, 연락처
            
            html += "<tr><th></th>";
            html += "<th rowspan='2' colspan='3'><div class='barcode_img'><object style='width:160px; height:40px;' type='image/bmp' data=" + data.barcode + "></object></div></th>";   //바코드
            html += "<th style='width:15mm'>물류유형</th>";
            html += "<th style='width:15mm'>일자</th>";
            html += "<th style='width:45mm' colspan='3'>보내는곳</th>";
            html += "<th style='width:45mm' colspan='3'>받는곳</th></tr>";
            
            html += "<tr><th rowspan='2' style='border-top:hidden; vertical-align:middle;'>물류"+"<br>"+"지시번호</th>";
            html += "<th style='border-bottom:hidden; font-size:15px;'>"+ data.lg_tp +"</th>";  //물류 타입(REA)
            html += "<th rowspan='2' style='font-size:10px'>"+ data.lg_dt +"</th>";             //보내는 날짜(0000-00-00)
            html += "<th rowspan='2' style='width:15mm'>"+ data.from_whcd +"</th>";             //보내는 곳 코드(LF001)
            html += "<th rowspan = '2' colspan = '2'>"+ data.from_wh_nm +"</th>";               //보내는 곳 이름(가산)
    
            html += "<th rowspan='2' style='width:15mm'>"+ data.to_whcd +"</th>";               //받는 곳 코드(LF001)
            html += "<th rowspan='2' colspan='2'>"+ data.to_wh_nm +"</th></tr>";                //받는 곳 이름(가산)
            
            html += "<tr><th colspan='3'>"+ data.lg_ord_no +"</th>";                            //물류 송장 번호
            html += "<th style='font-size:14px;'>"+ data.lg_tp_nm +"</th>";                     //물류 타입 이름(시즌반품)
            html += "</tr>";
           
            html += "<tr class='tag'><th colspan='2'>패킹구분</th>";
            html += "<th colspan='3'>브랜드</th>";
            html += "<th>패킹수</th>";
            html += "<th>입수량</th>";
            html += "<th colspan='5'>비고</th></tr>";
            
            html += "</thead>";
            html += "<tbody>";
            
            boxList.forEach((row) => {
                html += "<tr style='font-size:12px;'><td colspan='2'>" + row.pack_tp + "</td>"; //패킹 타입
                html += "<td colspan='3'>" + row.brand + "</td>";                               //브랜드
                html += "<td>" + row.box_cnt + "</td>";                                         //박스 개수
                html += "<td>" + row.goods_qty + "</td>";                                       //상품 개수
                html += "<td colspan='5'>"+"<br>"+"</td></tr>";
                cnt++;
            })
            
            for(let i = 0; i < rowMax - cnt; i++) {
                html += "<tr><td colspan='2'>"+"<br>"+"</td>";
                html += "<td colspan='3'>"+"<br>"+"</td>";
                html += "<td>"+"<br>"+"</td>";
                html += "<td>"+"<br>"+"</td>";
                html += "<td colspan='5'>"+"<br>"+"</td></tr>";
            }
            
            html += "<tr style='font-size:12px;'><td colspan='5'>"+"<br>"+"</td>";
            html += "<td style='background-color: rgb(220, 220, 220);'>" + data.box_cnt + "</td>";      //총 박스 수량
            html += "<td style='background-color: rgb(220, 220, 220);'>" + data.goods_qty + "</td>";    //총 상품 개수
            html += "<td colspan='5'>"+"<br>"+"</td></tr>";

            html += "</tbody>";
            
            html += "<tfoot>"; /*style='position: fixed';*/
            html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>상기 제품을 LF네트웍스가 지정하는 일자 장소까지 정히 송품하겠으며</td></tr>";
            html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>만약 송품도중 지연도착, 도난, 파손, 침수등 기타 물품에</td></tr>";
            html += "<tr><td class='tfhid' colspan='12' style='border-bottom:hidden;'>손실이 발생시는 (주)네트웍스에서 요구하는 모든 변상조치에 응할 것을 확약합니다.</td></tr>";
            
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='12'>"+"<br>"+"</td>";
            html += "</tr>";
            
            //이동송장 매장/창고 주소 및 담당자, 연락처, 보내는매장
            html += "<tr style='background-color: rgb(220, 220, 220); border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='12'>인계자: " + data.from_adm_nm + "&nbsp;&nbsp;P. " + data.from_adm_tel + "</td>";
            html += "</tr>";
                
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid'>인수자:</td>";
            html += "<td class='tfhid'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>차량회사:</td>";
            html += "<td class='tfhid' colspan='5'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>(성명)</td>";
            html += "<td class='tfhid' colspan='3'>"+"<br>"+"</td>";
            html += "</tr>";
            
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='2'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>차량번호:</td>";
            html += "<td class='tfhid' colspan='5'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>핸드폰:</td>";
            html += "<td class='tfhid' colspan='3'>"+"<br>"+"</td>";
            html += "</tr>";
            
            html += "<tr style='border-bottom:hidden;'>";
            html += "<td class='tfhid' colspan='2'>"+"<br>"+"</td>";
            html += "<td class='tfhid'>차량톤수:</td>";
            html += "<td class='tfhid' colspan='9'>"+"<br>"+"</td>";
            html += "</tr>";
            
            html += "<tr><td class='tfhid' colspan='12' style='font-size:15px;'>LF 네트웍스</td></tr>";
            
            html += "</tfoot>";
            
            html += "</table>";
            html += "</div>";
            html += "</body>";
            html += "</html>";
            
            newPage.document.write(html);
        }
        
        //2. 목록 데이터 수집 및 가공
        function fnChkStatus() {
            newPage = window.open('','_blank','directories=no,titlebar=no,toolbar=no, location=no, status=no, menubar=no, scrollbars=no,resizable=no, width=1024, height=1024');
            
            list.forEach((row) => {
                let boxList  = [];
                let fromData = [];
                let toData   = [];
                
                //2-1. 브랜드 박스 목록, 주소 및 담당자 연락처 조회
                const args  = { lg_ord_no : row.lg_ord_no, from_whcd : row.from_whcd, to_whcd : row.to_whcd };
                const invar = JSON.stringify(args);
                gfnTx(appid + "." + pgmid, "print", { INVAR : invar }, function(OUTVAR) {
                   if(OUTVAR.rtnCd == "OK") {
                        //A. 바코드 생성 function
                        function createBarcode(bcd) {
                            //A-1. 바코드 엘리먼트 생성
                            const body = document.querySelector(".framepage[id=" + me.pageid + "]");
                            let barcodeElement = document.createElement("div");
                            barcodeElement.classList.add("barcode");
                            barcodeElement.style.display = "none";
                            body.append(barcodeElement);
                            
                            const code   = bcd;
                            const format = "code128";
                            
                            $(".barcode").barcode(code, format, {
                                "barWidth"   : 1,
                    		    "barHeight"  : 30,
                    		    "moduleSize" : 5,
                    		    "bgColor"    : 'hsl(0 0% 100%)',
                    		    "color"      : 'hsl(0 0% 0%)',
                    		    "fontSize"   : 10,
                    		    "showHRI"    : true, // false시에 숫자 안보임
                    		    "output"     : 'bmp', // 그려주는 방식을 css, svg, bmp, canvas 중에서 선택
                            }).css("width", "150%");
                            
                            const barcodeData = $(".barcode object").attr("data");
                            
                            //A-2. 바코드 엘리먼트 제거
                            let element = document.querySelector(".framepage[id=" + me.pageid + "] .barcode");
                            element.parentNode.removeChild(element);
                            
                            return barcodeData;
                        }
                        
                        //B. 일자 변환 function
                        function dateSub(date){
                            return date.substring(0, 4) + "-" + date.substring(4, 6) + "-" + date.substring(6, 8);
                        }
                        
                        //2-2. 데이터 수집
                        boxList.push(OUTVAR.qryPrintInfo);
                        fromData.push(OUTVAR.qryPrintFromUser);
                        toData.push(OUTVAR.qryPrintToUser);
                        
                        const pFromUser = fromData[0];
                        const pToUser   = toData[0];

                        printData = {
                            lg_tp        : row.lg_tp,
                            lg_tp_nm     : gfnCdNm("LG_TP", row.lg_tp, "nm"),
                            lg_ord_no    : row.lg_ord_no,
                            lg_dt        : dateSub(row.lg_dt),
                            box_cnt      : row.box_cnt,
                            goods_qty    : row.goods_qty,
                            barcode      : createBarcode(row.lg_ord_no),
                            to_whcd      : row.to_whcd,
                            to_wh_nm     : subset(subset(gds.comcd, "comcd", "LFN"), "cd", row.to_whcd)[0].nm,
                            to_addr      : pToUser.addr,
                            to_adm_nm    : pToUser.adm_nm,
                            to_adm_tel   : pToUser.adm_tel,
                            from_whcd    : row.from_whcd,
                            from_wh_nm   : row.from_wh_nm,
                            from_addr    : pFromUser.addr,
                            from_adm_nm  : pFromUser.adm_nm,
                            from_adm_tel : pFromUser.adm_tel,
                        }
                        fnCreatePage(boxList[0], printData);
                    
                    } else {
                        gfnAlert(me.dataSet[me.pgmid +"pgm_nm"] + "오류", OUTVAR.rtnMsg);
                        return;
                    }
                });
            })
            fnPrint();
        }
        
        //1. 선택 목록 상태 확인
        function fnChkList() {
            let cnt    = 0;
            let msg    = null;
            
            if(list.length < 1) {
                gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], "반품 예정 목록에서 예정 내역이 선택되지 않았습니다.");
                return;
            
            } else {
                list.forEach((row) => {
                    if(row.ord_end_yn == "NULL") {
                        msg = "물류 송장 번호 [" + row.lg_ord_no + "]는 이미 반품 인수 등록되었습니다.";
                    
                    } else {
                        if(row.cd_stat == "N") {
                            msg = "물류 송장 번호 [" + row.lg_ord_no + "]는 이미 삭제된 문서입니다.";
                        
                        } else if(row.cd_stat == "D") {
                            msg = "물류 송장 번호 [" + row.lg_ord_no + "]는 임시 대기 문서입니다.";
                        
                        } else {
                            cnt++;
                        }
                    }
                })
                if(msg) {
                    gfnAlert(me.dataSet[me.pgmid +"pgm_nm"], msg);
                    return;
                }
            }
            if(cnt == list.length) {
                fnChkStatus();
            }
        }
        fnChkList();
    }


/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>