
<!-- HTML autogen start ---------------------------------------------- -->            
<div class="pageNav"></div>
<div class="pageTop"></div>
<div class="pageCond"></div>
<div class="pageGuide"></div>
<div class="pageContent flexRow">
    <div id="list" style="flex:1 1 30%" class="flexColumn"></div>
    <div style="flex:1 1 calc( 70% - 2em )" class="flexColumn" >
        <div id="tbl"></div>
        <div id="colist" class="flexColumn"></div>
    </div>
</div>
<!-- HTML autogen end ---------------------------------------------- -->
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "workbench";
    var pgmid = "manageTable"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"pgmid":"manageTable","pgm_nm":"테이블관리","pgm_tp":"UX","proc_mst_id":"","proc_mst_nm":"","remark":"","ver":1.2,"pgm_stat":"Y","reg_usid":"lkh","reg_dt":"2021-11-03 15:41:51","upd_usid":"lkh","upd_dt":"2021-11-03 15:41:51","app_pgmid":"workbench","pgm_grp_nm":"시스템개발","sort_seq":1,"shortcut":"","crud":"","app_pgm_nm":"개발워크벤치"};
me.dataDef["_pgm_func"]=[{"func_icon":"fas fa-search","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"조회","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_R","remark":null,"pgmid":"manageTable","sort_seq":"1","funcid":"search","content":"테이블목록 조회","crud":"R","id":"0"},{"func_icon":"fas fa-file","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"신규","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"EH","remark":null,"pgmid":"manageTable","sort_seq":"2","funcid":"new","content":"신규 테이블 생성(화면초기화)","crud":"R","id":"1"},{"func_icon":"fas fa-save","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"저장","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_W","remark":"컬럼ID/명, 컬럼데이터타입은 용어사전에 정의된 정보를 사용하여 생성합니다.","pgmid":"manageTable","sort_seq":"3","funcid":"save","content":"테이블/컬럼정보 저장","crud":"R","id":"2"},{"func_icon":"fa fa-trash-alt","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"삭제","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_W","remark":null,"pgmid":"manageTable","sort_seq":"4","funcid":"del","content":"테이블/컬럼정보 삭제","crud":"R","id":"3"},{"func_icon":"fas fa-sign-out-alt","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"테이블Alter","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_W","remark":null,"pgmid":"manageTable","sort_seq":"5","funcid":"alter","content":"테이블재생성","crud":"R","id":"4"},{"func_icon":"fas fa-sign-out-alt","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"인덱스생성","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_W","remark":null,"pgmid":"manageTable","sort_seq":"6","funcid":"index","content":"인덱스를 생성함","crud":"R","id":"5"},{"func_icon":"extra fa fa-trash-alt","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"테이블Drop","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_W","remark":null,"pgmid":"manageTable","sort_seq":"7","funcid":"drop","content":"테이블 Drop","crud":"R","id":"6"},{"func_icon":"extra fas fa-exclamation-triangle","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"운영테이블생성","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_W","remark":null,"pgmid":"manageTable","sort_seq":"8","funcid":"deploy","content":"운영서버(LFFODB)반영","crud":"R","id":"7"},{"func_icon":"extra fas fa-sign-out-alt","reg_dt":"2021-11-03 15:41:51","reg_usid":"","func_nm":"운영인덱스생성","upd_usid":"","upd_dt":"2021-11-03 15:41:51","func_tp":"DB_W","remark":null,"pgmid":"manageTable","sort_seq":"9","funcid":"indexProd","content":"인덱스를 생성함","crud":"R","id":"8"}];
me.dataDef["_pgm_data"] = {};
me.dataDef["_pgm_data"]["list"]={"sort_seq":"1","data_id":"list","data_nm":"테이블목록","data_icon":null,"component_pgmid":"agGrid","component_option":{"height":"56.7em","remark":"더블클릭하면 테이블 정보를 조회할 수 있습니다."},"inout_tp":"OUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"sort_seq","colnm":"No.","dtype":"num","etype":"raw","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"5","h":null},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"t_id","colnm":"테이블ID","dtype":"text","etype":"raw","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"8","h":null},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"tbl_nm","colnm":"테이블명","dtype":"text","etype":"raw","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"10","h":null},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":"raw","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"15","h":null}]};
me.dataDef["_pgm_data"]["tbl"]={"sort_seq":"2","data_id":"tbl","data_nm":"테이블정보","data_icon":null,"component_pgmid":"aweForm","component_option":null,"inout_tp":"INOUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"sort_seq","colnm":"정렬순서","dtype":"num","etype":"txt","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"3","h":null},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"t_id","colnm":"테이블ID","dtype":"text","etype":"txt","attr":"pk","len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"10","h":null},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"tbl_nm","colnm":"테이블명","dtype":"text","etype":"txt","attr":"keycol","len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"25","h":null},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"비고","dtype":"text","etype":"tarea","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"50","h":"5"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"val_1","colnm":"정보영역","dtype":"text","etype":"txt","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"10","h":null},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"val_2","colnm":"특이사항","dtype":"text","etype":"txt","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"15","h":null},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"val_3","colnm":"제약사항","dtype":"text","etype":"txt","attr":null,"len":null,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"15","h":null},{"sort_seq":8,"section":"개발","section_icon":"fas fa-exclamation-triangle","colgrp":null,"colid":"dev_col_cnt","colnm":"컬럼수","dtype":"num","etype":"raw","attr":null,"defval":null,"w":8,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C"},{"sort_seq":9,"section":"개발","section_icon":"fas fa-exclamation-triangle","colgrp":null,"colid":"dev_row_cnt","colnm":"Row수","dtype":"num","etype":"raw","attr":null,"defval":null,"w":8,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C"},{"sort_seq":10,"section":"운영","section_icon":"fas fa-exclamation-triangle","colgrp":null,"colid":"prod_col_cnt","colnm":"컬럼수","dtype":"num","etype":"raw","attr":null,"defval":null,"w":8,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C"},{"sort_seq":11,"section":"운영","section_icon":"fas fa-exclamation-triangle","colgrp":null,"colid":"prod_row_cnt","colnm":"Row수","dtype":"num","etype":"raw","attr":null,"defval":null,"w":8,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C"}]};
me.dataDef["_pgm_data"]["colist"]={"sort_seq":"3","data_id":"colist","data_nm":"컬럼목록","data_icon":null,"component_pgmid":"agGrid","component_option":{"height":"39em","func":[{"funcid":"colNm","func_nm":"컬럼정보","func_icon":"fas fa-search"},{"funcid":"addRow","func_nm":"줄추가","func_icon":"fas fa-plus"},{"funcid":"delRow","func_nm":"줄삭제","func_icon":"fas fa-minus"}]},"inout_tp":"INOUT","content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"sort_seq","colnm":"No.","dtype":"num","etype":"txt","attr":"fixL","len":"5","defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"5","h":null},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"col_id","colnm":"컬럼ID","dtype":"text","etype":"txt","attr":"pk fixL","len":30,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"8","h":null},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"col_nm","colnm":"컬럼명","dtype":"text","etype":"txt","attr":"fixL","len":30,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"10","h":null},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":"입력","colid":"remark","colnm":"비고","dtype":"text","etype":"tarea","attr":null,"len":100,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"10","h":null},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"datatype","colnm":"데이터타입","dtype":"text","etype":"txt","attr":null,"len":20,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"7","h":null},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"not_null","colnm":"NotNull","dtype":"text","etype":"cbx","attr":null,"len":"2","defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"3","h":null},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"def_val","colnm":"기본값","dtype":"text","etype":"txt","attr":null,"len":50,"defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"5","h":null},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"pk_seq","colnm":"PK","dtype":"num","etype":"txt","attr":null,"len":"2","defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"3","h":null},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":null,"colid":"ix_01","colnm":"IDX#1","dtype":"num","etype":"txt","attr":null,"len":"2","defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"3","h":null},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":null,"colid":"ix_02","colnm":"IDX#2","dtype":"num","etype":"txt","attr":null,"len":"2","defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"3","h":null},{"sort_seq":11,"section":null,"section_icon":null,"colgrp":null,"colid":"ix_03","colnm":"IDX#3","dtype":"num","etype":"txt","attr":null,"len":"2","defval":null,"refcd":null,"option":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"3","h":null},{"sort_seq":12,"section":null,"section_icon":null,"colgrp":"입력","colid":"val_1","colnm":"C1","dtype":"text","etype":"txt","attr":"auto","len":"10","defval":null,"refcd":"DICT","option":"sel:val_1::nm","valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"7","h":null},{"sort_seq":13,"section":null,"section_icon":null,"colgrp":"입력","colid":"val_2","colnm":"C2","dtype":"text","etype":"txt","attr":"auto","len":"10","defval":null,"refcd":"DICT","option":"sel:val_2::nm","valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"7","h":null},{"sort_seq":14,"section":null,"section_icon":null,"colgrp":"입력","colid":"val_3","colnm":"C3","dtype":"text","etype":"txt","attr":"auto","len":"10","defval":null,"refcd":"DICT","option":"sel:val_3::nm","valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"7","h":null},{"sort_seq":15,"section":null,"section_icon":null,"colgrp":"입력","colid":"val_4","colnm":"C4","dtype":"text","etype":"txt","attr":"auto","len":"10","defval":null,"refcd":"DICT","option":"sel:val_4::nm","valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"7","h":null},{"sort_seq":16,"section":null,"section_icon":null,"colgrp":"입력","colid":"val_5","colnm":"C5","dtype":"text","etype":"txt","attr":null,"len":"10","defval":null,"refcd":"DICT","option":"sel:val_5::nm","valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","w":"7","h":null}]};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */

            /* 사용자초기화 */
    me.fnInitExtra=function() {
        //조회조건 없으므로 화면오픈시 조회
        me.fnSearch();
    }
    /* 이벤트핸들러 */
    me.fnEH=function(component, evt, row, col, val) { 
        //console.log(evt+","+row+","+col+","+val);
        //화면기능버튼이 눌리면 
        if (component==me.pageObj["_pageFunc"]){ 
            if(typeof(me[col])=='function') me[col](); //col=기능명 me["fnSearch"]()=me.fnSearch(); 
        }
        //테이블목록
        else if(component==me.pageObj["list"]) {
            if(evt=="dblclick") {
                if(row < 0) return;
                me.fnSearchTbl( component.getVal(row,"t_id") );
            }
        }
        //컬럼컨트롤
        else if(component==me.pageObj["colist"]) {
            if(evt=="componentFunc") {
                if(row=="colNm") {
                    me.fnColNm();
                } else if (row=="addRow"||row=="delRow") {
                    component[row](); //addRow/delRow
                }
            } 
            else if(evt=="change") { 
                if(row < 0) return; 
                if(col=="val_1"||col=="val_2"||col=="val_3"||col=="val_4"||col=="val_5") {
                    me.fnColNm(row);
                }
            }
        }
    }
    //colNm:컬럼정보세팅
    me.fnColNm=function(row) {
        var component = me.pageObj["colist"];
        function fnColInfo(row) { 
            //val_1~val_5가 입력될때 컬럼ID와 컬럼명, 데이터타입을 추가한다.
            var datatype = component.getVal(row,"datatype");
            var val_1 = component.getVal(row,"val_1"); var nm_1 = gfnCdNm("DICT",val_1,"nm"); datatype = nvl(gfnCdNm("DICT",val_1,"val_1"),datatype);
            var val_2 = component.getVal(row,"val_2"); var nm_2 = gfnCdNm("DICT",val_2,"nm"); datatype = nvl(gfnCdNm("DICT",val_2,"val_1"),datatype);
            var val_3 = component.getVal(row,"val_3"); var nm_3 = gfnCdNm("DICT",val_3,"nm"); datatype = nvl(gfnCdNm("DICT",val_3,"val_1"),datatype);
            var val_4 = component.getVal(row,"val_4"); var nm_4 = gfnCdNm("DICT",val_4,"nm"); datatype = nvl(gfnCdNm("DICT",val_4,"val_1"),datatype);
            var val_5 = component.getVal(row,"val_5"); var nm_5 = gfnCdNm("DICT",val_5,"nm"); datatype = nvl(gfnCdNm("DICT",val_5,"val_1"),datatype);
            var col_id = val_1 + (isNull(val_2)?"":"_"+val_2)+ (isNull(val_3)?"":"_"+val_3)+ (isNull(val_4)?"":"_"+val_4)+ (isNull(val_5)?"":"_"+val_5);
            var col_nm = nm_1+nm_2+nm_3+nm_4+nm_5;
            component.setVal(row,"col_id",col_id);
            component.setVal(row,"col_nm",col_nm);
            component.setVal(row,"datatype",datatype); 
        }
        if(row == undefined) {
            for(var i=0; i < component.countRow(); i++ ) {
                var nodeid = component.getNodeId(i);
                fnColInfo(nodeid);
            }
        } else {
            fnColInfo(row);
        }
    }
    //search:조회 
    me.fnSearch=function(rowFocusAfterSearch) { 
        var args = {pgmid:pgmid} 
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"search",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                me.pageObj["list"].importData(OUTVAR.list);
                if(rowFocusAfterSearch != undefined) {
                    me.pageObj["list"].focusRow(rowFocusAfterSearch);
                }  
            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
        });
    }
    //searchTbl: 테이블정보조회
    me.fnSearchTbl=function(t_id) { 
        var args = {t_id:t_id} 
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"searchTbl",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                me.pageObj["tbl"].reset();
                me.pageObj["tbl"].importData(OUTVAR.tbl);
                me.pageObj["tbl"].setVal("dev_col_cnt",OUTVAR.dev_col_cnt);
                me.pageObj["tbl"].setVal("dev_row_cnt",OUTVAR.dev_row_cnt);
                me.pageObj["tbl"].setVal("prod_col_cnt",OUTVAR.prod_col_cnt);
                me.pageObj["tbl"].setVal("prod_row_cnt",OUTVAR.prod_row_cnt);
                me.pageObj["colist"].reset();
                me.pageObj["colist"].importData(OUTVAR.colist);
                var curRow = me.pageObj["list"].focusedRow();
                me.fnSearch(curRow);
            } else {
                gfnAlert("조회오류",OUTVAR.rtnMsg);
            }
        });
    } 
    //save:저장 
    me.fnSave=function() {
        if( !me.pageObj["tbl"].chkValid() ) return;
        if( !me.pageObj["colist"].chkValid() ) return;
        var tbl = me.pageObj["tbl"].exportData()[0];
        var colist = me.pageObj["colist"].exportData();
        var args = { tbl : tbl, colist: colist } ;
        //console.log(args);
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"save",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                gfnAlert("저장성공","테이블 정보를 저장하였습니다.");
                me.fnSearchTbl(tbl.t_id);
            } else {
                gfnAlert("저장오류",OUTVAR.rtnMsg);
            }
        });
    }
    //new: 신규테이블
    me.fnNew=function() {
        me.pageObj["tbl"].reset();
        me.pageObj["colist"].reset();
    }
    //alter 테이블생성
    me.fnAlter=function() {
        function fnAskZAK() {
            gfnConfirm("테이블생성/Alter확인",`백업테이블을 생성하시겠습니까?`,function(bConfirm){
                bZAK = bConfirm?"Y":"N";
                fnAskCopy();
            });
        }
        function fnAskCopy() {
            gfnConfirm("테이블생성/Alter확인",`기존 테이블의 데이터 중 컬럼명이 같은 정보는 복사하시겠습니까?`,function(bConfirm){
                bCopy = bConfirm?"Y":"N";
                fnAlterTbl(t_id, tbl_nm);
            });
        }
        function fnAlterTbl(t_id, tbl_nm) {
            var args = { t_id : t_id, tbl_nm: tbl_nm, colist: me.pageObj["colist"].exportData(), bZAK: bZAK, bCopy: bCopy } ;
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"alter",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("테이블 생성성공","테이블이 생성/Alter 되었습니다. (백업테이블:"+OUTVAR.rtnMsg+")");
                    me.fnSearchTbl(t_id);
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
        } 
        var t_id = me.pageObj["tbl"].getVal("t_id");
        var tbl_nm = me.pageObj["tbl"].getVal("tbl_nm");
        var bZAK = "Y";
        var bCopy = "Y";
        gfnConfirm("테이블생성/Alter확인",`테이블 [${t_id}]${tbl_nm}을 생성하시겠습니까?`,function(bConfirm){
            if(bConfirm) fnAskZAK();
        });
    }
    //delete: 테이블정보삭제 
    me.fnDel=function() {
        function fnDeleteTbl(t_id) {
            var args = { t_id : t_id } ;
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"delete",{INVAR:invar},function(OUTVAR){ 
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("테이블 정보삭제 성공","테이블 정보가 삭제되었습니다.");
                    me.fnSearch();
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
        } 
        var t_id = me.pageObj["tbl"].getVal("t_id");
        var tbl_nm = me.pageObj["tbl"].getVal("tbl_nm");
        gfnConfirm("테이블 정보삭제 확인",`테이블 [${t_id}]${tbl_nm} 정보를 삭제하시겠습니까? (실제 테이블은 삭제되지 않습니다.)`,function(bConfirm){
            if(bConfirm) fnDeleteTbl(t_id);
        });
    }
    //drop: 테이블Drop
    me.fnDrop=function() {
        function fnDropTbl(t_id) {
            var args = { t_id : t_id } ;
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"drop",{INVAR:invar},function(OUTVAR){ 
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("테이블Drop성공","테이블이 Drop되었습니다. (백업테이블:"+OUTVAR.rtnMsg+")");
                    me.fnSearch();
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
        } 
        var t_id = me.pageObj["tbl"].getVal("t_id");
        var tbl_nm = me.pageObj["tbl"].getVal("tbl_nm");
        gfnConfirm("테이블Drop확인",`테이블 [${t_id}]${tbl_nm}을 Drop하시겠습니까? (Drop된 테이블은 복구할 수 없습니다.)`,function(bConfirm){
            if(bConfirm) fnDropTbl(t_id);
        });
    }
    
    //INDEX 생성
    me.fnIndex=function() {
        me._fnIndex("LFN");
    }
    me.fnIndexProd=function() {
        me._fnIndex("LFFODB");
    }
    me._fnIndex=function(conn) { 
        var data = me.pageObj["colist"].exportData();
        var cnt1 = subset(data,"ix_01","1").length;
        var cnt2 = subset(data,"ix_02","1").length;
        var cnt3 = subset(data,"ix_03","1").length;
        function fnMakeIndex(conn) {
            var ix_01 = "";  var ix_02 = "";  var ix_03 = "";
            for(var i=0; i < data.length; i++) {
                if(!isNull(data[i]["ix_01"])) ix_01 += (ix_01==""?"":",")+data[i]["col_id"]; 
                if(!isNull(data[i]["ix_02"])) ix_02 += (ix_02==""?"":",")+data[i]["col_id"]; 
                if(!isNull(data[i]["ix_03"])) ix_03 += (ix_03==""?"":",")+data[i]["col_id"]; 
            }
            var args = {conn:conn,t_id:me.pageObj["tbl"].getVal("t_id"),ix_01:ix_01,ix_02:ix_02,ix_03:ix_03};
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"index",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("인덱스 생성성공","인덱스가 생성/Alter 되었습니다.");
                    me.fnSearch();
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
        }
        if(cnt1+cnt2+cnt3 == 0) {
            gfnConfirm("인덱스생성확인","인덱스 컬럼이 지정되지 않았습니다. 삭제하시겠습니까?", function(bAnswer){
                if(bAnswer) fnMakeIndex(conn);
            }); 
        } else {
            fnMakeIndex(conn);
        }
    }

    //deplay 운영반영
    me.fnDeploy=function() {
        function fnAskZAK() {
            gfnConfirm("테이블생성/Alter확인",`백업테이블을 생성하시겠습니까?`,function(bConfirm){
                bZAK = bConfirm?"Y":"N";
                fnAskCopy();
            });
        }
        function fnAskCopy() {
            gfnConfirm("테이블생성/Alter확인",`기존 테이블에서 컬럼명이 같은 데이터 복사(YES) OR 개발테이블 데이터 복사(NO)하시겠습니까?`,function(bConfirm){
                bCopy = bConfirm?"PROD":"DEV";
                fnAlterTbl(t_id, tbl_nm);
            });
        }
        function fnAlterTbl(t_id, tbl_nm) {
            var tbl = me.pageObj["tbl"].exportData()[0];
            var colist = me.pageObj["colist"].exportData();
            var args = { t_id : t_id, tbl_nm: tbl_nm, tbl:tbl, colist:colist, bZAK: bZAK, bCopy: bCopy } ;
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"deploy",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("테이블 생성성공","테이블이 생성/Alter 되었습니다. (백업테이블:"+OUTVAR.rtnMsg+")");
                    me.fnSearchTbl(t_id);
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });
        } 
        var t_id = me.pageObj["tbl"].getVal("t_id");
        var tbl_nm = me.pageObj["tbl"].getVal("tbl_nm");
        var bZAK = "Y";
        var bCopy = "Y";
        if( !me.pageObj.tbl.chkValid() ) return;
        if( !me.pageObj.colist.chkValid() ) return;
        gfnConfirm("테이블생성/Alter확인",`테이블 [${t_id}]${tbl_nm}을 생성하시겠습니까?`,function(bConfirm){
            if(bConfirm) fnAskZAK();
        });
    }

/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>