<style>[pgmid='MRStatus_TimeRoom'] #today .fa-arrow-left {
    position: absolute;
    top: -1.2em;
    left: 0.5em;
    color: white;
    font-size: 2em;
    cursor: pointer;
} 

#bg {
	background-color: darkgrey;
	width: 100%;
	text-align: center;
}
#bg > img {
	margin: 1em;
	width: calc(100% - 2em);
	height: 300px;
	box-shadow: 0.5em 0.5em 0.5em #3e3e3e; 
}
#bg > img.fadeout { 
	transition: all 2s;
	opacity: 0;
	filter: grayscale(0.1) blur(10px);
}
#bg > img.fadein {
	/*animation: fadeout 2s ease-in;*/ 
	transition: all 2s;
	opacity: 1;
	filter: unset;
} 

#info {
	position: absolute;
	width: 80%;
	height: 250px;
	overflow: hidden;
	top: 30px;
	right: 0;
	background-color: rgb(255 255 255 / 75%);
	border-top-left-radius: 2em;
	border-bottom-left-radius: 2em;
	padding: 2em 3em;
	box-shadow: 1em 1em 1em rgb(30 30 30 / 50%);
	line-height: 1.5;
}
#info > div {
    font-size: 1.25em;
    line-height: 1.5;
}

:root { 
	--ti-cursor-color: #03a9f4;
	--ti-cursor-font-weight: 400; 
} 

.btnXls {
    display: none !important;
}

[data-scroll] {
    opacity: 0;
    will-change: transform, scale, opacity;
    transform: translateY(6rem) scale(0.93);
    transition: all 1.5s cubic-bezier(0.165, 0.84, 0.44, 1);
    margin: 3em 1em;
    padding: 1em;
    border-radius: 0.5em;
    background-color: rgba(255,255,255,0.1);
}
	
[data-scroll='in'] {	
    opacity:1;
    transform: translateY(0) scale(1);
}

[data-scroll='out'] {	
    opacity:0;
}

.framepage {
    background-color: unset !important;
}

#today .componentTitle span {
    color: white;
}
#today .componentBody {
    position: relative;
    max-width:100%;
    max-height:100vh;
    overflow:auto;
}

#today h5.quickGuide {
    font-size: 2em;
    margin-right: 1em;
    color: gold;
    text-shadow: 2px 2px 2px #3a3a3a;
}

#today .far {
    font-size: 2em;
    margin-right: 0.5em;
    color: gold;
    text-shadow: 2px 2px 2px #3a3a3a;
}
#today .far:hover {
    color : hsl(0,90%,35%,0.5);
}

#today .tLeft {
    position: sticky;
    top: 0;
    left: 0; 
    z-index: 10; 
    max-width: 4em !important;
    background: linear-gradient(358deg,#205e32,#25353d,#9b4c22,#882440,#a62d21,#a01b20,#bd3d20,#9f6522,#a77d23);
    color: white;
    text-shadow: 0 0 5px #0a0a0a;
}

#today .tLeft > div.tHead {
    height: 60px;
    text-align: center;
    position: sticky;
    top: 0;
    left: 0;
    z-index: 20;
    background-color: white;
}

#today .tLeft > div {
    height: 60px;
    border-bottom: 1px solid #6a6a6a;
    text-align: center;
    font-size: 1.5em;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: center;
    justify-content: center;
    align-items: center;
} 



#today .tBody {
    position: absolute;
    top:0;
    left:0; 
    min-width: 100%;
}	

#today .tBody .tHead {
    position: sticky;
    top:0;
    height: 60px;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: center;
    justify-content: flex-start;
    align-items: center;
    background-color: var(--navBG);
    color: var(--navColor);
    font: var(--fontBold);
    text-align: center; 
} 

#today .tBody .timeHead {
    min-width: 4em !important;
    max-width: 4em !important;
    text-align: center;
} 

#today .tBody .tHead > div {
    width: 13em;
    flex: 1 1 auto;
    border-right: 1px solid gold;
} 
	
#today .tBody .tRow { 
    height: 60px;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: flex-start;
    justify-content: flex-start;
    align-items: center;
    border-bottom: 1px dashed #AEAEAE; 
}	

#today .tRow.curr {
    background-color: #ffffea30;
    border: 2px solid var(--pointColor);
}

#today .tRow .tCol {
    width: 13em;
    overflow-y: auto;
    height: 100%;
    flex: 1 1 auto;
    border-right: 1px solid gold;
    display: flex;
    flex-direction: column;
    flex-wrap: wrap;
    align-content: center;
    justify-content: center;
    align-items: center;
    row-gap: 2px; 
    column-gap: 2px;
} 

#today .tRow .tCol.past {
    background-color: #aeaeae;
} 

#today .tCell {
    background-color: #ffffff50;
    padding: 6px;
    border-radius: 3px;
    box-shadow: 0px 0px 2px #aeaeae;
    overflow-x: hidden;
}

#today .tCell:hover {
    border: 1px solid gold;
    cursor: pointer;
} 


#today .tCell .resv_nm {
    white-space: nowrap;
    max-width: calc(13em - 18px);
    text-overflow: ellipsis; 
}


#today .resv_stat {
    font-size: 0.75em;
    color: var(--navBG);
}

#today .usnm {
    font-size: 0.6em;
    color: var(--fontSubColor);
}#today .curr .usnm {
    margin-left:0.5em;
    font-weight: normal;
    color: blue;
}

#today .resv_stat .Y {
    color: var(--navHover);
}

#today .resv_stat .N {
    color: var(--pointColor);
}

.tCell.rn1 { background-color: hsl(0deg 40% 90% / 90%) !important; }
.tCell.rn2 { background-color: hsl(30deg 40% 90% / 90%) !important; }
.tCell.rn3 { background-color: hsl(60deg 40% 90% / 90%) !important; }
.tCell.rn4 { background-color: hsl(90deg 40% 90% / 90%) !important; }
.tCell.rn5 { background-color: hsl(120deg 40% 90% / 90%) !important; }
.tCell.rn6 { background-color: hsl(200deg 40% 90% / 90%) !important; }
.tCell.rn7 { background-color: hsl(180deg 40% 90% / 90%) !important; }
.tCell.rn8 { background-color: hsl(210deg 40% 90% / 90%) !important; }
.tCell.rn9 { background-color: hsl(240deg 40% 90% / 90%) !important; }
.tCell.rn10 { background-color: hsl(270deg 40% 90% / 90%) !important; }
.tCell.rn11 { background-color: hsl(300deg 40% 90% / 90%) !important; }
.tCell.rn12 { background-color: hsl(330deg 40% 90% / 90%) !important; }
.tCell.rn13 { background-color: hsl(10deg 40% 90% / 90%) !important; }
.tCell.rn14 { background-color: hsl(40deg 40% 90% / 90%) !important; }
.tCell.rn15 { background-color: hsl(70deg 40% 90% / 90%) !important; }
.tCell.rn16 { background-color: hsl(100deg 40% 90% / 90%) !important; }
.tCell.rn17 { background-color: hsl(130deg 40% 90% / 90%) !important; }
.tCell.rn18 { background-color: hsl(160deg 40% 90% / 90%) !important; }
.tCell.rn19 { background-color: hsl(190deg 40% 90% / 90%) !important; }
.tCell.rn20 { background-color: hsl(220deg 40% 90% / 90%) !important; }
.tCell.rn21 { background-color: hsl(250deg 40% 90% / 90%) !important; }
.tCell.rn22 { background-color: hsl(280deg 40% 90% / 90%) !important; }
.tCell.rn23 { background-color: hsl(310deg 40% 90% / 90%) !important; }
.tCell.rn24 { background-color: hsl(340deg 40% 90% / 90%) !important; }
.tCell.rn25 { background-color: hsl(20deg 40% 90% / 90%) !important; }
.tCell.rn26 { background-color: hsl(50deg 40% 90% / 90%) !important; }
.tCell.rn27 { background-color: hsl(80deg 40% 90% / 90%) !important; }
.tCell.rn28 { background-color: hsl(110deg 40% 90% / 90%) !important; }
.tCell.rn29 { background-color: hsl(140deg 40% 90% / 90%) !important; }
.tCell.rn30 { background-color: hsl(170deg 40% 90% / 90%) !important; }
.tCell.rn31 { background-color: hsl(200deg 40% 90% / 90%) !important; }
.tCell.rn32 { background-color: hsl(230deg 40% 90% / 90%) !important; }
.tCell.rn33 { background-color: hsl(260deg 40% 90% / 90%) !important; }
.tCell.rn34 { background-color: hsl(290deg 40% 90% / 90%) !important; }
.tCell.rn35 { background-color: hsl(320deg 40% 90% / 90%) !important; }
.tCell.rn36 { background-color: hsl(350deg 40% 90% / 90%) !important; }
</style>

<!-- HTML autogen start ---------------------------------------------- -->            
<hr></hr> 
<div id="today" style="min-height:30em;" data-scroll></div>
<!-- HTML autogen end ---------------------------------------------- -->
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "m";
    var pgmid = "MRStatus_TimeRoom"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"ver":0.3,"upd_dt":"2022-09-20 16:26:01","remark":"","pgmid":"MRStatus_TimeRoom","proc_mst_id":"","pgm_stat":"Y","sort_seq":22,"app_pgmid":"m","shortcut":"","reg_dt":"2022-09-20 16:26:01","reg_usid":"jjr","pgm_nm":"회의실현황(시간/회의실별)","upd_usid":"jjr","pgm_tp":"TX","pgm_grp_nm":"스마트워크_회의실관리","proc_mst_nm":"","app_pgm_nm":"모바일EP","":"트랜젝션(화면)","crud":""};
me.dataDef["_pgm_func"]=[];
me.dataDef["_pgm_data"] = {};
me.dataDef["_pgm_data"]["today"]={"sort_seq":"1","data_id":"today","data_nm":"오픈라운지 - 빠르게 사용/종료처리 하세요!","data_icon":null,"component_pgmid":"FreeForm","component_option":{"remark":"오늘!","content":[{"colid":"floor","colnm":"층","dtype":"text","etype":"sel","refcd":"['1층','2층','3층','4층','6층','7층','8층']","option":"sel:floor::cd","defval":"1층"}],"func":[{"funcid":"ymdPrev","func_nm":"하루전","func_icon":"fa fa-arrow-left"},{"funcid":"ymdFwd","func_nm":"하루뒤","func_icon":"fa fa-arrow-right"},{"funcid":"search","func_nm":"Refresh","func_icon":"fa fa-refresh"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":"예약정보","section_icon":null,"colgrp":null,"colid":"resv_no","colnm":"예약번호","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":"예약정보","section_icon":null,"colgrp":null,"colid":"resv_nm","colnm":"회의명","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":"예약정보","section_icon":null,"colgrp":null,"colid":"attend","colnm":"참석자수","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":"사용자","section_icon":null,"colgrp":null,"colid":"user_id","colnm":"사용자ID","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":"사용자","section_icon":null,"colgrp":null,"colid":"nm","colnm":"사용자명","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":"사용자","section_icon":null,"colgrp":null,"colid":"email","colnm":"이메일","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":"사용자","section_icon":null,"colgrp":null,"colid":"tel_no","colnm":"전화번호","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":"사용자","section_icon":null,"colgrp":null,"colid":"comcd","colnm":"회사","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":"사용자","section_icon":null,"colgrp":null,"colid":"deptnm","colnm":"부서","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":"사용자","section_icon":null,"colgrp":null,"colid":"jobrolenm","colnm":"직책","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":"사용자","section_icon":null,"colgrp":null,"colid":"jobgradenm","colnm":"직급","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"10"},{"sort_seq":12,"section":"사용자","section_icon":null,"colgrp":null,"colid":"admin_yn","colnm":"관리자여부","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"},{"sort_seq":13,"section":"회의실","section_icon":null,"colgrp":null,"colid":"room_id","colnm":"회의실ID","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":"hidden","grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"12"},{"sort_seq":14,"section":"회의실","section_icon":null,"colgrp":null,"colid":"room_nm","colnm":"회의실","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"13"},{"sort_seq":15,"section":"회의실","section_icon":null,"colgrp":null,"colid":"room_cd_stat","colnm":"사용중여부","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"14"},{"sort_seq":16,"section":"회의실","section_icon":null,"colgrp":null,"colid":"room_loc","colnm":"층수","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"15"},{"sort_seq":17,"section":"회의실","section_icon":null,"colgrp":null,"colid":"max_user","colnm":"최대사용자","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"16"},{"sort_seq":18,"section":"회의실","section_icon":null,"colgrp":null,"colid":"max_time","colnm":"최대사용시간","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"17"},{"sort_seq":19,"section":"회의실","section_icon":null,"colgrp":null,"colid":"resv_forward","colnm":"예약개시일수","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"18"},{"sort_seq":20,"section":"회의실","section_icon":null,"colgrp":null,"colid":"limit_cd","colnm":"비고","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"19"},{"sort_seq":21,"section":"회의실","section_icon":null,"colgrp":null,"colid":"room_remark","colnm":"제약사항","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"20"},{"sort_seq":22,"section":"예약정보","section_icon":null,"colgrp":"예약상세","colid":"resv_dt","colnm":"예약일자","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"21"},{"sort_seq":23,"section":"예약정보","section_icon":null,"colgrp":"예약상세","colid":"start_time","colnm":"회의시작시각","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"22"},{"sort_seq":24,"section":"예약정보","section_icon":null,"colgrp":"예약상세","colid":"duration_time","colnm":"사용시간","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"23"},{"sort_seq":25,"section":"예약정보","section_icon":null,"colgrp":"예약상세","colid":"end_time","colnm":"예정종료시각","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"24"},{"sort_seq":26,"section":"예약정보","section_icon":null,"colgrp":"예약상세","colid":"completion_time","colnm":"실종료시각","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"25"},{"sort_seq":27,"section":"예약정보","section_icon":null,"colgrp":"예약상세","colid":"resv_cd_stat","colnm":"예약상태코드","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"26"},{"sort_seq":28,"section":"예약정보","section_icon":null,"colgrp":"예약상세","colid":"remark","colnm":"비고","dtype":"text","etype":null,"attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"27"},{"sort_seq":29,"section":"예약정보","section_icon":null,"colgrp":"작업기록","colid":"reg_usid","colnm":"등록자ID","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"28"},{"sort_seq":30,"section":"예약정보","section_icon":null,"colgrp":"작업기록","colid":"reg_dt","colnm":"등록일시","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"29"},{"sort_seq":31,"section":"예약정보","section_icon":null,"colgrp":"작업기록","colid":"upd_usid","colnm":"수정자ID","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"30"},{"sort_seq":32,"section":"예약정보","section_icon":null,"colgrp":"작업기록","colid":"upd_dt","colnm":"수정일시","dtype":"text","etype":null,"attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"31"}]};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */

    /* 사용자초기화 */
    me.fnInitExtra=function() {
        $("[pgmid='MRStatus_TimeRoom'] #today .componentFunc .quickGuide").text(gParam.dt);
        $("[pgmid='MRStatus_TimeRoom'] #today .componentTop").hide();
        console.log("날짜:"+me.pageObj.today.componentFunc.find(".quickGuide").text());
            
        gfn.home = me;

        //회의실현황 화면으로 back
        $("[pgmid='MRStatus_TimeRoom'] #today").prepend("<i class='fas fa-arrow-left'></i>");
        me.page.find(".fa-arrow-left").on('click', function() {
            gfnLoad("MRStatus",$(".mainContent"),OUTVAR=>{
    		    if(OUTVAR.rtnCd=="OK") {
    			    console.log("회의실현황 back")
        		} 
        	},true);
        });
        
        //Typeit Start!
        new TypeIt('#info',{
            speed:50,
		    afterComplete: function (instance) {
				me.bgimg.addEventListener("load", me.fnTransform );            
	            me.fnTransform();
			}
		}).go();
	    
	    //ScrollOut Effect!
	    ScrollOut({
	        onShown: (el) => {
	            console.dir(el);
	        }
	    });
	    
	    if(isNull(gUserinfo) || isNull(gUserinfo.userid)) {
            me.fnLoginPop();
        } else {
            me.fnInitHome();
        }  
        
    }
    
    
    me.fnInitHome=function() {
        //오늘날짜
	    //me.pageObj.today.componentFunc.find(".quickGuide").text( date("today") );
	    
        if (gUserinfo.userid=="BOT") {
            me.fnTick();
        } else {
    	    me.fnSearch();             
        }    
	    //오픈라운지 SWIPE
	    const today = me.pageObj.today.container[0];
	    today.addEventListener('touchstart', me.handleTouchStart, false);        
        today.addEventListener('touchmove', me.handleTouchMove, false); 
        
         me.page.find("#today").on("click",".far",function(e) {
            //gfnAlert("확인","개발중입니다.");
            
            gObj.debug = $(e.target);
            var far = $(e.target).exactObj(".far");
            
            me.fnShowCal();
            //me.fnRefresh();
        
        });
    
     
    
        //터치이벤트 바인딩
        me.page.find("#today").on("click",".tCell",function(e) {
            gObj.debug = $(e.target);
            var tCell = $(e.target).exactObj(".tCell");
            var tCol  = $(e.target).parents(".tCol");
            var room_id = tCol.attr("room_id");
            var aday    = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
            var aymd    = date(aday,"yyyy-mm-dd","yyyymmdd");
            var time    = tCol.attr("time");
            var resv_no = tCell.find(".resv_nm").attr("resv_no");
            if(isNull(resv_no)) { 
                //가용시점 회의실 예약 : BOT이면 로그인요청
                if(tCol.hasClass("present")) {
                    me.fnMakeResv(room_id, aymd, time);
                } 
                //그외 => 회의실 정보 표시
                else {
                    me.fnShowRoomInfo(room_id);
                }
            } else {  //예약보기  
                me.fnShowResvInfo(resv_no);
                //과거 실적확인 
                //예약중 -> 사용/취소 -> 종료 : 내 예약 OR BOT이면 비번입력. 
                //짜투리 시간 있으면 회의실 추가 예약 : BOT이면 로그인 요청
            } 
        });
    }
    
    /*달력보기*/
    me.fnShowCal=function() {
        var PopLayer = $("<div class='awePopLayer'></div>");
        $("body").append(PopLayer);
    	var Pop = $("<div class='awePop'></div>");
    	PopLayer.append(Pop);
    	gfnLoad("MRshowCal",Pop,OUTVAR=>{
    		if(OUTVAR.rtnCd=="OK") {
    			console.log("달력 Loaded!")
    		} 
    	},true);
    	
    	function _fncfmAll(cfmAll) {
            //if(!isNull(searchPopup)) searchPopup.dialog("close");
            if(!isNull(PopLayer)) {
                gfnClosePop();
             me.fnRefresh();} 
            //목록재조회
            
        }
        gParam.fnCallback = _fncfmAll;
        
    	//me.pageObj.today.componentFunc.find(".quickGuide").text(gParam.dt); 
    }
    
    me.fnLoginPop = function() {
        $("#today").html("<H1 style='width:100%;text-align:center'>로그인 후 사용해주세요</H1>");
        const pgm = "MRLogin";
		const panel = document.querySelector(".userarea");
		panel.innerHTML = "";
		gfnLoad(pgm,panel,OUTVAR=>{}); 
    }
    
    me.fnMakeResv=function(room_id, aymd, start_time) {
        if(gUserinfo.userid=="BOT") {
            var PopLayer = $("<div class='awePopLayer'></div>");
            $("body").append(PopLayer);
        	var Pop = $("<div class='awePop'></div>");
        	PopLayer.append(Pop); 
        	gfnLoad("MRMobileInfo",Pop,OUTVAR=>{
        		if(OUTVAR.rtnCd=="OK") {
        			console.log("예약하기 Loaded!")
        		} 
        	},true); 
        } else {
            var PopLayer = $("<div class='awePopLayer'></div>");
            $("body").append(PopLayer);
        	var Pop = $("<div class='awePop'></div>");
        	PopLayer.append(Pop);
        	gParam.room_id = room_id;
        	gParam.aymd    = aymd;
        	gParam.start_time = start_time;
        	gfnLoad("MRMakeResv",Pop,OUTVAR=>{
        		if(OUTVAR.rtnCd=="OK") {
        			console.log("예약하기 Loaded!")
        		} 
        	},true);
        }
    }                   
    
    me.fnShowRoomInfo=function(room_id) {
        var PopLayer = $("<div class='awePopLayer'></div>");
        $("body").append(PopLayer);
    	var Pop = $("<div class='awePop'></div>");
    	PopLayer.append(Pop);
    	gParam.room_id = room_id;
    	gfnLoad("MRShowRoomInfo",Pop,OUTVAR=>{
    		if(OUTVAR.rtnCd=="OK") {
    			console.log("회의실 정보보기 Loaded!")
    		} 
    	},true);
    }
    
    me.fnShowResvInfo=function(resv_no) {
        var PopLayer = $("<div class='awePopLayer'></div>");
        $("body").append(PopLayer);
    	var Pop = $("<div class='awePop'></div>");
    	PopLayer.append(Pop);
    	gParam.resv_no = resv_no;
    	gfnLoad("MRShowResvInfo",Pop,OUTVAR=>{
    		if(OUTVAR.rtnCd=="OK") {
    			console.log("예약 정보보기 Loaded!")
    		} 
    	},true);
    }
    
    
    me.fnTick=function() {
        //console.log("tick");
        if($(".awePopLayer").length==0) {
            me.fnRefresh();
        }
        setTimeout(me.fnTick,10000);
    }
    
    // me.xDown = null;                                                        
    // me.yDown = null; 
    // me.getTouches = function(evt) {
    //     return evt.touches ||             // browser API
    //           evt.originalEvent.touches; // jQuery
    // }                                                     
                                                                         
    // me.handleTouchStart = function(evt) {
    //     const firstTouch = me.getTouches(evt)[0];    
    //     me.xDown = firstTouch.clientX;                                      
    //     me.yDown = firstTouch.clientY;                                      
    // };                                                
                                                                         
    // me.handleTouchMove = function(evt) {
    //     if ( ! me.xDown || ! me.yDown ) return; 
    //     var xUp = evt.touches[0].clientX;                                    
    //     var yUp = evt.touches[0].clientY;

    //     var xDiff = me.xDown - xUp;
    //     var yDiff = me.yDown - yUp;
                                                                             
    //     if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {/*most significant*/
    //         if ( xDiff > 0 ) {
    //             /* right swipe */ 
    //             me.fnSwipe("right");
    //         } else {
    //             /* left swipe */
    //             me.fnSwipe("left");
    //         }                       
    //     } else {
    //         if ( yDiff > 0 ) {
    //             /* down swipe */ 
    //         } else { 
    //             /* up swipe */
    //         }                                                                 
    //     }
    //     /* reset values */
    //     me.xDown = null;
    //     me.yDown = null;                                             
    // };
    
    // me.fnSwipe=function(leftRight) {
    //     if($("#today .componentBody").outerWidth() >= $("#today .tBody").outerWidth()) {
    //         if(leftRight=="right") {
    //             var ymd = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
    //             me.pageObj.today.componentFunc.find(".quickGuide").text(dateAdd(ymd,1));
    //             me.fnRefresh();
    //         } else {
    //             var ymd = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
    //             me.pageObj.today.componentFunc.find(".quickGuide").text(dateAdd(ymd,-1));
    //             me.fnRefresh(); 
    //         }
    //     }
    // }
    
    /* 이벤트핸들러 */
    me.fnEH=function(component, evt, row, col, val) { 
        //console.log(arguments);
        if(component==me.pageObj.today) {
            if(evt=="componentCond" && row=="change" && col=="floor") {
                me.fnRefresh();
            }
            if(evt=="componentFunc") {
                if(row=="search") {
                    me.fnRefresh();
                }
                else if(row=="ymdPrev") {
                    var ymd = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
                    me.pageObj.today.componentFunc.find(".quickGuide").text(dateAdd(ymd,-1));
                    me.fnRefresh();
                }
                else if(row=="ymdFwd") {
                    var ymd = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
                    me.pageObj.today.componentFunc.find(".quickGuide").text(dateAdd(ymd,1));
                    me.fnRefresh();
                }
            }
        }
    }
 
//     me.counter = 0;
// 	me.bTransform = 0;
// 	me.bgimg = document.querySelector("#bg > img");
// 	me.imgidx = 0; 
//     me.infoData = [
// 		{"h2":"회의실 예약시스템 - 환영합니다!","div":"LF네트웍스/트라이본즈/파스텔세상 공용회의실 자원의 <b>효율적인 사용</b>과 <b>스마트워크 지원</b>하기 위해 회의실은 예약시스템을 통해 관리됩니다."},
// 		{"h2":"사용안내 #1","div":"회의실별 <b>지정된 예약가능기간</b>(2주, 한달)부터 사용예약을 할 수 있습니다."},
// 		{"h2":"사용안내 #2","div":"사용예약시 건별 최대 기간은 <b>하루종일(1일)</b>입니다. <br>대회의실을 통합사용하거나 사용 일정확정이 필요한 경우 예약관리 담당자에게 문의해주시기 바랍니다."},
// 		{"h2":"사용안내 #3","div":"회의실 사용 조정은 이전 회의 <b>예약자 정보를 확인</b>/연락하여 조정 받으시면 되겠습니다."},
// 		{"h2":"사용안내 #4","div":"대회의실 및 미팅룸별 회사별 <b>예약Quota</b>를 넘어서는 경우<br>예약관리 담당자에게 문의해주시기 바랍니다."},
// 		{"h2":"사용안내 #5","div":"회의실 입실 후 <b>사용 및 종료처리</b>를 해 주십시오.<br>사용예약시간 5분이내 사용처리 않으면(<b>No Show시</b>) 다른 사용자를 위해 회의실이 양보됩니다."},
// 		{"h2":"에티켓","div":"회의실 사용 후 다음 사용자를 위해 집기 정리정돈 해 주시고,<br>종이컵/회의자료 및 쓰레기는 꼭 치워주세요~"},		
// 	];
// 	me.curInfo = 0;
// 	me.fnTransform=function() {
// 		me.counter++;
// 		if(me.bTransform == 0) {
// 			me.bgimg.classList.remove("fadein");
// 			me.bgimg.classList.add("fadeout");
// 			me.bTransform = 1;
// 			setTimeout(me.fnTransform, 2100);												
// 		} else if(me.bTransform == 1) {  
// 			if(me.imgidx==5) me.imgidx=0;
// 			me.bgimg.src = "/images/meet_perspective"+me.imgidx+".png"; 
// 			me.imgidx++; 
// 			me.bTransform = 2; 
// 			//이미지전환은 img load이벤트가 호출한다. 
// 		} else if(me.bTransform == 2) { 
// 			me.bgimg.classList.add("fadein");
// 			me.bgimg.classList.remove("fadeout");
// 			me.bTransform = 3; 
// 			setTimeout(me.fnTransform, 2100); 
// 		} else if(me.bTransform == 3) { 
// 			//현황 데이터 업데이트 to info
// 			var info = document.querySelector("#info");
// 			me.curInfo++;
// 			if(me.curInfo >= me.infoData.length) me.curInfo=0; 			
// 			info.innerHTML = `<h2>${me.infoData[me.curInfo].h2}</h2><div>${me.infoData[me.curInfo].div}</div>`;
// 			new TypeIt('#info',{
// 			afterComplete: function (instance) {
// 					me.bTransform = 0;  
// 					me.fnTransform();		
// 					instance.destroy();
// 				}
// 			}).go();										
// 		}
// 	}
	
    me.fnSearch=function() {
        if(isNull(gUserinfo) || isNull(gUserinfo.userid)) {
            $("#today").html("<H1>로그인 후 사용해주세요</H1>");
            const pgm = "MRLogin";
			const panel = document.querySelector(".userarea");
			panel.innerHTML = "";
			gfnLoad(pgm,panel,OUTVAR=>{}); 
            return;
        } 
        var ymd = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
        //var floor = me.pageObj.today._componentCond["floor"].getVal(); 
        var args = {ymd:date(ymd,"yyyy-mm-dd","yyyymmdd")}; //, floor:floor
        var invar = JSON.stringify(args); 
        gfnTx(appid+"."+pgmid,"search",{INVAR:invar},function(OUTVAR){
            console.dir(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                gds.rooms = OUTVAR.rooms;
                gds.users = OUTVAR.users;

                //세션 사용자정보 읽어와서 user
                var rtn = OUTVAR.sessionUser;
                gUserinfo.orgcd  = rtn.orgcd;
                gUserinfo.orgnm  = rtn.orgnm;
                gUserinfo.deptcd = rtn.deptcd;
                gUserinfo.deptnm = rtn.deptnm;
                gUserinfo.userid = rtn.userid;
                gUserinfo.usernm = rtn.usernm;
                gUserinfo.jobgradenm = rtn.jobgradenm;
                gUserinfo.jobrolenm = rtn.jobrolenm;
                gUserinfo.email  = rtn.email; 
                gUserinfo.tel_no  = rtn.tel_no;  
                gUserinfo.admin_yn = rtn.admin_yn;
                
                if(isNull(gUserinfo.userid) || gUserinfo == "anonymous") {
                    $(".topbar .user img").attr("src","/images/noimg.png");
                    $(".topbar .user").css("border-color","#eaeaea");
                    
                    $(".navigation #member").addClass("hidden");
            	    $(".navigation #admin").addClass("hidden"); 
                } else {
                    $(".topbar .user img").attr("src","/images/meet_logo.png");
                    $(".topbar .user").css("border-color","gold");

                    $(".navigation #member").addClass("hidden");
            	    $(".navigation #admin").addClass("hidden"); 
                    //메뉴표시 
                    $(".navigation #member").removeClass("hidden");
            	    if(gUserinfo.admin_yn=="Y") {
            	        $(".navigation #admin").removeClass("hidden");
            	    }
                }
                
                //gParam.r 특정회의실로 요청이 왔으면 해당 층으로 변경해줌
                // if(!isNull(gParam) && !isNull(gParam.r) && gParam.r != 'null') { 
                //     floor = subset(gds.rooms,"room_id",gParam.r)[0].room_loc;
                //     me.pageObj.today._componentCond.floor.setVal(floor);
                // }
                
                //me.fnResv(OUTVAR.resvs);  
                if (gUserinfo.userid=="BOT") {
                    me.fnTick();
                } else {
            	    me.fnRefresh();      
                }  
                
            } else {
                gfnAlert("오류",OUTVAR.rtnMsg);
                gfnHome();
            }
        });
    }
    
    me.fnRefresh=function() {
        if(isNull(gUserinfo) || isNull(gUserinfo.userid)) {
            $("#today").html("<H1>로그인 후 사용해주세요</H1>");
            const pgm = "MRLogin";
			const panel = document.querySelector(".userarea");
			panel.innerHTML = "";
			gfnLoad(pgm,panel,OUTVAR=>{}); 
            return;
        } 
        
        var ymd = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
        //var floor = me.pageObj.today._componentCond["floor"].getVal();
        var args = {ymd:date(ymd,"yyyy-mm-dd","yyyymmdd")};//, floor:floor};
        var invar = JSON.stringify(args); 
        gfnTx(appid+"."+pgmid,"refresh",{INVAR:invar},function(OUTVAR){
            //console.dir(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                me.fnResv(OUTVAR.resvs);  
                if(!isNull(OUTVAR.notiResv) && OUTVAR.notiResv.length > 0) {
                    me.fnBot(OUTVAR.notiResv);
                }
            } else {
                gfnAlert("오류",OUTVAR.rtnMsg); 
            }
        });
    }
    
    //봇알림 발송
    me.fnBot=function(notiResv) {
        var args = {};
        args.list = notiResv;
        var invar = JSON.stringify(args); 
        gfnTx(appid+"."+pgmid,"botUpdate",{INVAR:invar},function(OUTVAR){
            //console.dir(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                function _fnCallback(rtn) {
                    console.log(rtn);
                };
                //메시지 발송
                for(var i=0; i < args.list.length; i++) {
                    var row = args.list[i];
                    var msg = "["+row.room_nm+"] "+row.resv_nm+"("+date(row.resv_dt,"yyyymmdd","yyyy년mm월dd일(weekday)")+" "+row.start_time+" ~ "+row.end_time+") 회의 시작시간 5분전입니다. 입실처리 부탁드립니다. (*사용계획이 취소된 경우 다른 사용자를 위해 예약취소 처리 부탁드립니다.)";
                    if(row.info_tp=="N") msg = "["+row.room_nm+"] "+row.resv_nm+"("+date(row.resv_dt,"yyyymmdd","yyyy년mm월dd일(weekday)")+" "+row.start_time+" ~ "+row.end_time+") 회의 시작시간 10분 경과 No-Show로 예약취소 처리 되었습니다. (*필요한 경우 회의실 상황을 조회하고 재예약 사용해주시기 바랍니다.)";
                    if(row.info_tp=="Y") msg = "["+row.room_nm+"] "+row.resv_nm+"("+date(row.resv_dt,"yyyymmdd","yyyy년mm월dd일(weekday)")+" "+row.start_time+" ~ "+row.end_time+") 회의 종료시간 5분전입니다. 다음 사용자를 위해서 회의실 정리정돈 해주세요~ ^.^!";
                    if(row.info_tp=="G") msg = "["+row.room_nm+"] "+row.resv_nm+"("+date(row.resv_dt,"yyyymmdd","yyyy년mm월dd일(weekday)")+" "+row.start_time+" ~ "+row.end_time+") 회의가 자동 입실처리 되었습니다.";
                    if(row.info_tp=="F") msg = "["+row.room_nm+"] "+row.resv_nm+"("+date(row.resv_dt,"yyyymmdd","yyyy년mm월dd일(weekday)")+" "+row.start_time+" ~ "+row.end_time+") 회의 종료시간 5분 경과되어 자동 종료처리 되었습니다. (*필요한 경우 회의실 상황을 조회하고 재예약 사용해주시기 바랍니다.) ";
                    if(row.comcd=="LFN") {
                        gfnSendMsg("naverworks",row.email,"회의실 예약시스템 -"+row.nm+"님("+row.email+"), "+msg,null,_fnCallback); 
                    } else {
                        gfnSendMsg("jandi",row.email,"회의실 예약시스템 -"+row.nm+"님("+row.email+"), "+msg,null,_fnCallback); 
                    }
                }
                console.log("봇처리 성공"); 
            } else {
                gfnAlert("오류",OUTVAR.rtnMsg); 
            }
        });
    }
    
    
    //화면리프레시
    me.fnResv=function(resvs) {
        //console.log(resvs)
        //GetData
        function _fnGetData(room_id, time) { 
            var data = subset(resvs,"room_id",room_id); 
            /*
            if(data.length > 0 && time=="08") {
                var resv = data[0];
                console.log(time+" *******");
                //console.log(toNum(time) <= toNum(resv.start_time));
                //console.log(toNum(resv.start_time) < toNum(time)+1);
                console.log(toNum(time));
                console.log(toNum(resv.completion_time));
                console.log(toNum(resv.end_time));  
                console.log(resv.completion_time);
                console.log(resv.end_time);  
                console.log(time+":00");  
                console.log("*****************");
            } 
            */
            return nvl(data.filter((resv)=>{
                return ( (time+":00") <= resv.start_time && resv.start_time <= (time+":59") ) ||
                       ( resv.start_time < (time+":00") && (time+":59") < nvl(resv.completion_time,resv.end_time) ) ||
                       ( (time+":01") <= nvl(resv.completion_time,resv.end_time) && nvl(resv.completion_time,resv.end_time) <= (time+":59") )
                
            }),[]); 
        }
        function _fnResvInfo(el) { 
            var cd = nvl(el.resv_cd_stat,"");
            var statnm = "";
            if(cd=="D") statnm = "<span class='D'>예약</span>";
            else if(cd=="Y") statnm = "<span class='Y'>사용중</span>";
            else if(cd=="N") statnm = "<span class='N'>예약취소</span>";
            else if(cd=="F") statnm = "<span class='F'>사용완료</span>"; 
            
            var resvInfo = $(`<div class='tCell past rn${el.rn}'><div class='resv_nm' resv_no='${el.resv_no}'>${el.resv_nm}<span class='usnm'>${el.nm}</span></div>
                              <div class='resv_stat'>${statnm} ${el.completion_time}</div></div>`);
            
            return resvInfo;
        }
        //clear
        me.pageObj.today.componentBody.find("*").remove();
        
        //데이터셋
        var aday = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
        var aymd = date(me.pageObj.today.componentFunc.find(".quickGuide").text(),"yyyy-mm-dd","yyyymmdd"); 
        var today = date("today","yyyy-mm-dd");
        var toymd = date("today","yyyymmdd");
        var curtime = date("today","hh24:mi");
        //var floor = me.pageObj.today._componentCond["floor"].getVal();
        //var rooms = subset(gds.rooms,"room_loc",floor);
        
        var rooms = gds.rooms;
        //rooms = rooms.filter((element) => element.room_id != '7F01');
        
        var times = ["07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22"];        
        var tBody = $("<div class='tBody'></div>"); 

        //시간대
        var tLeft = $("<div class='tLeft'></div>");
        $("<div class='tHead timeHead'>시간</div>").appendTo(tLeft);
        times.forEach((time,idx)=>{
            var timeHead = $("<div class='timeHead'>"+time+"</div>");
            timeHead.appendTo(tLeft); 
        });
        me.pageObj.today.componentBody.append(tLeft);
        
        //회의실
        var tHead = $("<div class='tHead'></div>");
        $("<div class='timeHead'>시간</div>").appendTo(tHead);
        rooms.forEach((room,idx)=>{
            var roomHead = $("<div class='roomHead'>"+room.room_nm+"</div>");
            roomHead.appendTo(tHead); 
        });
        tHead.appendTo(tBody);
        
        //몸통tCol
        times.forEach((time,idx)=>{
            var tRow = $("<div class='tRow'></div>");
            if(toNum(time) <= toNum(curtime) && toNum(curtime) < toNum(time)+1) {
                tRow.addClass("curr");            
            }
            $("<div class='timeHead'>"+time+"</div>").appendTo(tRow); 
            rooms.forEach((room,jdx)=>{
                var tCol = $(`<div class='tCol' room_id='${room.room_id}' time='${time}'></div>`);
                var tItem = $(`<div class='tItem' room_id='${room.room_id}' time='${time}'></div>`); 
                //시점체크하여 표시/실행/예약구간으로 나눔
                if(aymd < toymd || (aymd==toymd && toNum(time) < toNum(curtime))) { ////////////////////////////////////////////////////////과거 상태표시
                    tCol.addClass('past');
                    var data = _fnGetData(room.room_id,time);
                    if(data.length > 0) {
                        data.forEach(el=>{
                            var resvInfo = _fnResvInfo(el);
                            tCol.append(resvInfo);                        
                        }); 
                    } else {
                        tCol.append(`<div class='tCell'> </div>`);
                    }
                } else if ( aymd==toymd && (time <= curtime && toNum(curtime) < toNum(time)+1) ) { /////////////////////////////현재 실행구간
                    tCol.addClass('present');
                    var data = _fnGetData(room.room_id,time); 
                    if(data.length > 0) {
                        data.forEach(el=>{
                            var resvInfo = _fnResvInfo(el);
                                resvInfo.addClass("curr");
                                tCol.append(resvInfo);                 
                        });
                    } else {
                        tCol.append(`<div class='tCell'>예약하기</div>`);
                    }
                } else { ///////////////////////////////////////////////////////////////////////////////////////////////////////예약구간
                    if(aday <= dateAdd(date("today"),room.resv_forward)) { /////////////////////////////////////////////////////예약가능
                        tCol.addClass('present'); 
                        var data = _fnGetData(room.room_id,time); 
                        if(data.length > 0) {
                            data.forEach(el=>{
                                var resvInfo = _fnResvInfo(el);
                                resvInfo.addClass("resv");
                                tCol.append(resvInfo);  
                            });
                        } else {
                            tCol.append(`<div class='tCell'>예약하기</div>`);
                        }
                    } else { ///////////////////////////////////////////////////////////////////////////////////////////////////예약불가
                        tCol.addClass('future'); 
                        var data = _fnGetData(room.room_id,time); 
                        if(data.length > 0) {
                            data.forEach(el=>{
                                var resvInfo = _fnResvInfo(el);
                                resvInfo.addClass("future");
                                tCol.append(resvInfo);                
                            });
                        } else {
                            tCol.append(`<div class='tCell'>${date(dateAdd(aday,-1*toNum(room.resv_forward)),"yyyy-mm-dd","mm/dd")}부터 예약가능</div>`);
                        }
                    }
                }
                tCol.appendTo(tRow); 
            });
            tRow.appendTo(tBody);
        });
        me.pageObj.today.componentBody.append(tBody);
        
        //********MRHome을 Load할때 r값을 던져주고, MRHome의 fnInitExtra에서 아래로직 구현*****************
		//세션없으면 -> 로그인요청 후 로그인되면 아래로 현재 회의정보 페이지로 이동 : me.fnInitExtra 에 이미 구현되어 있음, fnResv가 호출된 것은 이미 로그인세션이 있다는 의미임.
		//세션있고 현재 회의가 있으면 회의정보페이지로 이동 - 버튼클릭시 사용자와 예약자가 같을 경우 즉시처리
		//                                                버튼클릭시 사용자와 예약자가 다르면 빠른 비번입력
		//        현재 회의 없으면 회의실정보페이지로 이동 - 미래이면 예약버튼 표시
	    if(!isNull(gParam) && !isNull(gParam.r) && gParam.r != 'null') { 
	        var room_id = gParam.r;
            //var aday = me.pageObj.today.componentFunc.find(".quickGuide").text(); 
            //var aymd = date(me.pageObj.today.componentFunc.find(".quickGuide").text(),"yyyy-mm-dd","yyyymmdd"); 
	        //var today = date("today","yyyy-mm-dd");
            //var toymd = date("today","yyyymmdd");
            //var curtime = date("today","hh24:mi");
	        //실행구간의 예약정보를 가져옴 
	        if( aymd==toymd ) {          
	            var data = subset(resvs,"room_id",room_id); 
	            var rows = nvl(data.filter((resv)=>{
                               return isNull(resv.completion_time) && //이미 끝난 회의는 필요없고,
                                      (( curtime <= resv.start_time && resv.start_time <= (time+":59") ) ||  //현재시간대에 시작되었거나
                                       ( resv.start_time < curtime && curtime < resv.end_time ) || //현재시간을 포함하거나 
                                       ( curtime <= resv.end_time && resv.end_time <= (time+":59") )) //현시간대에 끝날 예정인 건
                           }),[]);
                if(rows.length >= 1) {
                    //첫번째 예약정보를 띄워줌 - 예약보기  
                    me.fnShowResvInfo(rows[0].resv_no);
                } else {
                    //예약등록창을 띄워줌 
                    me.fnMakeResv(room_id, aymd, curtime);
                }
	        }
	    } 
    } 
    

/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>