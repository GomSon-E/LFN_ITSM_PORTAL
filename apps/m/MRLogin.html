<style>.userarea { 
    position: fixed;
    top: 0px;
    bottom: 0;
    left: 0;
    right: 0; 
    z-index: 100;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: center;
    justify-content: center;
    align-items: center;
}
[pgmid="MRLogin"] {
    background-color: #fffffff0 !important;
    box-shadow: 0 0 2em 2em #6a6a6ab0;
    border-radius: 2em;
    position: relative;
}  
[pgmid="MRLogin"].framepage .pageContent {
    position: relative;
}    
[pgmid="MRLogin"].framepage .btnClose {
    content: "X";
    color: #6d2c2c;
    position: absolute;
    top: 0.25em;
    right: 0.75em;
    font-size: 2em;
    cursor: pointer;
} 

.logintitle{
    text-align:center; 
    margin-top: 1.5em;
}
.loginform{
    width:100%; 
    text-align:center; 
    margin:40px 0px 40px;
}  
[pgmid='MRLogin'].framepage .login.notice {
    margin-bottom: 0.5em;
    text-align: left;
}
[pgmid='MRLogin'].framepage .login.notice.warn {
    color: darkred;
} 
[pgmid='MRLogin'].framepage button{
    font-size : 15px;
    width:80%;
    max-width: 400px; 
    height:60px;  
    margin-bottom : 10px;
}
[pgmid='MRLogin'].framepage input{
    padding:1em;
    line-height: 3em; 
    width:80%;
    max-width: 400px; 
    height:60px; 
    margin-bottom : 10px;
    font-size: 1.5em;
}</style>

<!-- HTML autogen start ---------------------------------------------- -->  
<script type="text/javascript" src="/lib/jquery/core.min.js"></script>
<script	src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"></script>
<script type="text/javascript" src="/lib/jquery/sha256.min.js"></script>
<div class="pageContent">
    <div class="btnClose">X</div>
    <div class="wrapper">
        <div class="logintitle">
            <h1>로그인</h1>
        </div>
        <div class="loginform"> 
            <p class="login notice">
                로그인해주세요~
            </p>
            <input type="text" class="usid" placeholder="메일ID"><br>
            <input type="password" class="pwd" placeholder="비밀번호"><br>
            <button class="loginbtn"><i class="fas fa-key"></i> 로그인</button>
            <hr/>
            <p class="notice">
                비밀번호 초기화 및 사용자 등록시 임직원 인증이 필요합니다. 
            </p>
            <button class="ResetPwd small"><i class="fas fa-user"></i> 비밀번호 초기화</button>
            <button class="RegUser small"><i class="fas fa-user"></i> 사용자등록</button>
        </div>
    </div>
</div>
<!-- HTML autogen end ---------------------------------------------- -->
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "m";
    var pgmid = "MRLogin"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"ver":1.9,"upd_dt":"2022-05-12 10:39:43","remark":"","pgmid":"MRLogin","proc_mst_id":"","pgm_stat":"Y","sort_seq":2,"app_pgmid":"m","shortcut":"","reg_dt":"2022-05-04 16:17:58","reg_usid":"kihyunlee","pgm_nm":"로그인","upd_usid":"kihyunlee","pgm_tp":"TX","pgm_grp_nm":"스마트워크_회의실관리","proc_mst_nm":"","app_pgm_nm":"모바일EP","":"트랜젝션(화면)","crud":""};
me.dataDef["_pgm_func"]=[{"func_icon":null,"reg_dt":"2022-05-04 16:17:58","reg_usid":"","func_nm":"로그인","upd_usid":"","upd_dt":"2022-05-04 16:17:58","func_tp":null,"remark":null,"pgmid":"MRLogin","sort_seq":"1","funcid":"login","content":null,"crud":"R","id":"0"},{"func_icon":null,"reg_dt":"2022-05-04 16:17:58","reg_usid":"","func_nm":"비번변경","upd_usid":"","upd_dt":"2022-05-04 16:17:58","func_tp":null,"remark":null,"pgmid":"MRLogin","sort_seq":"2","funcid":"findPassword","content":null,"crud":"R","id":"1"},{"func_icon":null,"reg_dt":"2022-05-04 16:17:58","reg_usid":"","func_nm":"사용자등록","upd_usid":"","upd_dt":"2022-05-04 16:17:58","func_tp":null,"remark":null,"pgmid":"MRLogin","sort_seq":"3","funcid":"regUser","content":null,"crud":"R","id":"2"}];
me.dataDef["_pgm_data"] = {};
me.dataDef["_pgm_data"]["login"]={"sort_seq":"1","data_id":"login","data_nm":"로그인폼","data_icon":null,"component_pgmid":"FreeForm","component_option":null,"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"userid","colnm":"아이디(메일)","dtype":"text","etype":"txt","attr":"keycol","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"password","colnm":"비밀번호","dtype":"text","etype":"txt","attr":"keycol","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"}]};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */

    /* 사용자초기화 */
    me.fnInitExtra=function() {
        //탭 설정
        //gfnTab(pageid, "tabs", {"multi-active":"off","toggle-switch":"on"}); 
        //사용자 컴포넌트 
        //me.dataDef["_pgm_data"][myCompoId] = {...};
        //me.pageObj["myCompoId"] = new gfnComponent( me.pageid, myCompoId, me.dataDef["_pgm_data"][myCompoId], me.fnEH, me); 
        //me.pageObj["myCompoId"].userComponent = "myCompoId";
        //사용자 컨트롤
        //var myColinfo = {colid:...}
        //me.pageObj["myColId"] = new gfnControl(myColinfo, me.fnEH) 
        //me.page.find("#myCol").append(me.pageObj["myColId"].dispObj);
        //me.pageObj["myColId"].getVal(); / myCol.setVal(val);...    
        $(".userarea").removeClass("hidden");
        
        //조회버튼 눌렀을때
        var RegUser = document.getElementsByClassName("RegUser");
        RegUser[0].addEventListener('click', function() {
            me.fnRegUser(); 
        }); 
        
        var ResetPwd = document.getElementsByClassName("ResetPwd");
        ResetPwd[0].addEventListener('click', function() {
            me.fnResetPwd(); 
        }); 
        
        var loginUser = document.getElementsByClassName("loginbtn");
        loginUser[0].addEventListener('click', function() {
            me.fnLogin(); 
        });
        
        var btnLoginClose = document.querySelector("[pgmid='MRLogin'].framepage .btnClose");
        btnLoginClose.addEventListener('click', function() {
            var userarea = document.querySelector(".userarea");
            userarea.innerHTML = "";
            $(".userarea").addClass("hidden");
        });
    }
    /* 이벤트핸들러 */
    me.fnEH=function(component, evt, row, col, val) { 
        //console.log(evt+","+row+","+col+","+val);
        //화면기능버튼이 눌리면 
        if (component==me.pageObj["_pageFunc"]){ 
            if(typeof(me[col])=='function') me[col](); //col=기능명 me["fnSearch"]()=me.fnSearch(); 
        }
        //login:로그인폼 이벤트처리     
        else if(component==me.pageObj["login"]) {
            if(evt=="componentFunc") {
                if(row=="addRow") {
                    component.addRow();
                } else if(row=="delRow") {
                    component.delRow();
                }
            }
            //if(evt=="change" && col=="colid") {...}
        }

        //사용자 컴포넌트/컨트롤
        else if(component.userComponent=="myCompoId") {
            //if(evt=="dblclick" && col=="colid") {...}
        }
    }
    //login:로그인 
    me.fnLogin=function() {
        var usid = document.querySelector('[pgmid="MRLogin"] .usid').value;
        var pwd = document.querySelector('[pgmid="MRLogin"] .pwd').value;
        if(usid == '' || pwd == ''){
            gfnAlert("로그인 오류","빈 정보를 입력 바랍니다.");
            return;
        }
        var args = {};
        args.usid = usid;
        args.pwd = CryptoJS.SHA256(pwd).toString();
        var invar = JSON.stringify(args);
        console.log(invar)
        gfnTx(appid+"."+pgmid,"login",{INVAR:invar},function(OUTVAR){
            console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                var rtn = OUTVAR.rtn;
                gUserinfo.userid = rtn.userid;
                gUserinfo.usernm = rtn.usernm;
                gUserinfo.orgcd  = rtn.orgcd;
                gUserinfo.orgnm  = rtn.orgnm;
                gUserinfo.deptnm = rtn.deptnm;
                gUserinfo.jobgradenm = rtn.jobgradenm;
                gUserinfo.jobrolenm = rtn.jobrolenm;
                gUserinfo.email  = rtn.email; 
                gUserinfo.tel_no  = rtn.tel_no;  
                gUserinfo.admin_yn  = nvl(rtn.admin_yn,"N"); 
                
                var msg = document.querySelector("[pgmid='MRLogin'].framepage .login.notice");
                if(rtn.ok=="Y") {
                    msg.classList.remove("warn");
                    msg.innerText = `${gUserinfo.usernm}님 환영합니다!`; 
                    me.page.remove();
                    location.reload();
                } else {   
                    msg.classList.add("warn");
                    msg.innerText = rtn.msg; 
                }
                
            } else {
                gfnAlert("오류",OUTVAR.rtnMsg);
            }
        });
    } 

    //regUser:사용자등록 
    me.fnRegUser=function() { 
        const panel = document.querySelector(".userarea");
		panel.innerHTML = "";
		gfnLoad("MRRegUser",panel,OUTVAR=>{});  
    } 

    //findPassword:비번변경 
    me.fnResetPwd=function() {
        const panel = document.querySelector(".userarea");
        var usid = me.page.find("input.usid").val();
		panel.innerHTML = "";
		gfnLoad("MRResetPwd",panel,OUTVAR=>{
		    $(panel).find("input.usid").val(usid);
		});  
    }     

/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>