<style>[pgmid='plasDocUpdTest'].framepage .componentFunc .gButton { 
    height: 2.5em;
    padding: 0.25em 0.5em;  
}

[pgmid='plasDocUpdTest'].framepage .btnXls, [pgmid='plasDocUpdTest'].framepage .btnPdf  { 
    display: none;  
}

[pgmid='plasDocUpdTest'] .mobile  {
    max-width: 250px;
} 

[pgmid='plasDocUpdTest'] .flexRow2 {
    display:flex;
    flex-direction:row;
    height:100%;
    column-gap: 1em;
}

[pgmid='plasDocUpdTest'] #apv {
    display:flex;
    flex-direction:column;
    height:calc(100% - 2.5em); 
    overflow-y: auto;
}
[pgmid='plasDocUpdTest'] #comment {
    max-height: 94.5%;
}

[pgmid='plasDocUpdTest'] #comment.floatRight {
    position: fixed;
    top: 13em;
    right: 3em;
    display: block;
    z-index: 1;
    max-height: calc(85% - 13em); 
    background-color: #ffffd1;
    border-radius: 0.5em;
    box-shadow: 0 0 8px 5px #3a3a3a4a;
    padding: 0.5em;
}

[pgmid='plasDocUpdTest'] #apv > * {
    flex: 1 1 50%;
}

@media (max-width: 480px)
{ 
    
    [pgmid='plasDocUpdTest'] #apv > .flexRow2 > * {
        height: unset !important;
    }

    [pgmid='plasDocUpdTest'] .mobile  {
        max-width: 100%;
    }   
    [pgmid='plasDocUpdTest'] .flexRow2 {
        display:block; 
    }  
    [pgmid='plasDocUpdTest'] .flexColumn {
        width: 100% !important;
        min-height: 25em;
        max-height: 50em;
    }
    [pgmid='plasDocUpdTest'] .expand.gButton {
        display: none;
    } 
    [pgmid='plasDocUpdTest'] #apv {
        height: 100em;
    } 
    [pgmid='plasDocUpdTest'] #apv .flexRow2 > *{
        height: 25em;
    }
} 

[pgmid='plasDocUpdTest'] .row  {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    width: 100%;
} 
[pgmid='plasDocUpdTest'] .row > *  {
    flex: 1 1 auto;
} 

[pgmid='plasDocUpdTest'] .side > div:first-child {
    flex: 1 1 auto !important; 
}

[pgmid='plasDocUpdTest'] .side > div:last-child {
    min-height: unset;
}

[pgmid='plasDocUpdTest'] .componentBody .ag-root-wrapper-body { 
    min-height: 10em;
}
 
[pgmid='plasDocUpdTest'] #doc_template .componentBody, [pgmid='plasDocUpdTest'] #doc_template .componentBody .aweCol {
    font-size: 11px;
}

[pgmid='plasDocUpdTest'] [colgrp='전결'] label {
    flex: 0 0 3em;
    min-width: 3em;
}
[pgmid='plasDocUpdTest'] [colgrp='합의'] label {
    flex: 0 0 3em;
    min-width: 3em;
}
[pgmid='plasDocUpdTest'] [colgrp='보고'] label {
    flex: 0 0 3em;
    min-width: 3em;
}

[pgmid='plasDocUpdTest'] #tabs {
    z-index: 1;
}

[pgmid='plasDocUpdTest'] #tabs2 {
    position: relative;
    background-color: slategrey;
    padding: 12px 5px 0 5px;
}

[pgmid='plasDocUpdTest'] .expand {
    position: absolute;
    top: 5px;
    right: 5px; 
}

[pgmid='plasDocUpdTest'] .float {
    position: absolute;
    min-width: 90vw;
    max-width: calc(100% - 5vh);
    min-height: 75vh;
    max-height: calc(100% - 5vw);
    height:25em !important;
    top: 5vh;
    left: 5vw;
    z-index: 1;
    background-color: slategray;
    padding: 1em;
    box-shadow: 0 0 1em 1em #3a3a3aa3;
}

[pgmid='plasDocUpdTest'] #editPanel .doc_body {
    border: 0;
    padding: 0;
    min-height: unset;
}

.hideComponentFunc .componentFunc {
    display: none;
}
.hideComponentFunc button.ui-button.aweCol[colid='btnDelete'] {
    display: none;
}

/** 인쇄용 Class ********************************************************************/
[pgmid='plasDocUpdTest'] #previewPanel {
    max-width: 190mm;
    width: 190mm;
    min-width: 190mm;
    /*border: 1px solid #b4d7ff;*/
    min-height: 274mm;
    white-space: break-spaces;
    overflow-x: hidden;
} 
.doc_container {
    width: 100%; 
    font-size: 12px;
    line-height: 1.25;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
    align-content: space-between;
    justify-content: flex-start;
    align-items: stretch;
}
.doc_container > * {
    flex: 0 0 auto;
}
.doc_container > *.doc_body {
    flex: 1 1 100%;
}
.doc_container table {
    border-spacing: 0;
}
.doc_row {  
    min-height: 2em; 
}
    .doc_row > th, .doc_row > td {   
        border-bottom: 1px solid #a3a3a3;
    }
    .doc_label { 
        width: 6em;
        text-align: right;
        padding: 0.5em 1em;
        border-right: 1px solid #a3a3a3;
        background-color: #dedede;  
    }  
    .doc_val {
        padding-left: 1em;
        align-items: center;
    }
.doc_cover { 
    text-align: center;
    background-color: #aeaeae;
    padding: 1em;
    border: 1px solid #a3a3a3;
    position: relative;
}
.doc_cover::before {
    content: " ";
    position: absolute;
    left: 5px;
    width: 140px;
    top: 5px;
    bottom: 5px;
    background: url(/images/CI.jpg) no-repeat;
    background-size: contain;
}
.doc_top {
    border: 1px solid #a3a3a3; 
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: space-between;
    justify-content: space-between;
    align-items: stretch;
}
    .doc_top table {
        height: 25vh;
    }
    .doc_mst {
        flex: 0 0 400px;
        width: 400px; 
        border-right: 1px solid #a3a3a3;
    }
    .doc_rcvs {
        flex: 1 1 auto;
    }  
        .doc_rcvs .doc_label {
            width: 3em; 
        } 
        .doc_rcvs .doc_val {
            padding-left: 0;
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            align-content: space-between;
            justify-content: flex-start;
            align-items: stretch;
            height: 100%;
        }    
        .doc_rcv {
            border-right: 1px solid #a3a3a3;
            flex: 1 1 auto;
            max-width: 20%;
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
            align-content: center;
            justify-content: space-between;
            align-items: stretch;
            text-align: center;
        }  
        .doc_rcv > * {
            border-bottom: 1px solid #d3d3d3;
            padding: 0.25em;
            flex: 1 1 auto;
            display: flex; 
            flex-direction: column;
            align-content: center;
            justify-content: center;
            text-align: center;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        } 
        .doc_rcv > *:last-child {
            border-bottom: 0;
        }
        .doc_rcv > * > * {
            width: 100%;
            text-align: center;
            /*text-overflow: ellipsis;*/
            white-space: nowrap;
            overflow: hidden;
        }
        .doc_rcv .dept_nm {
            font-size: 1px; 
        }
        .doc_rcv .ap_dt {
            font-size: 0.8em; 
        }        
        .doc_row.doc_rcv_cc .doc_val {
            flex-wrap: wrap;
            align-content: flex-start;
            justify-content: flex-start;
            align-items: flex-start;
        }
        .doc_row.doc_rcv_cc .doc_val .doc_rcv  {
            flex: 0 0 auto;
            border-right: 0; 
            flex-direction: row;
        }
        .doc_row.doc_rcv_cc .doc_val .doc_rcv .emp_nm  {
            display:flex;
            flex-direction: row;
        }
        .doc_row.doc_rcv_cc .doc_val .doc_rcv .emp_nm::after  {
            content:",";
        }
        .doc_row.doc_rcv_cc .doc_val .doc_rcv:last-child .emp_nm::after  {
            content:none;
        }
.doc_header { 
    border: 1px solid #a3a3a3;
    width: 100%; 
}    
.doc_body {
    flex: 1 1 100%;
    min-height: 40em;
    border: 1px solid #a3a3a3;
    padding: 16px;
}
.doc_footer {
    width: 100%;  
    border: 1px solid #a3a3a3;
} 
    .doc_footer .doc_val { 
        display: flex;
        flex-direction: column;
        flex-wrap: nowrap;
        align-content: space-between;
        justify-content: flex-start;
        align-items: stretch; 
    }  
    .doc_file, .doc_ref_doc {
        display: flex;
        flex-direction: row;
        flex-wrap: nowrap;
        align-content: center;
        justify-content: flex-start;
        align-items: center; 
        padding: 0.5em;
        padding-left: 0;
        column-gap: 1em;
    }    
 
.mobile #previewPanel {
    max-width: 100% !important;
    min-width: 100% !important;    
}
.mobile .doc_top {
    flex-wrap: wrap;
}
.mobile .doc_cover::before {
    width: 80px;
}

@media print {
    body * {
        visibility: hidden;
    }
    body .mainContent {
        position: absolute;
        top:0;
        left:0;
    }
    #previewPanel, #previewPanel * {
        visibility: visible; 
    }
    #previewPanel {
        position: absolute;
        top: 0;
        left: 0;
        border: 0;
    }
}
</style>

<!-- HTML autogen start ---------------------------------------------- --> 

<div class="pageTop"></div>
<div id="editPanel" class="pageContent"> 
    <ul id="tabs0">
        <li refid="entry">문서 작성</li> 
        <li refid="apv">결재선</li> 
        <li refid="doc_template">전결규정</li>
        <li refid="doc_plas">회계분개</li> 
    </ul>
    <div id="doc_template" style="background-color: #efefef40; border: 1px solid #eaeaea;"></div>
    <div id="entry" class="flexRow2">
        <div id='mst' class="mobile"></div>
        <div class="doc_body flexColumn" style="flex: 0 0 auto; width: 190mm;">
            <ul id="tabs">
                <li refid="doc_body">본문</li>
                <li refid="doc_data">원천DATA</li> 
            </ul>
            <div id="doc_body" class="flexColumn">
                <textarea id="mytextarea" class="boardContent" name="mytextarea" placeholder="내용을 입력하세요"></textarea> 
            </div>    
            <div id="doc_data" class="flexColumn">
                <ul id="tabs2">
                    <li refid="doc_data_src">거래내역</li>
                    <li refid="doc_data_pay">지급조건</li> 
                    <li refid="doc_data_pjt">금액배부</li>  
                    <button class="expand gButton"><i class="fas fa-share-square"></i> 확장</button>
                </ul> 
                <div id="doc_data_src"></div>
                <div id="doc_data_pay"></div>
                <div id="doc_data_pjt"></div>
            </div>
        </div> 
        <div style="flex: 1 1;" class="flexColumn">
            <div id='attach' style="flex:1 1 50%"></div>   
            <div id='ref_doc' style="flex:1 1 50%"></div>    
        </div>
    </div>
    <div id="apv">
        <div class="flexRow2">
            <div style="flex:1 1 auto" class="flexColumn">
                <div class="flexRow2" style="height:50%">
                    <div id='rcv' style="max-width:400px"></div>            
                    <div id='rcv_cc' style="max-width:400px"></div>    
                </div> 
                <div id="doc_budget"></div>
            </div>
            <div id="comment"></div>
        </div>
    </div>          
    <div id="doc_plas" class="flexColumn" >
        <div id="doc_plas_frm"></div>
        <div id="doc_plas_chit" class="flexColumn"></div> 
    </div>  
</div>
<div id="previewPanel" style="max-width:190mm;display:none"></div>

<!-- HTML autogen end ---------------------------------------------- -->
<script>
/*-- SCRIPT autogen start ---------------------------------------------- */        
$(function() {
    var appid = "plas";
    var pgmid = "plasDocUpdTest"; 
    var page = $("*[pgmid='"+pgmid+"'].framepage").last();
    var pageid = page.attr("id"); 
    var me = {}
    var dataSet = {};
    var dataDef = {};
    var pageObj = {};
    var bEdit = false;
    me.fnInit = function() {
        gfn[pageid] = me; 
        me.appid    = appid;
        me.pgmid    = pgmid;
        me.pageid   = pageid;
        me.page     = page; 
        me.dataSet = dataSet;
        me.dataDef = dataDef;
        me.pageObj = pageObj;
        me.bEdit = bEdit;
me.dataDef["_pgm"]={"ver":0.5,"upd_dt":"2022-09-14 11:05:01","remark":"","pgmid":"plasDocUpdTest","proc_mst_id":"","pgm_stat":"Y","sort_seq":202,"app_pgmid":"plas","shortcut":"","reg_dt":"2022-09-14 11:05:01","reg_usid":"jjr","pgm_nm":"전자결재문서[테스트]","upd_usid":"jjr","pgm_tp":"TX","pgm_grp_nm":"전자결재","proc_mst_nm":"","app_pgm_nm":"경영관리","":"트랜젝션(화면)","crud":""};
me.dataDef["_pgm_func"]=[{"func_icon":"fas fa-save","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"저장","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"1","funcid":"save","content":"문서 저장","crud":"R","id":"0"},{"func_icon":"fas fa-file-signature","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"상신","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"2","funcid":"cfm","content":"문서 상신","crud":"R","id":"1"},{"func_icon":"fas fa-file-signature","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"합의/승인","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"3","funcid":"apv","content":"문서 합의 및 승인","crud":"R","id":"2"},{"func_icon":"fas fa-replay","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"반려","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"4","funcid":"reject","content":"문서 반려","crud":"R","id":"3"},{"func_icon":"fas fa-history","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"회수","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"5","funcid":"return","content":"문서 회수(상신/승인 취소)","crud":"R","id":"4"},{"func_icon":"fas fa-history","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"재상신편집","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"6","funcid":"revive","content":"반려문서 재상신을 위한 편집","crud":"R","id":"5"},{"func_icon":"fas fa-share-square","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"공유","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"EH","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"7","funcid":"share","content":"문서공유","crud":"R","id":"6"},{"func_icon":"fas fa-copy","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"복사","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"8","funcid":"copy","content":"문서 복사 및 신규 생성","crud":"R","id":"7"},{"func_icon":"fas fa-paint-roller","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"보기","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"EH","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"8","funcid":"preview","content":"문서 미리보기/문서작성 전환","crud":"R","id":"8"},{"func_icon":"fas fa-print","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"발행","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"EH","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"9","funcid":"print","content":"문서 발행","crud":"R","id":"9"},{"func_icon":"fas fa-trash","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"삭제","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"DB_W","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"10","funcid":"delete","content":"문서삭제","crud":"R","id":"10"},{"func_icon":"fas fa-close","reg_dt":"2022-09-14 11:05:01","reg_usid":"","func_nm":"닫기","upd_usid":"","upd_dt":"2022-09-14 11:05:01","func_tp":"EH","remark":null,"pgmid":"plasDocUpdTest","sort_seq":"11","funcid":"close","content":"문서닫기","crud":"R","id":"11"}];
me.dataDef["_pgm_data"] = {};
me.dataDef["_pgm_data"]["mst"]={"sort_seq":"1","data_id":"mst","data_nm":"문서 작성","data_icon":null,"component_pgmid":"aweForm","component_option":null,"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"doc_template_id","colnm":"문서종류","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"10","h":null,"refcd":"DOC_TEMPLATE_ID","option":"sel:doc_template_id::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"doc_dt","colnm":"문서일자","dtype":"ymd","etype":"txt","attr":"keycol","defval":"date(\"today\")","w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"doc_no","colnm":"문서번호","dtype":"text","etype":"raw","attr":"disabled","defval":"TBD","w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"reg_co","colnm":"회사","dtype":"text","etype":"raw","attr":"disabled","defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"reg_dept","colnm":"부서","dtype":"text","etype":"raw","attr":"disabled","defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"reg_emp_info","colnm":"작성자","dtype":"text","etype":"txt","attr":"keycol pop ","defval":null,"w":"15","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"title","colnm":"문서명","dtype":"text","etype":"txt","attr":"keycol","defval":null,"w":"35","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"tag","colnm":"키워드","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"35","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":null,"colid":"doc_stat","colnm":"문서상태","dtype":"text","etype":"sel","attr":"disabled","defval":null,"w":"10","h":null,"refcd":"DOC_STAT","option":"sel:doc_stat::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":"등록","colid":"reg_usid","colnm":"등록자","dtype":"text","etype":"sel","attr":"disabled","defval":null,"w":"4","h":null,"refcd":"PLAS_USID","option":"sel:reg_usid::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":null,"section_icon":null,"colgrp":"등록","colid":"reg_dt","colnm":"등록일시","dtype":"text","etype":"raw","attr":"disabled","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"10"},{"sort_seq":12,"section":null,"section_icon":null,"colgrp":"수정","colid":"upd_usid","colnm":"수정자","dtype":"text","etype":"sel","attr":"disabled","defval":null,"w":"4","h":null,"refcd":"PLAS_USID","option":"sel:upd_usid::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"},{"sort_seq":13,"section":null,"section_icon":null,"colgrp":"수정","colid":"upd_dt","colnm":"수정일시","dtype":"text","etype":"raw","attr":"disabled","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"12"},{"sort_seq":14,"section":null,"section_icon":null,"colgrp":null,"colid":"content","colnm":"문서내용","dtype":"text","etype":"none","attr":"hidden","defval":null,"w":"0","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"13"}]};
me.dataDef["_pgm_data"]["rcv"]={"sort_seq":"2","data_id":"rcv","data_nm":"결재/합의선","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"rn","gridOptions":{"defaultColDef":{"sortable":false,"filter":false,"stopEditingWhenCellsLoseFocus":true}},"func":[{"funcid":"addAuto","func_nm":"자동","func_icon":"fas fa-plus"},{"funcid":"addRow","func_nm":"추가","func_icon":"fas fa-plus"},{"funcid":"moveUp","func_nm":"순서","func_icon":"fas fa-sort-up"},{"funcid":"moveDown","func_nm":"순서","func_icon":"fas fa-sort-down"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_tp","colnm":"구분","dtype":"text","etype":"sel","attr":"keycol","defval":null,"w":"5","h":null,"refcd":"RCV_TP","option":"sel:rcv_tp::nm::전자결재:결재선","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_dept_nm","colnm":"부서","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"11","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_hrsp_nm","colnm":"직무","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_emp_nm","colnm":"성명","dtype":"text","etype":"txt","attr":"keycol pop center","defval":null,"w":"6","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_hcls_nm","colnm":"직급","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"btnDelete","colnm":"삭제","dtype":"text","etype":"btn","attr":"center fixR","defval":null,"w":"3","h":null,"refcd":null,"option":":fas fa-trash","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_usid","colnm":"사용자ID","dtype":"text","etype":"none","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_emp_cd","colnm":"사번","dtype":"text","etype":"none","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"}]};
me.dataDef["_pgm_data"]["rcv_cc"]={"sort_seq":"3","data_id":"rcv_cc","data_nm":"참조선","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"rn","gridOptions":{"defaultColDef":{"sortable":false,"filter":false}},"func":[{"funcid":"addRow","func_nm":"추가","func_icon":"fas fa-plus"},{"funcid":"moveUp","func_nm":"순서","func_icon":"fas fa-sort-up"},{"funcid":"moveDown","func_nm":"순서","func_icon":"fas fa-sort-down"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_tp","colnm":"구분","dtype":"text","etype":"sel","attr":"keycol","defval":null,"w":"6","h":null,"refcd":"RCV_TP","option":"sel:rcv_tp::nm::전자결재:참조","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_dept_nm","colnm":"부서","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_hrsp_nm","colnm":"직무","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_emp_nm","colnm":"성명","dtype":"text","etype":"txt","attr":"keycol pop center","defval":null,"w":"6","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_hcls_nm","colnm":"직급","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"btnDelete","colnm":"삭제","dtype":"text","etype":"btn","attr":"center fixR","defval":null,"w":"3","h":null,"refcd":null,"option":":fas fa-trash","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_usid","colnm":"사용자ID","dtype":"text","etype":"none","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"rcv_emp_cd","colnm":"사번","dtype":"text","etype":"none","attr":"hidden","defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"}]};
me.dataDef["_pgm_data"]["attach"]={"sort_seq":"4","data_id":"attach","data_nm":"첨부파일","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"rn","gridOptions":{"defaultColDef":{"sortable":false,"filter":false}},"remark":"내용(파일명)을 수정할 수 있습니다.","func":[{"funcid":"attachFile","func_nm":"파일추가","func_icon":"fas fa-folder-open"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"content","colnm":"내용","dtype":"text","etype":"txt","attr":"keycol","defval":null,"w":"25","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"content_info","colnm":"정보","dtype":"text","etype":"raw","attr":"disabled","defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"ref_id","colnm":"첨부ID","dtype":"text","etype":"none","attr":"hidden","defval":null,"w":"0","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"btn_show","colnm":"보기","dtype":"text","etype":"btn","attr":"center fixR","defval":null,"w":"4","h":null,"refcd":null,"option":":fas fa-search","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"}]};
me.dataDef["_pgm_data"]["ref_doc"]={"sort_seq":"5","data_id":"ref_doc","data_nm":"참조문서","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"rn","gridOptions":{"defaultColDef":{"sortable":false,"filter":false}},"func":[{"funcid":"attachDoc","func_nm":"문서추가","func_icon":"fas fa-file-alt"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"doc_no","colnm":"문서번호","dtype":"text","etype":"raw","attr":null,"defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"title","colnm":"문서명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"content","colnm":"첨부ID","dtype":"text","etype":"none","attr":"hidden","defval":null,"w":"0","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"btnShow","colnm":"보기","dtype":"text","etype":"btn","attr":"center fixR","defval":null,"w":"4","h":null,"refcd":null,"option":":fas fa-search","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"btnDelete","colnm":"삭제","dtype":"text","etype":"btn","attr":"center fixR","defval":null,"w":"4","h":null,"refcd":null,"option":":fas fa-trash","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"}]};
me.dataDef["_pgm_data"]["doc_template"]={"sort_seq":"6","data_id":"doc_template","data_nm":"문서 템플릿(전결규정)","data_icon":"fas fa-book-open","component_pgmid":"aweForm","component_option":null,"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"cat","colnm":"문서분류","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"30","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":"템플릿","colid":"doc_template_id","colnm":"템플릿ID","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"5","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":"템플릿","colid":"title","colnm":"템플릿명","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"25","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"remark","colnm":"적요","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"50","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":"작성부서(최상위)","section_icon":null,"colgrp":"부서1~4","colid":"div_cd1","colnm":"부서1","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":"작성부서(최상위)","section_icon":null,"colgrp":"부서1~4","colid":"div_cd2","colnm":"부서2","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":"작성부서(최상위)","section_icon":null,"colgrp":"부서1~4","colid":"div_cd3","colnm":"부서3","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":"작성부서(최상위)","section_icon":null,"colgrp":"부서1~4","colid":"div_cd4","colnm":"부서4","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":"결재선Variant 및 금액점검 여부","section_icon":null,"colgrp":null,"colid":"amt_tp","colnm":"Variant","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"15","h":null,"refcd":"AMT_TP","option":"sel:amt_tp::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":"결재선Variant 및 금액점검 여부","section_icon":null,"colgrp":null,"colid":"budget_tp","colnm":"금액점검","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"10","h":null,"refcd":"BUDGET_TP","option":"sel:budget_tp::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":"결재선Variant 및 금액점검 여부","section_icon":null,"colgrp":null,"colid":"exec_yn","colnm":"집행집계","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":"예산점검을 위해 이 품의에 등록된 금액은 승인후 집행금액으로 집계됩니다.","crud":"C","id":"10"},{"sort_seq":12,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분1","colid":"budget_in","colnm":"예산범위내","dtype":"text","etype":"raw","attr":"readonly","defval":"예산범위내","w":"2","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"},{"sort_seq":13,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분1","colid":"amt_from","colnm":"이상","dtype":"num","etype":"txt","attr":"readonly","defval":"1","w":"3","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"12"},{"sort_seq":14,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분1","colid":"amt_to","colnm":"이하","dtype":"num","etype":"txt","attr":"readonly","defval":null,"w":"3","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"13"},{"sort_seq":15,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"ap_line","colnm":"전결","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:ap_line::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"14"},{"sort_seq":16,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"rpt_line","colnm":"보고","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:rpt_line::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"15"},{"sort_seq":17,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"합의","colid":"co_lines","colnm":"부서","dtype":"text","etype":"txt","attr":"readonly","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"16"},{"sort_seq":18,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분2","colid":"budget_out","colnm":"예산범위초과","dtype":"text","etype":"raw","attr":"readonly","defval":"예산범위초과","w":"2","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"17"},{"sort_seq":19,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분2","colid":"amt_from_1","colnm":"이상","dtype":"num","etype":"txt","attr":"readonly","defval":null,"w":"3","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"18"},{"sort_seq":20,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분2","colid":"amt_to_1","colnm":"이하","dtype":"num","etype":"txt","attr":"readonly","defval":null,"w":"3","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"19"},{"sort_seq":21,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"ap_line_1","colnm":"전결","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:ap_line_1::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"20"},{"sort_seq":22,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"rpt_line_1","colnm":"보고","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:rpt_line_1::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"21"},{"sort_seq":23,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"합의","colid":"co_lines_1","colnm":"부서","dtype":"text","etype":"txt","attr":"readonly","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"22"},{"sort_seq":24,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분3","colid":"amt_from_2","colnm":"이상","dtype":"num","etype":"txt","attr":"readonly","defval":null,"w":"4","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"23"},{"sort_seq":25,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분3","colid":"amt_to_2","colnm":"이하","dtype":"num","etype":"txt","attr":"readonly","defval":null,"w":"4","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"24"},{"sort_seq":26,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"ap_line_2","colnm":"전결","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:ap_line_2::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"25"},{"sort_seq":27,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"rpt_line_2","colnm":"보고","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:rpt_line_2::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"26"},{"sort_seq":28,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"합의","colid":"co_lines_2","colnm":"부서","dtype":"text","etype":"txt","attr":"readonly","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"27"},{"sort_seq":29,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분4","colid":"amt_from_3","colnm":"이상","dtype":"num","etype":"txt","attr":"readonly","defval":null,"w":"4","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"28"},{"sort_seq":30,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"구분4","colid":"amt_to_3","colnm":"이하","dtype":"num","etype":"txt","attr":"readonly","defval":null,"w":"4","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"29"},{"sort_seq":31,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"ap_line_3","colnm":"전결","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:ap_line_3::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"30"},{"sort_seq":32,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":null,"colid":"rpt_line_3","colnm":"보고","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"3","h":null,"refcd":"AP_LINE","option":"sel:rpt_line_4::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"31"},{"sort_seq":33,"section":"사업부결재선(전결권자, 필수합의부서)","section_icon":null,"colgrp":"합의","colid":"co_lines_3","colnm":"부서","dtype":"text","etype":"txt","attr":"readonly","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"32"},{"sort_seq":34,"section":null,"section_icon":null,"colgrp":null,"colid":"attach","colnm":"첨부파일","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"45","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"33"},{"sort_seq":35,"section":null,"section_icon":null,"colgrp":null,"colid":"ref_doc","colnm":"참조문서","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"45","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"34"},{"sort_seq":36,"section":"원천DATA","section_icon":null,"colgrp":null,"colid":"src_desc","colnm":"거래내역*","dtype":"text","etype":"tarea","attr":"readonly","defval":null,"w":"10","h":"8","refcd":null,"option":"편집:fas fa-edit","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"35"},{"sort_seq":37,"section":"원천DATA","section_icon":null,"colgrp":null,"colid":"pay_desc","colnm":"지급조건*","dtype":"text","etype":"tarea","attr":"readonly","defval":null,"w":"10","h":"8","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"36"},{"sort_seq":38,"section":"원천DATA","section_icon":null,"colgrp":null,"colid":"pjt_desc","colnm":"금액배부*","dtype":"text","etype":"tarea","attr":"readonly","defval":null,"w":"10","h":"8","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"37"},{"sort_seq":39,"section":"PLAS","section_icon":null,"colgrp":"재무결재선","colid":"fi_lines","colnm":"담당","dtype":"text","etype":"raw","attr":"readonly","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"38"},{"sort_seq":40,"section":"PLAS","section_icon":null,"colgrp":null,"colid":"drcr_acct","colnm":"분개유형","dtype":"text","etype":"tarea","attr":"readonly","defval":null,"w":"15","h":"8","refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"39"},{"sort_seq":41,"section":"PLAS","section_icon":null,"colgrp":null,"colid":"evidence_tp","colnm":"증빙관리","dtype":"text","etype":"sel","attr":"readonly","defval":null,"w":"15","h":null,"refcd":"EVIDENCE_TP","option":"sel:evidence_tp::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"40"},{"sort_seq":42,"section":"PLAS","section_icon":null,"colgrp":null,"colid":"auto_chit_tp","colnm":"간소화*","dtype":"text","etype":"txt","attr":"readonly","defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"41"}]};
me.dataDef["_pgm_data"]["doc_data_src"]={"sort_seq":"7","data_id":"doc_data_src","data_nm":"거래내역","data_icon":null,"component_pgmid":"agGrid","component_option":{"gridOpt":"rn chk bForcePaste","gridOptions":{"singleClickEdit":false},"remark":"추가줄수:","content":[{"colid":"rowCnt","colnm":"줄수","dtype":"num","etype":"txt","defval":1}],"func":[{"funcid":"addRow","func_nm":"줄추가","func_icon":"fas fa-plus"},{"funcid":"delRow","func_nm":"줄삭제","func_icon":"fas fa-minus"},{"funcid":"addTbl","func_nm":"표삽입","func_icon":"fas fa-table"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"in_dt","colnm":"일자","dtype":"ymd","etype":"txt","attr":"ymd","defval":null,"w":"8","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"dept_cd","colnm":"부서코드","dtype":"text","etype":"txt","attr":"pop keycol","defval":null,"w":"6","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"dept_nm","colnm":"사용부서","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"pjt_cd","colnm":"PJT코드","dtype":"text","etype":"txt","attr":"pop keycol","defval":null,"w":"6","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"pjt_nm","colnm":"프로젝트","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"acct_cd","colnm":"계정코드","dtype":"text","etype":"txt","attr":"pop keycol","defval":null,"w":"6","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"acct_nm","colnm":"비용계정","dtype":"text","etype":"raw","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":null,"colid":"rmk","colnm":"항목(적요)","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"20","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":null,"colid":"tr_cd","colnm":"거래처코드","dtype":"text","etype":"txt","attr":"pop keycol","defval":null,"w":"6","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":null,"colid":"tr_nm","colnm":"거래처","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":null,"section_icon":null,"colgrp":null,"colid":"qty","colnm":"수량","dtype":"num","etype":"txt","attr":null,"defval":null,"w":"5","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"10"},{"sort_seq":12,"section":null,"section_icon":null,"colgrp":null,"colid":"price","colnm":"단가","dtype":"num","etype":"txt","attr":null,"defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"},{"sort_seq":13,"section":null,"section_icon":null,"colgrp":null,"colid":"amt","colnm":"금액(VAT-)","dtype":"num","etype":"txt","attr":null,"defval":null,"w":"7","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"12"},{"sort_seq":14,"section":null,"section_icon":null,"colgrp":null,"colid":"vat","colnm":"부가세액","dtype":"num","etype":"txt","attr":null,"defval":null,"w":"6","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"13"},{"sort_seq":15,"section":null,"section_icon":null,"colgrp":null,"colid":"tamt","colnm":"금액(VAT+)","dtype":"num","etype":"txt","attr":null,"defval":null,"w":"7","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"14"},{"sort_seq":16,"section":null,"section_icon":null,"colgrp":null,"colid":"ref_key","colnm":"정보참조키","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"15"}]};
me.dataDef["_pgm_data"]["doc_data_pay"]={"sort_seq":"8","data_id":"doc_data_pay","data_nm":"지급조건","data_icon":null,"component_pgmid":"agGrid","component_option":{"func":[{"funcid":"getSrc","func_nm":"거래내역 가져오기","func_icon":"fas fa-plus"},{"funcid":"addRow","func_nm":"줄추가","func_icon":"fas fa-plus"},{"funcid":"delRow","func_nm":"줄삭제","func_icon":"fas fa-minus"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"tr_cd","colnm":"거래처","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"4","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"tr_nm","colnm":"거래처명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":"8","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"pay_tp","colnm":"결제방식","dtype":"text","etype":"txt","attr":null,"defval":"10일 현금","w":"8","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"pay_bank","colnm":"결제계좌","dtype":"text","etype":"txt","attr":null,"defval":"은행명 ###-###-####","w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"pay_condition","colnm":"지급조건","dtype":"text","etype":"txt","attr":null,"defval":"선금: 30%, 중도금: 30%, 잔금: 40%","w":"20","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"}]};
me.dataDef["_pgm_data"]["doc_data_pjt"]={"sort_seq":"9","data_id":"doc_data_pjt","data_nm":"금액배부","data_icon":null,"component_pgmid":"agGrid","component_option":{"func":[{"funcid":"getSrc","func_nm":"거래내역 가져오기","func_icon":"fas fa-plus"},{"funcid":"addRow","func_nm":"줄추가","func_icon":"fas fa-plus"},{"funcid":"delRow","func_nm":"줄삭제","func_icon":"fas fa-minus"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"dept_cd","colnm":"사용부서","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"4","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"dept_nm","colnm":"부서명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"pjt_cd","colnm":"프로젝트","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"4","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"pjt_nm","colnm":"프로젝트명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"acct_cd","colnm":"계정","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"8","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"amt","colnm":"금액(VAT-)","dtype":"num","etype":"txt","attr":null,"defval":null,"w":"8","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"rmk","colnm":"적요","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"}]};
me.dataDef["_pgm_data"]["doc_plas_frm"]={"sort_seq":"10","data_id":"doc_plas_frm","data_nm":"재무처리 기본정보","data_icon":null,"component_pgmid":"aweForm","component_option":null,"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":"재무결재선","colid":"fi_line1","colnm":"담당1","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":"재무결재선","colid":"fi_line2","colnm":"담당2","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":"재무결재선","colid":"fi_line3","colnm":"담당3","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":"재무결재선","colid":"fi_line4","colnm":"담당4","dtype":"text","etype":"txt","attr":"pop","defval":null,"w":"10","h":null,"refcd":"mypop","option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":52,"section":null,"section_icon":null,"colgrp":null,"colid":"evidence_tp","colnm":"증빙관리","dtype":"text","etype":"sel","attr":null,"defval":null,"w":"15","h":null,"refcd":"EVIDENCE_TP","option":"sel:evidence_tp::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":53,"section":null,"section_icon":null,"colgrp":null,"colid":"auto_chit_tp","colnm":"간소화*","dtype":"text","etype":"txt","attr":null,"defval":null,"w":"15","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"}]};
me.dataDef["_pgm_data"]["doc_plas_chit"]={"sort_seq":"11","data_id":"doc_plas_chit","data_nm":"분개유형","data_icon":null,"component_pgmid":"agGrid","component_option":{"func":[{"funcid":"getSrc","func_nm":"거래내역 자동분개","func_icon":"fas fa-plus"},{"funcid":"addRow","func_nm":"줄추가","func_icon":"fas fa-plus"},{"funcid":"delRow","func_nm":"줄삭제","func_icon":"fas fa-minus"},{"funcid":"save","func_nm":"분개저장","func_icon":"fas fa-save"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":"간소화전표","colid":"in_dt","colnm":"등록일","dtype":"ymd","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":"간소화전표","colid":"in_sq","colnm":"전표순번","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":"사업장","colid":"div_cd","colnm":"코드","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":"사업장","colid":"div_nm","colnm":"명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":"사용부서","colid":"ct_dept","colnm":"코드","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":"사용부서","colid":"ct_dept_nm","colnm":"명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":"프로젝트","colid":"pjt_cd","colnm":"코드","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"},{"sort_seq":8,"section":null,"section_icon":null,"colgrp":"프로젝트","colid":"pjt_nm","colnm":"명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"7"},{"sort_seq":9,"section":null,"section_icon":null,"colgrp":"차변","colid":"dr_acct_cd","colnm":"계정코드","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"8"},{"sort_seq":10,"section":null,"section_icon":null,"colgrp":"차변","colid":"dr_acct_nm","colnm":"계정명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"9"},{"sort_seq":11,"section":null,"section_icon":null,"colgrp":"차변","colid":"dr_acct_am","colnm":"금액","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"10"},{"sort_seq":12,"section":null,"section_icon":null,"colgrp":"대변","colid":"cr_acct_cd","colnm":"계정코드","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"11"},{"sort_seq":13,"section":null,"section_icon":null,"colgrp":"대변","colid":"cr_acct_nm","colnm":"계정명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"12"},{"sort_seq":14,"section":null,"section_icon":null,"colgrp":"대변","colid":"cr_acct_am","colnm":"금액","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"13"},{"sort_seq":15,"section":null,"section_icon":null,"colgrp":"적요","colid":"rmk_dc","colnm":"적요","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"14"},{"sort_seq":16,"section":null,"section_icon":null,"colgrp":"적요","colid":"rmk_dck","colnm":"적요2","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"15"},{"sort_seq":17,"section":null,"section_icon":null,"colgrp":"거래처","colid":"tr_cd","colnm":"코드","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"16"},{"sort_seq":18,"section":null,"section_icon":null,"colgrp":"거래처","colid":"tr_nm","colnm":"명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"17"},{"sort_seq":19,"section":null,"section_icon":null,"colgrp":"거래처","colid":"ct_am","colnm":"공급가액","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"18"},{"sort_seq":20,"section":null,"section_icon":null,"colgrp":"거래처","colid":"ct_deal","colnm":"세무구분","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"19"},{"sort_seq":21,"section":null,"section_icon":null,"colgrp":"거래처","colid":"jeonja_yn","colnm":"전자계산서","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"20"},{"sort_seq":22,"section":null,"section_icon":null,"colgrp":"부가세/어음","colid":"fr_dt","colnm":"발행일","dtype":"ymd","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"21"},{"sort_seq":23,"section":null,"section_icon":null,"colgrp":"부가세/어음","colid":"ct_nb","colnm":"관리번호","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"22"}]};
me.dataDef["_pgm_data"]["doc_budget"]={"sort_seq":"12","data_id":"doc_budget","data_nm":"당월 예산/집행현황","data_icon":null,"component_pgmid":"agGrid","component_option":{"func":[{"funcid":"refresh","func_nm":"재조회","func_icon":"fas fa-sync-alt"}]},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"acct_cd","colnm":"계정코드","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"acct_nm","colnm":"계정명","dtype":"text","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"budget_amt","colnm":"예산액","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"ex_amt","colnm":"집행액","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"},{"sort_seq":5,"section":null,"section_icon":null,"colgrp":null,"colid":"avail_amt","colnm":"가용액","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"4"},{"sort_seq":6,"section":null,"section_icon":null,"colgrp":null,"colid":"cur_amt","colnm":"당 건","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"5"},{"sort_seq":7,"section":null,"section_icon":null,"colgrp":null,"colid":"bal_amt","colnm":"예산잔액","dtype":"num","etype":"raw","attr":null,"defval":null,"w":null,"h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"6"}]};
me.dataDef["_pgm_data"]["comment"]={"sort_seq":"13","data_id":"comment","data_nm":"변경이력 및 코멘트","data_icon":null,"component_pgmid":"aweComment","component_option":{"ref_info_tp":"T_DOC","ref_id":"TBD","read_cnt":100,"comment_yn":"Y","del_yn":"N"},"inout_tp":null,"content":[{"sort_seq":1,"section":null,"section_icon":null,"colgrp":null,"colid":"comment_tp","colnm":"구분","dtype":"text","etype":"raw","attr":"center","defval":null,"w":"5","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"0"},{"sort_seq":2,"section":null,"section_icon":null,"colgrp":null,"colid":"comments","colnm":"내용","dtype":"text","etype":"raw","attr":"wrapText_autoHeight","defval":null,"w":"20","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"1"},{"sort_seq":3,"section":null,"section_icon":null,"colgrp":null,"colid":"reg_usid","colnm":"등록자","dtype":"text","etype":"sel","attr":"readonly center fixR","defval":null,"w":"5","h":null,"refcd":"PLAS_USID","option":"sel:reg_usid::nm","len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"2"},{"sort_seq":4,"section":null,"section_icon":null,"colgrp":null,"colid":"reg_dt","colnm":"일시","dtype":"text","etype":"raw","attr":"wrapText_autoHeight fixR","defval":null,"w":"10","h":null,"refcd":null,"option":null,"len":null,"valid":null,"colFormula":null,"grpFormula":null,"totFormula":null,"remark":null,"crud":"C","id":"3"}]};

        me.pageObj["_page"] = new gfnFramepage( me ); 
        for(var component_id in me.dataDef["_pgm_data"]) { 
            me.pageObj[component_id] = new gfnComponent( me.pageid, component_id, me.dataDef["_pgm_data"][component_id], me.fnEH, me); 
        }  
        setTimeout(function(){
            $("#frameset").scrollTo(0); //스크롤 
        },10);
        if(typeof(me.fnInitExtra)=='function') me.fnInitExtra(); 
    } 
/*-- SCRIPT autogen end ---------------------------------------------- */
    /* agGrid RN사이즈 줄이기 */
    RN_WIDTH = 32; 

    /* 사용자초기화 */
    me.fnInitExtra=function() {
        gfnGetData("PLAS_USID",function(e){});
        me.co_cd = gUserinfo.co_cd;
        me.doc_template = {};
        
        //변수설정
        if(isNull(gParam) || isNull(gParam.INVAR) || isNull(gParam.INVAR.docid)) {
            gfnAlert("문서정보 확인","조회하려는 문서정보가 잘 못 되었습니다...");
            me.fnClose();
            return;
        }
        me.fnCallback = gParam.fnCallback; 
        me.docid = gParam.INVAR.docid; 
        
        //탭 설정
        gfnTab(pageid, "tabs0"); 
        gfnTab(pageid, "tabs"); 
        gfnTab(pageid, "tabs2"); 
        //원천DATA입력 확대/축소
        me.page.find(".expand").on("click",function(){
            //if(me.page.find("#doc_data").css("position")=="relative") 
            me.page.find("#doc_data").toggleClass("float");
        })
        
        //사용자 컨트롤 
        $("#"+pageid+" #mytextarea").attr("id",pageid+"mytextarea");
        var plugins = [
            "advlist", "autolink", "lists", "link", "image", "charmap", "print", "preview", "anchor",
            "searchreplace", "visualblocks", "code", "fullscreen", "insertdatetime", "media", "table",
            "paste", "code", "help", "wordcount", "save"
        ];
        var edit_toolbar = 'formatselect fontselect fontsizeselect |'
                    + ' forecolor backcolor |'
                    + ' bold italic underline strikethrough |'
                    + ' alignjustify alignleft aligncenter alignright |'
                    + ' bullist numlist |'
                    + ' table tabledelete |'
                    + ' link image';
        var selector = '#'+pageid+'mytextarea';
        tinyMCE.init({
            content_style: "body {font-size: 12px;}",
            selector: selector,
            branding: false,
            /* forced_root_block: false, */
            language: "ko_KR",
            plugins: plugins,
            toolbar: edit_toolbar,
            height: 320, 
            statusbar: false,
            resize: false,
            paste_data_images: true,
            init_instance_callback : function(){  
                //최초 문서내용 조회 : 조회완료와 에디터초기화 차이발생함 => 에디터초기화 후 콜백으로 조회
                me.fnSearch(me.docid);   
            }
        });      
        
        //버튼은 문서상태와 권한에 따라 세팅
        me.pageObj._pageFunc.setDisp("save",false);
        me.pageObj._pageFunc.setDisp("cfm",false);
        me.pageObj._pageFunc.setDisp("apv",false);
        me.pageObj._pageFunc.setDisp("reject",false);
        me.pageObj._pageFunc.setDisp("return",false);
        me.pageObj._pageFunc.setDisp("revive",false); 
        me.pageObj._pageFunc.setDisp("copy",false);
        me.pageObj._pageFunc.setDisp("preview",false);
        me.pageObj._pageFunc.setDisp("share",false);
        me.pageObj._pageFunc.setDisp("print",false); 
        me.pageObj._pageFunc.setDisp("delete",false); 
        me.page.find("#editPanel").hide();
        me.page.find("#previewPanel").show(); 
        
        //템플릿의 사업부결재선 벽돌쌓기 현상 방지
        var sec = me.page.find("[section='사업부결재선(전결권자, 필수합의부서)']");
        var grp1 = $("<div class='row'></div>");
        var grp2 = $("<div class='row'></div>");
        var grp3 = $("<div class='row'></div>");
        var grp4 = $("<div class='row'></div>");
        sec.children("[colgrp]").each((idx,el)=>{
            if(idx>=0 && idx<4*1) $(el).appendTo(grp1);
            if(idx>=4 && idx<4*2) $(el).appendTo(grp2);
            if(idx>=8 && idx<4*3) $(el).appendTo(grp3);
            if(idx>=12 && idx<4*4) $(el).appendTo(grp4);
        });
        sec.append(grp1).append(grp2).append(grp3).append(grp4);
        
        //화면이 열리면 문서템플릿을 먼저 선택해야함.
        //me.fnSetVariant();
        
        //댓글버튼 이벤트 바인딩
        //me.page.find("#addComment button").on("click",me.fnComment);
        me.pageObj.comment.ref_id = me.docid;
        me.pageObj.comment.reset();
       
    }
    
    /* 이벤트핸들러 */
    me.fnEH=function(component, evt, row, col, val) { 
        //console.log(evt+","+row+","+col+","+val);
        //화면기능버튼이 눌리면 
        if (component==me.pageObj["_pageFunc"]){ 
            if(typeof(me[col])=='function') me[col](); //col=기능명 me["fnSearch"]()=me.fnSearch(); 
        }
        //mst:문서 기본정보 이벤트처리     
        else if(component==me.pageObj["mst"]) {
            if(evt=="mypop") {
                if(col=="reg_emp_info") {
                    /**************************************************************************************/
                    //조직도에서 사용자 검색은 코드/명 팝업이 아니므로 별도로 구현함 
                    //var option = val[3]; //"auto:reg_usid:nm:cdnm:"
                    //var term   = val[4]; //입력된 검색어
                    var co_cd = gds.comcd.find(el=>el.grpcd=="DZ_CO_CD"&&el.val_6==gUserinfo.orgcd).cd;
                    var auto  = (inStr(val[3],"auto")<0)?false:true;
                    var term  = val[4];
                    //console.log(val);
                    gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
                    //gfnLoad(app,pgm,oDOM:body에 붙인후,afnCallback,domChildClear)
                    gfnLoad("plas","popupPlasEMP",$("body"),function(OUTVAR){
                        gfnPopup("임직원검색", OUTVAR.rtnMsg, {width:800,height:600}, function(){
                            //console.log(gParam);
                            if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                                var rtn = gParam.OUTVAR.list[0];
                                me.pageObj.mst.setVal("reg_dept",rtn.dept_nm);
                                me.pageObj.mst.setVal("doc_co_cd",rtn.co_cd);
                                me.pageObj.mst.setVal("doc_dept_cd",rtn.dept_cd);
                                me.pageObj.mst.setVal("reg_co", gfnCdNm("DZ_CO_CD",rtn.co_cd,"nm"));
                                me.pageObj.mst.setVal("reg_emp_info",rtn.kor_nm + ' ' + rtn.hcls_nm); 
                                me.pageObj.mst.setVal("emp_cd",rtn.emp_cd);
                            } else {
                                me.pageObj.mst.setVal("reg_dept","");
                                me.pageObj.mst.setVal("doc_co_cd","");
                                me.pageObj.mst.setVal("doc_dept_cd","");
                                me.pageObj.mst.setVal("reg_co_cd",""); 
                                me.pageObj.mst.setVal("reg_emp_info",""); 
                                me.pageObj.mst.setVal("reg_usid","");
                                me.pageObj.mst.setVal("emp_cd","");
                            } 
                        });     
                    })
                    /* mypop 사용자정의 검색창 구현 ****************************************************************/
                }
            } 
        }

        //rcv:담당자 정보 이벤트처리     
        else if(component==me.pageObj["rcv"]) {
            if(evt=="componentFunc") {
                if(row=="addAuto") {
                    me.fnAutoRcv();
                } else if(row=="addRow") { 
                    component.addRow(); 
                } else if(row=="moveUp") { 
                    me.fnSortOrderSet("rcv",-1);
                } else if(row=="moveDown") {
                    me.fnSortOrderSet("rcv",1);
                }
            }
            if(evt=="click" && col=="btnDelete") {
                if(component.getVal(row,"rcv_tp")=="A") {
                    gfnStatus("삭제확인","문서상신자는 삭제할 수 업습니다.");
                    return;
                }
                component.delRow(row,true);  
            }
            if(evt=="mypop" && col=="rcv_emp_nm") {
                /* mypop 사용자정의 검색창 구현 ****************************************************************/
                var co_cd = gds.comcd.find(el=>el.grpcd=="DZ_CO_CD"&&el.val_6==gUserinfo.orgcd).cd;
                var auto  = (inStr(val[3],"auto")<0)?false:true;
                var term  = val[4];
                gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
                gfnLoad("plas","popupPlasEMP",$("body"),function(OUTVAR){
                    gfnPopup("결재/합의선 검색", OUTVAR.rtnMsg, {width:800,height:600}, function(){
                        if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                            me.pageObj.rcv.gridOptions.api.stopEditing();
                            gParam.OUTVAR.list.forEach((rtn,idx)=>{
                                if(idx>0) {
                                    var rowIdx = me.pageObj.rcv.getRowIndex(row);
                                    row = me.pageObj.rcv.getNodeId( (rowIdx+1) );
                                } 
                                me.pageObj.rcv.setVal(row,"rcv_dept_nm",rtn.dept_nm);
                                me.pageObj.rcv.setVal(row,"rcv_hrsp_nm",rtn.hrsp_nm);
                                me.pageObj.rcv.setVal(row,"rcv_emp_nm",rtn.kor_nm);
                                me.pageObj.rcv.setVal(row,"rcv_hcls_nm",rtn.hcls_nm);
                                me.pageObj.rcv.setVal(row,"rcv_usid",rtn.usid);  
                                me.pageObj.rcv.setVal(row,"rcv_emp_cd",rtn.emp_cd);                                  
                            }); 
                        } else { 
                            me.pageObj.rcv.gridOptions.api.stopEditing();
                            me.pageObj.rcv.setVal(row,"rcv_dept_nm","");
                            me.pageObj.rcv.setVal(row,"rcv_hrsp_nm","");
                            me.pageObj.rcv.setVal(row,"rcv_emp_nm","");
                            me.pageObj.rcv.setVal(row,"rcv_hcls_nm","");
                            me.pageObj.rcv.setVal(row,"rcv_usid","");
                            me.pageObj.rcv.setVal(row,"rcv_emp_cd","");  
                        } 
                    });     
                })
                /* mypop 사용자정의 검색창 구현 ****************************************************************/
            }
        }
        
        //rcv_cc:담당자 정보 이벤트처리     
        else if(component==me.pageObj["rcv_cc"]) {
            if(evt=="componentFunc") {
                if(row=="addRow") { 
                    component.addRow({rcv_tp:"BC"}); //사후참조   
                } else if(row=="moveUp") { 
                    me.fnSortOrderSet("rcv_cc",-1);
                } else if(row=="moveDown") {
                    me.fnSortOrderSet("rcv_cc",1);
                }
            }
            if(evt=="click" && col=="btnDelete") {
                component.delRow(row,true); 
            }
            if(evt=="mypop" && col=="rcv_emp_nm") {
                /* mypop 사용자정의 검색창 구현 ****************************************************************/
                var co_cd = gds.comcd.find(el=>el.grpcd=="DZ_CO_CD"&&el.val_6==gUserinfo.orgcd).cd;
                var auto  = (inStr(val[3],"auto")<0)?false:true;
                var term  = val[4];
                gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
                gfnLoad("plas","popupPlasEMP",$("body"),function(OUTVAR){
                    gfnPopup("결재/합의선 검색", OUTVAR.rtnMsg, {width:800,height:600}, function(){
                        if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                            me.pageObj.rcv_cc.gridOptions.api.stopEditing();
                            gParam.OUTVAR.list.forEach((rtn,idx)=>{
                                if(idx>0) {
                                    var rowIdx = me.pageObj.rcv_cc.getRowIndex(row);
                                    row = me.pageObj.rcv_cc.getNodeId( (rowIdx+1) );
                                } 
                                me.pageObj.rcv_cc.setVal(row,"rcv_dept_nm",rtn.dept_nm);
                                me.pageObj.rcv_cc.setVal(row,"rcv_hrsp_nm",rtn.hrsp_nm);
                                me.pageObj.rcv_cc.setVal(row,"rcv_emp_nm",rtn.kor_nm);
                                me.pageObj.rcv_cc.setVal(row,"rcv_hcls_nm",rtn.hcls_nm);
                                me.pageObj.rcv_cc.setVal(row,"rcv_usid",rtn.usid);  
                                me.pageObj.rcv_cc.setVal(row,"rcv_emp_cd",rtn.emp_cd);                                  
                            }); 
                        } else { 
                            me.pageObj.rcv_cc.gridOptions.api.stopEditing();
                            me.pageObj.rcv_cc.setVal(row,"rcv_dept_nm","");
                            me.pageObj.rcv_cc.setVal(row,"rcv_hrsp_nm","");
                            me.pageObj.rcv_cc.setVal(row,"rcv_emp_nm","");
                            me.pageObj.rcv_cc.setVal(row,"rcv_hcls_nm","");
                            me.pageObj.rcv_cc.setVal(row,"rcv_usid","");
                            me.pageObj.rcv_cc.setVal(row,"rcv_emp_cd","");  
                        } 
                    });     
                })
            }
        }

        //attach:첨부문서/파일 이벤트처리     
        else if(component==me.pageObj["attach"]) {
            if(evt=="componentFunc") {
                if(row=="attachFile") {
                    //gParam = {UUID: me.docid, file_tp:"DOC_ATTCH", ref_file_tp:"T_DOC"};
                    gfnUpload(me.docid, "DOC_ATTCH", "T_DOC", function(arrFiles) {
                        //console.log(arrFiles);
                        var data = [];
                        if(!isNull(arrFiles)) {
                            arrFiles.forEach((el,idx)=>{
                                var row = {};
                                if(!isNull(el.fileid)) { 
                                    row.content = el.orgn_nm;
                                    row.content_info = el.file_ext+" ("+el.file_sz+"kb)";
                                    row.fileid  = el.fileid;
                                    row.ref_id  = me.docid;
                                    row.btn_show = el.file_url;
                                    data.push(row);
                                }
                            })
                        }
                        me.pageObj.attach.importData(data);
                    });
                } 
            }
            if(evt=="click") {
                if(col=="btn_show") {
                    var fileid  = component.getVal(row,"fileid");
                    var file_nm = nvl(component.getVal(row,"content"),component.getVal(row,"file_nm"));
                    gfnDownload(fileid, file_nm);   
                }  
            }
        }

        //ref_doc:참조문서 이벤트처리     
        else if(component==me.pageObj["ref_doc"]) {
            if(evt=="componentFunc") {
                if(row=="attachDoc") {
                    /* mypop 사용자정의 검색창 구현 ****************************************************************/
                    var co_cd = gds.comcd.find(el=>el.grpcd=="DZ_CO_CD"&&el.val_6==gUserinfo.orgcd).cd;
                    var auto  = false;
                    var term  = "";
                    gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
                    gfnLoad("plas","popupPlasDoc",$("body"),function(OUTVAR){
                        gfnPopup("참조문서 검색", OUTVAR.rtnMsg, {width:800,height:600}, function(){
                            if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                                gParam.OUTVAR.list.forEach((rtn,idx)=>{
                                    var rowId = component.addRow(); 
                                    me.pageObj.ref_doc.setVal(rowId,"title",rtn.title);
                                    me.pageObj.ref_doc.setVal(rowId,"doc_no",rtn.doc_no);
                                    me.pageObj.ref_doc.setVal(rowId,"content",rtn.docid);  
                                }); 
                            }  
                        });     
                    }); 
                } 
            }
            if(evt=="click") {
                if(col=="btnShow") {
                    gfnShowPlasDoc( component.getVal(row,"content") );
                }  
                if(col=="btnDelete") {
                    component.delRow(row, true);
                }  
            }
        }
        //doc_data_src:원천DATA-거래내역 이벤트처리     
        else if(component==me.pageObj["doc_data_src"]) {
            if(evt=="componentFunc") {
                if(row=="addRow") {
                    var curRow = component.selectedRow();
                    var rowData = {crud:"C"};
                    var rowCnt = nvl(component._componentCond.rowCnt.getVal(),1);
                    var orgData = component.exportData(); 
                    //선택된 줄이 있는 경우 복제하여 줄추가
                    if(curRow >= 0) {
                        rowData = $.extend(true,{},component.getRowData(curRow));
                    } 
                    for(var i=0; i < rowCnt; i++) {
                        orgData.push(rowData);
                    }
                    component.importData(orgData);
                    component.total("top");
                    component.selectRow(curRow);
                }
                if (row=="delRow") {
                    component.delRow(undefined,true);
                    component.total("top");
                } 
                if (row=="addTbl") {
                    //gfnTable(framepage,arrData,arrDispCols,arrColHeader,arrColAttr,totalTopBottom)
                    var arrDispCols =["tr_nm",   "rmk",  "qty", "amt"];
                    var arrColHeader=["공급업체","항목", "수량","금액(v-)"];
                    var arrColAttr  =["center",  "left", "num right", "num"];
                    //템플릿 출력항목 가져옴
                    var src_desc = trim(me.doc_template.src_desc_clob);
                    if(!isNull(src_desc)) {
                        var prt_cols = [];
                        arrDispCols =[];
                        arrColHeader=[];
                        arrColAttr  =[];
                        src_desc = JSON.parse(src_desc);
                        src_desc = sort(src_desc,"sort_seq");
                        src_desc.forEach(col=>{
                            if(col.tbl_yn=='Y') {
                                arrDispCols.push(col.colid); 
                                arrColHeader.push(col.colnm);
                                arrColAttr.push(col.attr);  
                            }
                        });
                        //console.log(arrDispCols);
                        //console.log(arrColHeader);
                        //console.log(arrColAttr);
                    }
                    var htmlTbl = gfnTable(me, "doc_data_src", arrDispCols, arrColHeader, arrColAttr, "bottom");
                    //console.log(htmlTbl);
                    me.content = tinymce.activeEditor.getContent(); 
                    if(inStr(me.content,"[표]")>=0) {
                        me.content = me.content.replace("[표]", htmlTbl);
                        tinymce.activeEditor.setContent(me.content);
                    }
                    else tinymce.activeEditor.insertContent("<br>"+htmlTbl+"<br>"); 
                    gfnAlert("표삽입 확인","본문에 표가 추가되었습니다!");
                }
            } 
            if(evt=="mypop") {
                if(col=="dept_cd") {
                    /**************************************************************************************/
                    var co_cd = me.co_cd; //문서작성자의 회사코드
                    var auto  = (inStr(val[3],"auto")<0)?false:true;
                    var term  = val[4]; 
                    gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
                    //gfnLoad(app,pgm,oDOM:body에 붙인후,afnCallback,domChildClear)
                    gfnLoad("plas","popupPlasGRP",$("body"),function(OUTVAR){
                        gfnPopup("거래처 검색", OUTVAR.rtnMsg, {width:800,height:600}, function(){
                            //console.log(gParam);
                            if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                                var rtn = gParam.OUTVAR.list[0];
                                component.gridOptions.api.stopEditing();
                                component.setVal(row,"dept_cd",rtn.dept_cd);
                                component.setVal(row,"dept_nm",rtn.dept_nm); 
                            } else {
                                component.gridOptions.api.stopEditing();
                                component.setVal(row,"dept_cd","");
                                component.setVal(row,"dept_nm",""); 
                            } 
                            component.forceFocus(row,col,true);
                        });     
                    })
                    /* mypop 사용자정의 검색창 구현 ****************************************************************/ 
                }
                if(col=="pjt_cd") {
                    /**************************************************************************************/
                    var co_cd = me.co_cd; //문서작성자의 회사코드
                    var auto  = (inStr(val[3],"auto")<0)?false:true;
                    var term  = val[4]; 
                    gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
                    //gfnLoad(app,pgm,oDOM:body에 붙인후,afnCallback,domChildClear)
                    gfnLoad("plas","popupPlasPJT",$("body"),function(OUTVAR){
                        gfnPopup("거래처 검색", OUTVAR.rtnMsg, {width:600,height:600}, function(){
                            //console.log(gParam);
                            if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                                var rtn = gParam.OUTVAR.list[0];
                                component.gridOptions.api.stopEditing();
                                component.setVal(row,"pjt_cd",rtn.pjt_cd);
                                component.setVal(row,"pjt_nm",rtn.pjt_nm); 
                            } else {
                                component.gridOptions.api.stopEditing();
                                component.setVal(row,"pjt_cd","");
                                component.setVal(row,"pjt_nm",""); 
                            } 
                            component.forceFocus(row,col,true);
                        });     
                    })
                    /* mypop 사용자정의 검색창 구현 ****************************************************************/ 
                }
                if(col=="tr_cd") {
                    /**************************************************************************************/
                    var co_cd = me.co_cd; //문서작성자의 회사코드
                    var auto  = (inStr(val[3],"auto")<0)?false:true;
                    var term  = val[4]; 
                    gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
                    //gfnLoad(app,pgm,oDOM:body에 붙인후,afnCallback,domChildClear)
                    gfnLoad("plas","popupPlasTR",$("body"),function(OUTVAR){
                        gfnPopup("거래처 검색", OUTVAR.rtnMsg, {width:800,height:600}, function(){
                            //console.log(gParam);
                            if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                                var rtn = gParam.OUTVAR.list[0];
                                component.gridOptions.api.stopEditing();
                                component.setVal(row,"tr_cd",rtn.tr_cd);
                                component.setVal(row,"tr_nm",rtn.tr_nm); 
                            } else {
                                component.gridOptions.api.stopEditing();
                                component.setVal(row,"tr_cd","");
                                component.setVal(row,"tr_nm",""); 
                            }
                            component.forceFocus(row,col,true); 
                        });     
                    })
                    /* mypop 사용자정의 검색창 구현 ****************************************************************/ 
                }
                if(col=="acct_cd") {
                    //doc_template에 정의된 차변계정에서 가져온다.  
                    var arrAcct_list = me.doc_template.drcr_acct.split("\n");
                    //console.log(arrAcct_list);
                    arrAcct_list = nvl(arrAcct_list.find(el=>inStr(el,"차변 -  ")>=0),"");
                    //console.log(arrAcct_list);
                    arrAcct_list = arrAcct_list.replace("차변 -  ","").split(",");
                    //console.log(arrAcct_list);
                    var acct_list = [];
                    arrAcct_list.forEach(el=>{
                        var cols = el.split(":");
                        acct_list.push({cd:trim(cols[0]), nm:trim(cols[1])});
                    })
                    var option = (inStr(val[3],"auto")<0)?"sel:::cdnm":"single:::cdnm";
                    //console.log(option);
                    gfnSearch(acct_list,function(OUTVAR){
                        if(gParam.rtnCd=="OK" && gParam.rtnData.length > 0) {
                            component.gridOptions.api.stopEditing();
                            component.setVal(row,"acct_cd",gParam.rtnData[0].cd);
                            component.setVal(row,"acct_nm",gParam.rtnData[0].nm); 
                        } else {
                            component.gridOptions.api.stopEditing();
                            component.setVal(row,"acct_cd","");
                            component.setVal(row,"acct_nm",""); 
                        }
                        component.forceFocus(row,col,true);
                    }, option, val[4], true );
                }
            }
            if(evt=="change") {
                if(col=="qty"||col=="price") {
                    var qty = component.getVal(row,"qty");
                    var price = component.getVal(row,"price");
                    var tamt = toNum(qty)*toNum(price);
                    var amt  = toNum(format(tamt/1.1,0));
                    var vat  = tamt-amt;
                    component.setVal(row,"tamt",tamt);
                    component.setVal(row,"amt",amt);
                    component.setVal(row,"vat",vat);
                    component.total("top");
                    component.forceFocus(row,col,true);
                }
                if(col=="amt"||col=="vat") {
                    var amt  = toNum(component.getVal(row,"amt"));
                    var vat  = toNum(component.getVal(row,"vat"));
                    var tamt = amt+vat;
                    component.setVal(row,"tamt",tamt); 
                    component.total("top");
                    component.forceFocus(row,col,true);
                } 
                if(col=="tamt") {
                    var tamt = toNum(component.getVal(row,"tamt"));
                    var amt  = toNum(format(tamt/1.1,0));
                    var vat  = tamt-amt;
                    component.setVal(row,"amt",amt);
                    component.setVal(row,"vat",vat);
                    component.total("top");
                    component.forceFocus(row,col,true);
                } 
            }
        }
        //doc_data_pay:원천DATA-지급조건 이벤트처리     
        else if(component==me.pageObj["doc_data_pay"]) {
            if(evt=="componentFunc") {
                if(row=="getSrc") {
                    gfnStatus("기능 개발중입니다.","기능 개발중입니다.");
                }
                if(row=="addRow") {
                    component.addRow(); 
                    component.total("top"); 
                }
                if (row=="delRow") {
                    component.delRow(undefined,true);
                    component.total("top");
                } 
            }
        }
        //doc_data_pay:원천DATA-지급조건 이벤트처리     
        else if(component==me.pageObj["doc_data_pjt"]) {
            if(evt=="componentFunc") {
                if(row=="getSrc") {
                    gfnStatus("기능 개발중입니다.","기능 개발중입니다.");
                }
                if(row=="addRow") {
                    component.addRow(); 
                    component.total("top"); 
                }
                if (row=="delRow") {
                    component.delRow(undefined,true);
                    component.total("top");
                } 
            }
        }
        //doc_plas_chit: 회계분개 이벤트처리     
        else if(component==me.pageObj["doc_plas_chit"]) {
            if(evt=="componentFunc") {
                if(row=="getSrc") {
                    gfnStatus("기능 개발중입니다.","기능 개발중입니다.");
                }
                if(row=="addRow") {
                    component.addRow(); 
                    component.total("top"); 
                }
                if (row=="delRow") {
                    component.delRow(undefined,true);
                    component.total("top");
                } 
                if(row=="save") {
                    gfnStatus("기능 개발중입니다.","기능 개발중입니다.");
                }
            }
        }
        //doc_budget: 예산현황 조회 이벤트처리     
        else if(component==me.pageObj["doc_budget"]) {
            if(evt=="componentFunc") {
                if(row=="refresh") {
                    gfnStatus("기능 개발중입니다.","기능 개발중입니다.");
                } 
            }
        }
    }
    
    //share : 문서공유(사후참조:BC)
    me.fnShare = function(){
        /* mypop 사용자정의 검색창 구현 ****************************************************************/
        var co_cd = gds.comcd.find(el=>el.grpcd=="DZ_CO_CD"&&el.val_6==gUserinfo.orgcd).cd;
        //var auto  = (inStr(val[3],"auto")<0)?false:true;
        //var term  = val[4];
        //gParam ={INVAR:{co_cd:co_cd,term:term,auto:auto}}; 
        gParam ={INVAR:{co_cd:co_cd}}; 
        gfnLoad("plas","popupPlasEMP",$("body"),function(OUTVAR){
            gfnPopup("문서공유/사후참조자 검색", OUTVAR.rtnMsg, {width:800,height:600}, function(){
                if(!isNull(gParam) && !isNull(gParam.OUTVAR) && gParam.OUTVAR.rtnCd=="OK") {
                    // gParam.OUTVAR.list.forEach((rtn,idx)=>{
                    //     console.log(rtn.usid+","+rtn.dept_nm+","+rtn.hrsp_nm);
                    // }); 
                    //console.log(gParam.OUTVAR.list);

                    //confirm추가!
                    gfnConfirm("사후참조자 추가","선택한 팀원에게 문서를 공유하시겠습니까?",OUTVAR=>{
                        if(!OUTVAR) return;
                        var mst = me.pageObj["mst"].exportData()[0];
                        var args = {docid:me.docid};
                        args.list = gParam.OUTVAR.list;
                        var invar = JSON.stringify(args);
                        console.log(invar);
                        gfnTx(appid+"."+pgmid,"saveRcvcc",{INVAR:invar},function(OUTVAR){
                            if(OUTVAR.rtnCd=="OK") {
                                gfnAlert("문서공유 성공","문서가 공유되었습니다.");
                                me.fnSearch(me.docid);
                                
                                if(mst.doc_stat=="F"){ //완료된 문서면, 참조메시지 보내기
                                    gParam.OUTVAR.list.forEach((rtn)=>{
                                        console.log(rtn.usid+","+rtn.dept_nm+","+rtn.hrsp_nm);
                                        var useremail = rtn.email;
                                        var msg = "전자결재 문서가 공유(사후참조)되었습니다.\n\n  - 문서: ["+ mst.doc_no +"] "+ mst.title;
                                        var sender = gds.comcd.find(el=>el.grpcd=="PLAS_USID"&&el.cd==gUserinfo.userid);
                                        msg +=  "\n  - 공유 요청자: "+ sender.deptnm+" "+sender.nm+" "+sender.jobgradenm;
                                        //if(!isNull(args.comment)) msg += "\n  - 의견: "+ args.comment;
                                        var url = "https://fo.lfnetworks.co.kr/plas.jsp?d="+args.docid;
                                        var ref_info = args.docid;
                                        gfnSendMsg("naverworks", useremail, msg, url, function(OUTVAR) {
                                            me.fnSearch(me.docid);    
                                        }, ref_info, pgmid);                             
                                    }); 
                                }
                            }else {
                                gfnAlert("사후참조 저장오류",OUTVAR.rtnMsg);
                            }
                        });
                    });
                } 
            });     
        })
        /* mypop 사용자정의 검색창 구현 ****************************************************************/
    }
    
    //docid로 문서조회 및 초기화 
    me.fnSearch=function(docid) { 
        var args = {docid:docid} 
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"search",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                me.pageObj.mst.importData(OUTVAR.mst); 
                var doc_template = {list:OUTVAR.doc_template};
                
                //법인카드인 경우 법인카드사용등록화면으로 넘겨준다.
                if(OUTVAR.mst[0].doc_template_id=="9-50-010") {
                    gParam.INVAR = {docid:docid}; 
                    gMDI.openPage("plasDocCcard","법인카드 사용내역 등록");
                    me.fnClose();
                    return;
                } else {
                    console.log(OUTVAR.mst[0].doc_template_id);
                }
                
                me.fnPopDocTemplate(doc_template); 
                me.content = OUTVAR.mst[0].content;
                //console.log("tinyEditor setVal:"+pageid+"mytextarea");
                tinyMCE.get(pageid+"mytextarea").setContent(me.content); 
                var rcv_tps = extract(subset(subset(gds.comcd,"grpcd","RCV_TP"),"val_2","결재선"),"cd","distinct"); //A,B,C
                var rcv_cc_tps = extract(subset(subset(gds.comcd,"grpcd","RCV_TP"),"val_2","참조"),"cd","distinct"); //AC,BC,RPT 
                var rcv = (OUTVAR.rcv||[]).filter(el=>inStr(rcv_tps,el.rcv_tp)>=0);
                var rcv_cc = (OUTVAR.rcv||[]).filter(el=>inStr(rcv_cc_tps,el.rcv_tp)>=0);
                me.pageObj.rcv.importData(rcv);
                me.pageObj.rcv_cc.importData(rcv_cc);
                me.pageObj.attach.importData(OUTVAR.attach);
                me.pageObj.ref_doc.importData(OUTVAR.ref_doc);
                me.pageObj.doc_data_src.importData(OUTVAR.doc_data_src);
                me.pageObj.doc_data_pay.importData(OUTVAR.doc_data_pay);
                me.pageObj.doc_data_pjt.importData(OUTVAR.doc_data_pjt);
                me.pageObj.doc_plas_frm.importData(OUTVAR.doc_plas_frm);
                me.pageObj.doc_plas_chit.importData(OUTVAR.doc_plas_chit); 
                
                if(OUTVAR.mst[0].doc_stat=="D" && OUTVAR.mst[0].reg_usid==gUserinfo.userid ) { //문서편집모드(상신전)
                    me.pageObj._pageFunc.setDisp("save",true);
                    me.pageObj._pageFunc.setDisp("cfm",true);
                    me.pageObj._pageFunc.setDisp("apv",false);
                    me.pageObj._pageFunc.setDisp("reject",false);
                    me.pageObj._pageFunc.setDisp("return",false);
                    me.pageObj._pageFunc.setDisp("revive",false); 
                    me.pageObj._pageFunc.setDisp("copy",false);
                    me.pageObj._pageFunc.setDisp("preview",true); 
                    me.pageObj._pageFunc.setDisp("print",false); 
                    me.pageObj._pageFunc.setDisp("delete",true); 
                    me.page.find("#editPanel").show(); 
                    me.page.find("#previewPanel").hide();                      
                    
                } else if(OUTVAR.mst[0].doc_stat=="Y") {  //문서조회모드(합의,승인,반려)
                    var rcvs = me.pageObj.rcv.exportData();
                    var rcv  = rcvs.find(el=>el.rcv_usid==gUserinfo.userid && el.rcv_stat=="Y" && el.proc_stat=="N"); //현재 사용자가 수신후 미처리상태일때
                    if(!isNull(rcv)) { //승인이나 반려
                        me.pageObj._pageFunc.setDisp("save",false);
                        me.pageObj._pageFunc.setDisp("cfm",false);
                        me.pageObj._pageFunc.setDisp("apv",true);
                        me.pageObj._pageFunc.setDisp("reject",true);
                        me.pageObj._pageFunc.setDisp("return",false);
                        me.pageObj._pageFunc.setDisp("revive",false); 
                        me.pageObj._pageFunc.setDisp("copy",false);
                        me.pageObj._pageFunc.setDisp("preview",true);
                        me.pageObj._pageFunc.setDisp("share",false);
                        me.pageObj._pageFunc.setDisp("print",true); 
                        me.pageObj._pageFunc.setDisp("delete",false); 
                        me.fnMakePreview(); 
                    } else {  //미리보기만 가능 -> 회수 승인취소 가능 
                        me.pageObj._pageFunc.setDisp("save",false);
                        me.pageObj._pageFunc.setDisp("cfm",false);
                        me.pageObj._pageFunc.setDisp("apv",false);
                        me.pageObj._pageFunc.setDisp("reject",false);
                        me.pageObj._pageFunc.setDisp("return",false);
                        me.pageObj._pageFunc.setDisp("revive",false); 
                        me.pageObj._pageFunc.setDisp("copy",false);
                        me.pageObj._pageFunc.setDisp("preview",true);
                        me.pageObj._pageFunc.setDisp("share",false);
                        me.pageObj._pageFunc.setDisp("print",true);  
                        me.pageObj._pageFunc.setDisp("delete",false);  
                        me.fnMakePreview(); 
                        //회수기능추가
                        var rcv     = rcvs.filter(el=>el.rcv_stat=="Y" && el.proc_stat=="Y"); //수신/승인건 
                        if(rcv.length < 1) return;
                        var rcvMy   = rcvs.filter(el=>el.rcv_usid==gUserinfo.userid && el.rcv_stat=="Y" && el.proc_stat=="Y"); //내 수신/승인건
                        var curStep = arrayCalc(rcv,"max","","sort_seq");  //승인완료된 건 중 최종단계
                        var myStep  = arrayCalc(rcvMy,"max","","sort_seq"); //내 승인건 중 최종단계
                        if(curStep==myStep) {
                            me.pageObj._pageFunc.setDisp("return",true);
                            me.pageObj._pageFunc.setDisp("share",true); //공유기능
                        }
                        //공유기능
                        var rcv_ccs    = me.pageObj.rcv_cc.exportData(); 
                        var rcv_cc     = rcv_ccs.filter(el=>el.rcv_stat=="Y"); 
                        var rcv_ccMy   = rcv_ccs.filter(el=>el.rcv_usid==gUserinfo.userid && el.rcv_stat=="Y");
                        if(rcv_ccMy.length>=1){
                            me.pageObj._pageFunc.setDisp("share",true); 
                        }
                        
                    }
                } else if(OUTVAR.mst[0].doc_stat=="F" || OUTVAR.mst[0].doc_stat=="N" || OUTVAR.mst[0].doc_stat=="X"  ) {  //문서조회모드(복사생성)
                    me.pageObj._pageFunc.setDisp("save",false);
                    me.pageObj._pageFunc.setDisp("cfm",false);
                    me.pageObj._pageFunc.setDisp("apv",false);
                    me.pageObj._pageFunc.setDisp("reject",false);
                    me.pageObj._pageFunc.setDisp("return",false);
                    me.pageObj._pageFunc.setDisp("revive",false); 
                    me.pageObj._pageFunc.setDisp("copy",true); 
                    me.pageObj._pageFunc.setDisp("preview",true);
                    me.pageObj._pageFunc.setDisp("share",false);
                    me.pageObj._pageFunc.setDisp("delete",false); 
                    me.pageObj._pageFunc.setDisp("print",true);
                    //회수기능추가
                    if(OUTVAR.mst[0].doc_stat=="F") {  
                        var rcvs    = me.pageObj.rcv.exportData(); 
                        var rcv     = rcvs.filter(el=>el.rcv_stat=="Y" && el.proc_stat=="Y"); //수신/승인건 
                        if(rcv.length >= 1) {
                            var rcvMy   = rcvs.filter(el=>el.rcv_usid==gUserinfo.userid && el.rcv_stat=="Y" && el.proc_stat=="Y"); //내 수신/승인건
                            var curStep = arrayCalc(rcv,"max","","sort_seq");  //승인완료된 건 중 최종단계
                            var myStep  = arrayCalc(rcvMy,"max","","sort_seq"); //내 승인건 중 최종단계
                            if(curStep==myStep) {
                                me.pageObj._pageFunc.setDisp("return",true);
                            }
                        }
                        //공유기능
                        var rcv_ccs    = me.pageObj.rcv_cc.exportData(); 
                        var rcv_cc     = rcv_ccs.filter(el=>el.rcv_stat=="Y"); 
                        var rcv_ccMy   = rcv_ccs.filter(el=>el.rcv_usid==gUserinfo.userid && el.rcv_stat=="Y");
                        if(rcv.length >= 1 && rcvMy.length >= 1){
                            me.pageObj._pageFunc.setDisp("share",true); 
                        }
                        if(rcv_ccMy.length>=1){
                            me.pageObj._pageFunc.setDisp("share",true); 
                        }
                    }
                    
                    //재상신편집
                    if(OUTVAR.mst[0].doc_stat!="F" && OUTVAR.mst[0].own_usid==gUserinfo.userid) {
                        me.pageObj._pageFunc.setDisp("revive",true);    
                    }
                    //반려문서는 삭제가능
                    if(OUTVAR.mst[0].doc_stat=="N" && OUTVAR.mst[0].own_usid==gUserinfo.userid) {
                        me.pageObj._pageFunc.setDisp("delete",true);    
                    }
                    me.fnMakePreview(); 
                } else {
                    me.fnMakePreview(); 
                } 
            } else {
                gfnAlert("문서 조회오류",OUTVAR.rtnMsg);
            }
        }); 
    } 
    
    //문서템플릿 조회: 선택하는 게 아니고 조회시 가져온다. 
    me.fnPopDocTemplate=function(OUTVAR) {
        /**************************************************************************************/
        //me.pageObj.mst.setVal("doc_template_id",OUTVAR.list[0].doc_template_id);
        me.pageObj.mst.setVal("doc_template_nm",OUTVAR.list[0].title);
        me.doc_template = $.extend(true,{},OUTVAR.list[0]);
        //me.pageObj.doc_template.importData(OUTVAR.list);
        var rowData = OUTVAR.list[0];
        me.pageObj.doc_template.reset();
        //템플릿의 사업부결재선 벽돌쌓기 현상 방지
        var sec = me.page.find("[section='사업부결재선(전결권자, 필수합의부서)']");
        var grp1 = $("<div class='row'></div>");
        var grp2 = $("<div class='row'></div>");
        var grp3 = $("<div class='row'></div>");
        var grp4 = $("<div class='row'></div>");
        sec.children("[colgrp]").each((idx,el)=>{
            if(idx>=0 && idx<4*1) $(el).appendTo(grp1);
            if(idx>=4 && idx<4*2) $(el).appendTo(grp2);
            if(idx>=8 && idx<4*3) $(el).appendTo(grp3);
            if(idx>=12 && idx<4*4) $(el).appendTo(grp4);
        });
        sec.append(grp1).append(grp2).append(grp3).append(grp4);
        //variant세팅
        me.pageObj.doc_template.importData(rowData);
        me.fnSetVariant();
        //데이터 쪼개서 넣어주기
        rowData.cat = rowData.cat_0 + " > " + rowData.cat_1 + " > " + rowData.cat_2;
        var div_cds = (rowData.div_cd||"").split(";");
        rowData.div_cd1 = div_cds[0].split(":")[1];
        rowData.div_cd2 = div_cds[1].split(":")[1];
        rowData.div_cd3 = div_cds[2].split(":")[1];
        rowData.div_cd4 = div_cds[3].split(":")[1];
        var co_lines = (rowData.co_line||"").split(";");
        rowData.co_line1 = co_lines[0];
        rowData.co_line2 = co_lines[1];
        rowData.co_line3 = co_lines[2]; 
        rowData.co_line4 = co_lines[3];
        rowData.co_lines = nvl(co_lines[0].split(":")[1],"")+" "+nvl(co_lines[1].split(":")[1],"")+" "+nvl(co_lines[2].split(":")[1],"")+" "+nvl(co_lines[3].split(":")[1],"");
        var co_lines_1 = (rowData.co_line_1||"").split(";");
        rowData.co_line1_1 = co_lines_1[0];
        rowData.co_line2_1 = co_lines_1[1];
        rowData.co_line3_1 = co_lines_1[2]; 
        rowData.co_line4_1 = co_lines_1[3]; 
        rowData.co_lines_1 = nvl(co_lines_1[0].split(":")[1],"")+" "+nvl(co_lines_1[1].split(":")[1],"")+" "+nvl(co_lines_1[2].split(":")[1],"")+" "+nvl(co_lines_1[3].split(":")[1],"");
        var co_lines_2 = (rowData.co_line_2||"").split(";");
        rowData.co_line1_2 = co_lines_2[0];
        rowData.co_line2_2 = co_lines_2[1];
        rowData.co_line3_2 = co_lines_2[2]; 
        rowData.co_line4_2 = co_lines_2[3]; 
        rowData.co_lines_2 = nvl(co_lines_2[0].split(":")[1],"")+" "+nvl(co_lines_2[1].split(":")[1],"")+" "+nvl(co_lines_2[2].split(":")[1],"")+" "+nvl(co_lines_2[3].split(":")[1],"");
        var co_lines_3 = (rowData.co_line_3||"").split(";");
        rowData.co_line1_3 = co_lines_3[0];
        rowData.co_line2_3 = co_lines_3[1];
        rowData.co_line3_3 = co_lines_3[2]; 
        rowData.co_line4_3 = co_lines_3[3]; 
        rowData.co_lines_3 = nvl(co_lines_3[0].split(":")[1],"")+" "+nvl(co_lines_3[1].split(":")[1],"")+" "+nvl(co_lines_3[2].split(":")[1],"")+" "+nvl(co_lines_3[3].split(":")[1],"");
        var fi_lines = (rowData.fi_line||"").split(";");
        rowData.fi_lines = nvl(fi_lines[0].split(":")[1],"")+" "+nvl(fi_lines[1].split(":")[1],"")+" "+nvl(fi_lines[2].split(":")[1],"")+" "+nvl(fi_lines[3].split(":")[1],"");
        //console.log(rowData);
        me.pageObj.doc_template.importData(rowData);
        tinyMCE.get(me.pageid+"mytextarea").setContent(rowData.content); 
                
        //원천데이터 입력양식 재설정
        var src_desc;
        try {
            src_desc = JSON.parse( rowData.src_desc_clob );
        } catch {
            src_desc = null 
        }  
        //console.log(src_desc);
        if(!isNull(trim(src_desc))) {
            var doc_data_src_content = [];
            src_desc = sort(src_desc,"sort_seq");
            src_desc.forEach(el=>{ if(el.entry_yn=='Y') doc_data_src_content.push(el); });
            if(!isNull(trim(rowData.src_desc_clob))) me.dataDef["_pgm_data"]["doc_data_src"].content = doc_data_src_content;
            me.pageObj["doc_data_src"] = new gfnComponent( me.pageid, "doc_data_src", me.dataDef["_pgm_data"]["doc_data_src"], me.fnEH, me);  
        }
        var pay_desc;
        try {
            pay_desc = JSON.parse( rowData.pay_desc_clob );
        } catch {
            pay_desc = null 
        }  
        if(!isNull(trim(pay_desc))) {
            var doc_data_pay_content = [];
            pay_desc = sort(pay_desc,"sort_seq");
            pay_desc.forEach(el=>{ if(el.entry_yn=='Y') doc_data_pay_content.push(el); });
            if(!isNull(trim(rowData.pay_desc_clob))) me.dataDef["_pgm_data"]["doc_data_pay"].content = doc_data_pay_content;
            me.pageObj["doc_data_pay"] = new gfnComponent( me.pageid, "doc_data_pay", me.dataDef["_pgm_data"]["doc_data_pay"], me.fnEH, me);  
        } 
        var pjt_desc;
        try {
            pjt_desc = JSON.parse( rowData.pjt_desc_clob );
        } catch {
            pjt_desc = null 
        }  
        if(!isNull(trim(pjt_desc))) {
            var doc_data_pjt_content = [];
            pjt_desc = sort(pjt_desc,"sort_seq");
            pjt_desc.forEach(el=>{ if(el.entry_yn=='Y') doc_data_pjt_content.push(el); });
            if(!isNull(trim(rowData.pjt_desc_clob))) me.dataDef["_pgm_data"]["doc_data_pjt"].content = doc_data_pjt_content;
            me.pageObj["doc_data_pjt"] = new gfnComponent( me.pageid, "doc_data_pjt", me.dataDef["_pgm_data"]["doc_data_pjt"], me.fnEH, me);  
        }
    }
    
    //Variant에 따라 구분과 결재선 표시변경
    me.fnSetVariant=function() { 
        var template_form = me.pageObj.doc_template; 
        var amt_tp = template_form.getVal("amt_tp");
        if(isNull(amt_tp) || amt_tp=="N") { //variant없을때는 전결, 합의선표시 
            me.page.find("[colgrp='구분1']").hide(); me.page.find("[colgrp='합의'] button").show();
            me.page.find("[colgrp='구분2']").next().hide().next().hide().next().hide(); me.page.find("[colgrp='구분2']").hide();
            me.page.find("[colgrp='구분3']").next().hide().next().hide().next().hide(); me.page.find("[colgrp='구분3']").hide();
            me.page.find("[colgrp='구분4']").next().hide().next().hide().next().hide(); me.page.find("[colgrp='구분4']").hide();
            me.page.find("[colid='budget_in']").hide(); me.page.find("[colid='budget_out']").hide(); 
            me.page.find("[colid='amt_from']").hide(); me.page.find("[colid='amt_to']").hide();
            me.page.find("[colid='amt_from_1']").hide(); me.page.find("[colid='amt_to_1']").hide();
            me.page.find("[colid='amt_from_2']").hide(); me.page.find("[colid='amt_to_2']").hide();   
            me.page.find("[colid='amt_from_3']").hide(); me.page.find("[colid='amt_to_3']").hide();           
            me.pageObj.mst.setVal("budget_in","예산범위내"); 
            me.pageObj.mst.setVal("budget_out","예산범위초과"); 
        } else if(amt_tp=="AMT") { //금액구간은 구분1~3개방 
            me.page.find("[colgrp='구분1']").css("width","17em").show(); me.page.find("[colgrp='합의'] button").hide();        
            me.page.find("[colgrp='구분2']").css("width","17em").next().show().next().show().next().show(); me.page.find("[colgrp='구분2']").show();
            me.page.find("[colgrp='구분3']").css("width","17em").next().show().next().show().next().show(); me.page.find("[colgrp='구분3']").show();
            me.page.find("[colgrp='구분4']").css("width","17em").next().show().next().show().next().show(); me.page.find("[colgrp='구분4']").show();
            me.page.find("[colid='budget_in']").hide(); me.page.find("[colid='budget_out']").hide();
            me.page.find("[colid='amt_from']").show(); me.page.find("[colid='amt_to']").show();
            me.page.find("[colid='amt_from_1']").show(); me.page.find("[colid='amt_to_1']").show();
            me.page.find("[colid='amt_from_2']").show(); me.page.find("[colid='amt_to_2']").show();
            me.page.find("[colid='amt_from_3']").show(); me.page.find("[colid='amt_to_3']").show();
            me.pageObj.mst.setVal("budget_in","예산범위내"); 
            me.pageObj.mst.setVal("budget_out","예산범위초과");       
        } else if(amt_tp=="BUDGET") { //예산구간은 구분1~2개방 
            me.page.find("[colgrp='구분1']").css("width","12em").show(); me.page.find("[colgrp='합의'] button").hide();        
            me.page.find("[colgrp='구분2']").css("width","12em").next().show().next().show().next().show(); me.page.find("[colgrp='구분2']").show();
            me.page.find("[colgrp='구분3']").css("width","12em").next().hide().next().hide().next().hide(); me.page.find("[colgrp='구분3']").hide();
            me.page.find("[colgrp='구분4']").css("width","12em").next().hide().next().hide().next().hide(); me.page.find("[colgrp='구분4']").hide();
            me.page.find("[colid='budget_in']").show(); me.page.find("[colid='budget_out']").show();
            me.page.find("[colid='amt_from']").hide(); me.page.find("[colid='amt_to']").hide();
            me.page.find("[colid='amt_from_1']").hide(); me.page.find("[colid='amt_to_1']").hide();
            me.page.find("[colid='amt_from_2']").hide(); me.page.find("[colid='amt_to_2']").hide();
            me.page.find("[colid='amt_from_3']").hide(); me.page.find("[colid='amt_to_3']").hide();
            me.pageObj.mst.setVal("budget_in","예산범위내"); 
            me.pageObj.mst.setVal("budget_out","예산범위초과");          
        } 
    }

    //문서내용에 맞는 결재선 가져오기
    me.fnAutoRcv=function() {
        //작성자/부서정보+합의부서 전체 => 작성자로부터 최상위 결재권자, 합의부서장 
        var args = me.pageObj["mst"].exportData()[0];

        //입력된금액, 잔여예산 => 문서금액 계산 : 템플릿과 비교 - 결재선 가져오기
        var doc_template = me.pageObj.doc_template.exportData()[0];
        var amt_tp = nvl(doc_template.amt_tp,"N"); 
        if(amt_tp=="N") {            //variant 없으면 
            args.amt_tp = "N";
            args.ap_until = doc_template.ap_line;
            args.co_line = me.doc_template.co_line;
            args.rpt_line = me.doc_template.rpt_line;
        } else if (amt_tp=="AMT") {  //금액구간대이면
            args.amt_tp = "AMT";
            var doc_data_src = me.pageObj.doc_data_src.exportData(); 
            var amt = 0;
            doc_data_src.forEach(el=>amt+=toNum(el.amt)); //합계계산
            if(doc_template.amt_from <= amt && amt <= doc_template.amt_to) {
                args.ap_until = doc_template.ap_line;
                args.co_line = me.doc_template.co_line;
                args.rpt_line = me.doc_template.rpt_line;
            } else if(doc_template.amt_from_1 <= amt && amt <= doc_template.amt_to_1 ) { 
                args.ap_until = doc_template.ap_line_1;
                args.co_line  = me.doc_template.co_line_1;
                args.rpt_line = me.doc_template.rpt_line_1;
            } else if(doc_template.amt_from_2 <= amt && amt <= doc_template.amt_to_2 ) { 
                args.ap_until = doc_template.ap_line_2;
                args.co_line = me.doc_template.co_line_2;
                args.rpt_line = me.doc_template.rpt_line_2;
            } else if(doc_template.amt_from_3 <= amt && amt <= doc_template.amt_to_3 ) { 
                args.ap_until = doc_template.ap_line_3;
                args.co_line = me.doc_template.co_line_3;
                args.rpt_line = me.doc_template.rpt_line_3;
            } else {
                gfnStatus("결재선 자동설정 확인","원천Data가 입력되지 않았거나 문서템플릿(전결규정) 금액구간에서 벗어납니다.");
                args.ap_until = nvl(doc_template.ap_line_3,nvl(doc_template.ap_line_2,nvl(doc_template.ap_line_1,doc_template.ap_line)));
                args.co_line = me.doc_template.co_line+""+me.doc_template.co_line_1+""+me.doc_template.co_line_2+""+me.doc_template.co_line_3; 
            }
        } else if (amt_tp=="BUDGET") {  //예산점검이면 상위계정/상위부서로 올라가야 하므로 쿼리에서 처리해야함 : PILOT오픈시는 템플릿에 지정된 0번값 사용
            args.amt_tp = "BUDGET";
            args.ap_until = me.doc_template.ap_line;
            args.co_line  = me.doc_template.co_line; 
            args.rpt_line = me.doc_template.rpt_line;
        } 
        
        //console.log(args);
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"searchAPline",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                me.pageObj.rcv.reset(); 
                var rowNext = 9;
                var cur_ap  = "A";
                OUTVAR.apline.forEach((rtn,idx)=>{
                    if(rtn.rcv_tp =="A"||rtn.rcv_tp =="B") { //문서작성자 본인과 합의선은 무조건 추가 
                        var row = {};
                        row.rcv_dept_nm = rtn.dept_nm; 
                        row.rcv_emp_cd  = rtn.emp_cd;
                        row.rcv_emp_nm  = rtn.kor_nm;
                        row.rcv_hcls_nm = rtn.hcls_nm; 
                        row.rcv_hrsp_nm = rtn.hrsp_nm; 
                        row.rcv_tp      = rtn.rcv_tp; //lv==0?"A":(rtn.lv==9?"B":"C");
                        row.rcv_usid    = rtn.usid;  
                        rowNext = me.pageObj.rcv.addRow(row, rowNext);  
                    } else if(rtn.rcv_tp =="C") {
/* 직급구분 -  A	자가승인 >  B	팀 > C	본부 > D	실 > E	사업부 > F	부문 > G	CEO */
                        var this_ap = "B"; //팀원이건 팀장이건 rcv_tp='C'로 들어오면 승인대상 
                        if( rtn.hrsp_nm=="본부장" || rtn.hrsp_nm=="이사" ) this_ap = "C";
                        else if( rtn.hrsp_nm=="실장" ) this_ap = "D";
                        else if( rtn.hrsp_nm=="사업부장" ) this_ap = "E";
                        else if( rtn.hrsp_nm=="부문장" ) this_ap = "F";
                        else if( rtn.hrsp_nm=="대표이사" || rtn.hrsp_nm=="CEO" || rtn.hrsp_nm=="부회장" ) this_ap = "G";
                        if( cur_ap < this_ap ) cur_ap = this_ap;
                        if( cur_ap <= args.ap_until ) { //조건에 따라 판단된 결재선까지만 추가  
                            var row = {};
                            row.rcv_dept_nm = rtn.dept_nm; 
                            row.rcv_emp_cd  = rtn.emp_cd;
                            row.rcv_emp_nm  = rtn.kor_nm;
                            row.rcv_hcls_nm = rtn.hcls_nm; 
                            row.rcv_hrsp_nm = rtn.hrsp_nm; 
                            row.rcv_tp      = rtn.rcv_tp; //lv==0?"A":(rtn.lv==9?"B":"C");
                            row.rcv_usid    = rtn.usid;  
                            rowNext = me.pageObj.rcv.addRow(row, rowNext);  
                        }
                        if( args.rpt_line == this_ap ) { //보고선 있는 경우 참조선에 보고자 추가
                            var chkrow = me.pageObj.rcv_cc.findRow("rcv_usid",rtn.usid) ;
                            if(chkrow < 0) {
                                var row = {};
                                row.rcv_dept_nm = rtn.dept_nm; 
                                row.rcv_emp_cd  = rtn.emp_cd;
                                row.rcv_emp_nm  = rtn.kor_nm;
                                row.rcv_hcls_nm = rtn.hcls_nm; 
                                row.rcv_hrsp_nm = rtn.hrsp_nm; 
                                row.rcv_tp      = "RPT"; 
                                row.rcv_usid    = rtn.usid;  
                                me.pageObj.rcv_cc.addRow(row);  
                            } else {
                                me.pageObj.rcv_cc.setVal(chkrow,"rcv_tp","RPT"); 
                            }
                        } 
                    }  
                });  
            } else {
                gfnAlert("결재선 조회 오류",OUTVAR.rtnMsg);
            }
        });   
    }
    
    //결재선 순서변경
    me.fnSortOrderSet=function(comp,step) {
        var data = me.pageObj[comp].exportData(); //전체 데이터배열
        var curRow = me.pageObj[comp].selectedRow(); //시작요소
        var from = me.pageObj[comp].getRowIndex(curRow); //시작요소의 순번
        var cnt = me.pageObj[comp].selectedRows().length; //이동건수
        if(cnt < 1) return;
        var mvitems = data.splice(from,cnt); //이동할 요소들을 잘라내고
        var to = from+step; 
        if(to < 0 || to > data.length) {
            gfnStatus("순서변경 확인","더이상 이동할 수 없습니다.");
            return;
        }
        //OBJ flat()이 안되어서 splice를 사용할 수 없음. data.splice(to,0,mvitems); data.flat();
        var dataT = data.splice(to); //꼬리먼저 자르고
        data = data.concat(mvitems).concat(dataT); 
        me.pageObj[comp].importData(data);
        var rows = [to+""];
        for(var i=1; i < cnt; i++) rows.push((to+i)+"");  
        me.pageObj[comp].selectRows(rows); 
    } 
    
    //save:저장 
    me.fnSave=function(afnCallback) {
        if( !me.pageObj["mst"].chkValid() ) return; 
        //var content = tinymce.activeEditor.getContent();
        //console.log(content); 
        //문서안에 이미지는 CLOB으로 변환한다.
        var ed = $(pageid+"mytextarea_ifr")
        ed.contents().find("img").each(function(idx,el){
            el.src = getDataUrl(el);
        });
        me.content = tinyMCE.get(pageid+"mytextarea").getContent();
        //console.log(content); 
        //추가 Validation : 템플릿에 맞춰 결재선/합의선/첨부파일/참조문서 Validation 
        
        var args = me.pageObj["mst"].exportData()[0];  
        args.docid   = me.docid;
        args.content = me.content;
        args.rcv     = me.pageObj["rcv"].exportData();
        args.rcv     = args.rcv.concat( me.pageObj["rcv_cc"].exportData() );
        args.attach  = me.pageObj["attach"].exportData();
        args.ref_doc = me.pageObj["ref_doc"].exportData(); 
        args.doc_data_src = me.pageObj["doc_data_src"].exportData(); 
        args.doc_data_pay = me.pageObj["doc_data_pay"].exportData(); 
        args.doc_data_pjt = me.pageObj["doc_data_pjt"].exportData(); 
        args.doc_plas_frm = me.pageObj["doc_plas_frm"].exportData();  
        args.doc_plas_chit = me.pageObj["doc_plas_chit"].exportData();  
        //console.log(args);
        var invar = JSON.stringify(args);
        gfnTx(appid+"."+pgmid,"save",{INVAR:invar},function(OUTVAR){
            //console.log(OUTVAR);
            if(OUTVAR.rtnCd=="OK") {
                if(typeof(afnCallback)=='function') afnCallback(OUTVAR);
                else {
                    gfnAlert("저장성공","문서가 저장되었습니다.");
                    me.fnSearch(me.docid);
                }
            } else {
                gfnAlert("저장오류",OUTVAR.rtnMsg);
            }
        });  
    } 

    //상신
    me.fnCfm=function() {
        //validation추가!
        //작성자/부서정보+합의부서 전체 => 작성자로부터 최상위 결재권자, 합의부서장 
        var args = me.pageObj["mst"].exportData()[0];

        //입력된금액, 잔여예산 => 문서금액 계산 : 템플릿과 비교 - 결재선 가져오기
        var doc_template = me.pageObj.doc_template.exportData()[0];
        var amt_tp = nvl(doc_template.amt_tp,"N"); 
        if(amt_tp=="N") {            //variant 없으면 
            args.amt_tp = "N";
            args.ap_until = doc_template.ap_line;
            args.co_line = me.doc_template.co_line;
            args.rpt_line = me.doc_template.rpt_line;
        } else if (amt_tp=="AMT") {  //금액구간대이면
            args.amt_tp = "AMT";
            var doc_data_src = me.pageObj.doc_data_src.exportData(); 
            var amt = 0;
            doc_data_src.forEach(el=>amt+=toNum(el.amt)); //합계계산
            if(doc_template.amt_from <= amt && amt <= doc_template.amt_to) {
                args.ap_until = doc_template.ap_line;
                args.co_line = me.doc_template.co_line;
                args.rpt_line = me.doc_template.rpt_line;
            } else if(doc_template.amt_from_1 <= amt && amt <= doc_template.amt_to_1 ) { 
                args.ap_until = doc_template.ap_line_1;
                args.co_line  = me.doc_template.co_line_1;
                args.rpt_line = me.doc_template.rpt_line_1;
            } else if(doc_template.amt_from_2 <= amt && amt <= doc_template.amt_to_2 ) { 
                args.ap_until = doc_template.ap_line_2;
                args.co_line = me.doc_template.co_line_2;
                args.rpt_line = me.doc_template.rpt_line_2;
            } else if(doc_template.amt_from_3 <= amt && amt <= doc_template.amt_to_3 ) { 
                args.ap_until = doc_template.ap_line_3;
                args.co_line = me.doc_template.co_line_3;
                args.rpt_line = me.doc_template.rpt_line_3;
            } else {
                gfnStatus("결재선 자동설정 확인","원천Data가 입력되지 않았거나 문서템플릿(전결규정) 금액구간에서 벗어납니다.");
                args.ap_until = nvl(doc_template.ap_line_3,nvl(doc_template.ap_line_2,nvl(doc_template.ap_line_1,doc_template.ap_line)));
                args.co_line = me.doc_template.co_line+""+me.doc_template.co_line_1+""+me.doc_template.co_line_2+""+me.doc_template.co_line_3; 
            }
        } else if (amt_tp=="BUDGET") {  //예산점검이면 상위계정/상위부서로 올라가야 하므로 쿼리에서 처리해야함 : PILOT오픈시는 템플릿에 지정된 0번값 사용
            args.amt_tp = "BUDGET";
            args.ap_until = me.doc_template.ap_line;
            args.co_line  = me.doc_template.co_line; 
            args.rpt_line = me.doc_template.rpt_line;
        } 
        var rcv = me.pageObj.rcv.exportData();
        var chk = {a_yn:"N",ap_line:" ",rpt_line:" "};
        var cur_ap = "A";
        if(rcv.length < 1) {
            gfnAlert("결재선 확인","문서의 결재선이 입력되지 않았습니다.");
            return;
        }
        rcv.forEach((rtn,idx)=>{
            if(idx==0 && rtn.rcv_tp!="A") {
                gfnAlert("결재선 확인","결재선은 문서 작성자가 상신하는 것으로 시작하여야 합니다.");
                return;
            }
            if(rtn.rcv_tp=="A") {
                chk.a_yn    = "Y";
                chk.ap_line = "A"; 
            }
            var this_ap = " ";  
            if(rtn.rcv_tp=="C") { //결재선일때 
                this_ap = "B"; //결재선이 있으면 일단 팀장승인은 충족된 것으로 봄(팀장없는 팀이 있음) 
                if( rtn.rcv_hrsp_nm=="본부장" || rtn.rcv_hrsp_nm=="이사" ) this_ap = "C";
                else if( rtn.rcv_hrsp_nm=="실장" ) this_ap = "D";
                else if( rtn.rcv_hrsp_nm=="사업부장" ) this_ap = "E";
                else if( rtn.rcv_hrsp_nm=="부문장" ) this_ap = "F";
                else if( rtn.rcv_hrsp_nm=="대표이사" || rtn.rcv_hrsp_nm=="CEO" || rtn.rcv_hrsp_nm=="부회장" ) this_ap = "G"; 
                if(chk.ap_line < this_ap) chk.ap_line = this_ap;
            }
            //if(rtn.rcv_tp=="B") { 합의선 확인: 지원조직이 결재선인 경우 합의선은 생략할 수 있으므로 모든 rcv_tp 를 replace대상으로 한다.
            var dept_nm = rtn.rcv_dept_nm;
            if(!isNull(args.co_line)) args.co_line = args.co_line.replaceAll(dept_nm,""); //이렇게지우고나면 ':',';',' '만 남아야 한다. 
            //}
        }); 
        console.log("chk.ap_line:"+ chk.ap_line +" , args.ap_until: "+ args.ap_until);
        if(chk.ap_line < args.ap_until) { //등록된 결재선이 요구결재선보다 작으면
            /* 직급구분 -  A	자가승인 >  B	팀 > C	본부 > D	실 > E	사업부 > F	부문 > G	CEO */
            if((args.ap_until == "E" || args.ap_until == "F")  && chk.ap_line == "D" ) {
                gfnStatus("결재선 확인","규정결재선("+gfnCdNm("AP_LINE",args.ap_until)+")이지만 지정된 결재선(실)로 진행합니다."); 
            } else {
                gfnAlert("결재선 확인","전결규정에서 요구하는 결재선("+gfnCdNm("AP_LINE",args.ap_until)+")을 충족하지 못했습니다.");
                return;
            }
        }
        if(!isNull(args.co_line)) args.co_line = args.co_line.replace(/([0-9])|(:)|(;)|( )/gi,"");
        if(!isNull(args.co_line)) {
            console.log(args.co_line);
            gfnAlert("결재선 확인","전결규정에서 요구하는 합의선("+args.co_line+")을 충족하지 못했습니다.");
            return;
        }
        var rcv_cc = me.pageObj.rcv_cc.exportData();
        rcv_cc.forEach((rtn,idx)=>{ 
            var this_rpt = " ";  
            if(rtn.rcv_tp=="RPT") { //보고선일때 
                this_rpt = "B"; //보고선이 있으면 일단 팀장은 충족된 것으로 봄(팀장없는 팀이 있음) 
                if( rtn.rcv_hrsp_nm=="본부장" || rtn.rcv_hrsp_nm=="이사" ) this_rpt = "C";
                else if( rtn.rcv_hrsp_nm=="실장" ) this_rpt = "D";
                else if( rtn.rcv_hrsp_nm=="사업부장" ) this_rpt = "E";
                else if( rtn.rcv_hrsp_nm=="부문장" ) this_rpt = "F";
                else if( rtn.rcv_hrsp_nm=="대표이사" || rtn.rcv_hrsp_nm=="CEO" || rtn.rcv_hrsp_nm=="부회장" ) this_rpt = "G"; 
                if(chk.rpt_line < this_rpt) chk.rpt_line = this_rpt;
            } 
        });  
        if(chk.rpt_line < args.rpt_line) { //등록된 결재선이 요구결재선보다 작으면
            gfnAlert("결재선 확인","전결규정에서 요구하는 보고선("+gfnCdNm("AP_LINE",args.rpt_line)+")을 충족하지 못했습니다.");
            return;
        } 
        
        //confirm추가!
        gfnPrompt("문서상신","문서를 상신하시겠습니까?<br>코멘트:",OUTVAR=>{
            if(!OUTVAR.rtnCd) {
                gfnStatus("전재결재 취소","문서상신이 취소되었습니다.");
                return;
            }
            //저장 후 
            var msg = OUTVAR.rtnMsg;
            me.fnSave(function(OUTVAR){  
                var args = me.pageObj["mst"].exportData()[0];   
                args.comment = msg; 
                console.log(args);
                var invar = JSON.stringify(args);
                gfnTx(appid+"."+pgmid,"cfm",{INVAR:invar},function(OUTVAR){
                    //console.log(OUTVAR);
                    if(OUTVAR.rtnCd=="OK") {
                        console.log(OUTVAR);
                        gfnAlert("문서 저장성공","문서가 상신되었습니다.");
                        // var useremail = OUTVAR.emails.split(";"); useremail.pop(); //마지막 빈줄은 날려준다.
                        // var msg = "전자결재 문서가 상신 되었습니다. 승인/합의 요청 메시지 수신시, 승인/합의 부탁드립니다.\n\n  - 문서: ["+ args.doc_no +"] "+ args.title;
                        // var sender = gds.comcd.find(el=>el.grpcd=="PLAS_USID"&&el.cd==gUserinfo.userid);
                        // msg +=  "\n  - 상신: "+ sender.deptnm+" "+sender.nm+" "+sender.jobgradenm;
                        // if(!isNull(args.comment)) msg += "\n  - 의견: "+ args.comment;
                        // var url = "https://fo.lfnetworks.co.kr/plas.jsp?d="+args.docid;
                        // var ref_info = args.docid;
                        // gfnSendMsg("naverworks", useremail, msg, url, function(OUTVAR2) {
                        //     if(!isNull(OUTVAR.ap_email)) {
                        //         var useremail2 = OUTVAR.ap_email.split(";"); useremail2.pop();;  
                        //         var msg2 = "전자결재 문서가 상신되었습니다.\n\n";
                        //         msg2 += "  - 문서: ["+ args.doc_no +"] "+ args.title +"\n";
                        //         var sender2 = gds.comcd.find(el=>el.grpcd=="PLAS_USID"&&el.cd==gUserinfo.userid);
                        //         msg2 += "  - 상신: "+ sender2.deptnm+" "+sender2.nm+" "+sender2.jobgradenm;
                        //         if(!isNull(args.comment)) msg2 += "\n  - 의견: "+ args.comment;
                        //         var url2 = "https://fo.lfnetworks.co.kr/plas.jsp?d="+args.docid;
                        //         var ref_info = args.docid;
                        //         gfnSendMsg("naverworks", useremail2, msg2, url2, function() {
                        //             me.fnSearch(me.docid);    
                        //         }, ref_info, pgmid); 
                        //     } else { 
                        //         me.fnSearch(me.docid);    
                        //     }   
                        // }, ref_info, pgmid);
                         
                    } else {
                        gfnAlert("저장오류",OUTVAR.rtnMsg);
                    }
                });  
            }); 
        }); 
    }

    //승인 
    me.fnApv=function() {
        //validation추가!
        //confirm추가!
        gfnPrompt("문서승인/합의","문서를 승인/합의 하시겠습니까?<br>코멘트:",OUTVAR=>{
            if(!OUTVAR.rtnCd)  {
                gfnStatus("전재결재 취소","문서 승인이 취소되었습니다.");
                return;
            }
            var args = me.pageObj["mst"].exportData()[0];   
            args.comment = OUTVAR.rtnMsg;
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"apv",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("문서 저장성공","문서가 승인/합의되었습니다.");
                    if(!isNull(OUTVAR.ap_email)) OUTVAR.email.replace(OUTVAR.ap_email+";",""); //다음승인권자가 있는 경우 메시지 수신자 목록에서 제외한다.
                    var useremail = OUTVAR.emails.split(";"); useremail.pop(); //마지막 빈줄은 날려준다. 
                    var msg = "전자결재 문서가 승인/합의되었습니다.\n\n";
                    msg += "  - 문서: ["+ args.doc_no +"] "+ args.title +"\n";
                    var sender = gds.comcd.find(el=>el.grpcd=="PLAS_USID"&&el.cd==gUserinfo.userid);
                    msg += "  - 승인/합의: "+ sender.deptnm+" "+sender.nm+" "+sender.jobgradenm;
                    if(!isNull(args.comment)) msg += "\n  - 의견: "+ args.comment;
                    var url = "https://fo.lfnetworks.co.kr/plas.jsp?d="+args.docid;
                    var ref_info = args.docid;
                    gfnSendMsg("naverworks", useremail, msg, url, function(OUTVAR2) {
                        //다음 승인자는 메시지를 달리하여 전송한다. 
                        if(!isNull(OUTVAR.ap_email)) {
                            var useremail = OUTVAR.ap_email;  
                            var msg = "전자결재 문서를 승인/합의 요청합니다.\n\n";
                            msg += "  - 문서: ["+ args.doc_no +"] "+ args.title +"\n";
                            var sender = gds.comcd.find(el=>el.grpcd=="PLAS_USID"&&el.cd==gUserinfo.userid);
                            msg += "  - 선행 승인/합의: "+ sender.deptnm+" "+sender.nm+" "+sender.jobgradenm;
                            if(!isNull(args.comment)) msg += "\n  - 의견: "+ args.comment;
                            var url = "https://fo.lfnetworks.co.kr/plas.jsp?d="+args.docid;
                            var ref_info = args.docid;
                            gfnSendMsg("naverworks", useremail, msg, url, function() {
                                me.fnSearch(me.docid);    
                            }, ref_info, pgmid); 
                        //다음 승인자가 없으면 재조회    
                        } else { 
                            me.fnSearch(me.docid);    
                        }
                    }, ref_info, pgmid); 
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });  
        });
    }

    //회수(승인취소)
    me.fnReturn=function() {
        //validation추가!
        //confirm추가!
        gfnPrompt("문서회수","문서를 회수(상신취소 또는 승인/합의취소) 하시겠습니까?<br>코멘트:",OUTVAR=>{
            if(!OUTVAR.rtnCd)  {
                gfnStatus("전재결재 취소","문서회수가 취소되었습니다.");
                return;
            }
            var args = me.pageObj["mst"].exportData()[0];   
            args.comment = OUTVAR.rtnMsg;
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"return",{INVAR:invar},function(OUTVAR){
                //console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("문서 저장성공","문서가 회수(상신/승인취소)되었습니다.");
                    var useremail = OUTVAR.emails.split(";"); useremail.pop(); //마지막 빈줄은 날려준다.
                    var msg = "전자결재 문서가 회수(상신/승인취소)되었습니다.\n\n  - 문서: ["+ args.doc_no +"] "+ args.title;
                    var sender = gds.comcd.find(el=>el.grpcd=="PLAS_USID"&&el.cd==gUserinfo.userid);
                    msg +=  "\n  - 회수: "+ sender.deptnm+" "+sender.nm+" "+sender.jobgradenm;
                    if(!isNull(args.comment)) msg += "\n  - 의견: "+ args.comment;
                    var url = "https://fo.lfnetworks.co.kr/plas.jsp?d="+args.docid;
                    var ref_info = args.docid;
                    gfnSendMsg("naverworks", useremail, msg, url, function(OUTVAR) {
                        me.fnSearch(me.docid);    
                    }, ref_info, pgmid); 
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });   
        });
    } 

    //반려
    me.fnReject=function() {
        //validation추가!
        //confirm추가!
        gfnPrompt("문서반려","문서를 반려 하시겠습니까?<br>코멘트:",OUTVAR=>{
            if(!OUTVAR.rtnCd)  {
                gfnStatus("전재결재 취소","반려 취소되었습니다.");
                return;
            }
            var args = me.pageObj["mst"].exportData()[0];   
            args.comment = OUTVAR.rtnMsg;
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"reject",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("문서 저장성공","문서가 반려되었습니다.");
                    var useremail = OUTVAR.emails.split(";"); useremail.pop(); //마지막 빈줄은 날려준다.
                    var msg = "전자결재 문서가 반려되었습니다.\n\n  - 문서: ["+ args.doc_no +"] "+ args.title;
                    var sender = gds.comcd.find(el=>el.grpcd=="PLAS_USID"&&el.cd==gUserinfo.userid);
                    msg +=  "\n  - 반려: "+ sender.deptnm+" "+sender.nm+" "+sender.jobgradenm;
                    if(!isNull(args.comment)) msg += "\n  - 의견: "+ args.comment;
                    var url = "https://fo.lfnetworks.co.kr/plas.jsp?d="+args.docid;
                    var ref_info = args.docid;
                    gfnSendMsg("naverworks", useremail, msg, url, function(OUTVAR) {
                        me.fnSearch(me.docid);    
                    }, ref_info, pgmid); 
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });  
        });
    }
    
    //재상신편집
    me.fnRevive=function() {
        //validation추가!
        //confirm추가!
        gfnConfirm("문서 재상신 편집","문서상태를 재상신을 위한 작성중 상태로 변경 하시겠습니까?",OUTVAR=>{
            if(!OUTVAR) return;  
            var args = me.pageObj["mst"].exportData()[0];   
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"revive",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("문서 저장성공","문서 상태가 변경 되었습니다.");
                    me.fnSearch(me.docid); 
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });  
        });
    }
    
    //문서삭제처리
    me.fnDelete=function() {
        //validation추가!
        //confirm추가!
        gfnConfirm("문서 삭제(폐기보관)","문서상태를 삭제로 변경 하시겠습니까?",OUTVAR=>{
            if(!OUTVAR) return;  
            var args = me.pageObj["mst"].exportData()[0];   
            //console.log(args);
            var invar = JSON.stringify(args);
            gfnTx(appid+"."+pgmid,"delete",{INVAR:invar},function(OUTVAR){
                console.log(OUTVAR);
                if(OUTVAR.rtnCd=="OK") {
                    gfnAlert("문서 저장성공","문서 상태가 변경 되었습니다.");
                    me.fnSearch(me.docid); 
                } else {
                    gfnAlert("저장오류",OUTVAR.rtnMsg);
                }
            });  
        });
    }
    
    //복사
    me.fnCopy=function() {
        //validation추가!
        //confirm추가!
        gfnConfirm("문서복사","문서를 복사하여 신규문서를 생성합니다.",OUTVAR=>{
            if(!OUTVAR) return;  
            gParam.copyDoc = me;
            gMDI.openPage("plasDocReg", "신규문서작성(복사)"); 
        });
    }    
    
    //문서 발행양식으로 보기
    me.fnPreview=function() {
        if(me.page.find("#previewPanel").css("display")=="none") {
            me.fnMakePreview();
            me.page.find("#comment").addClass("floatRight").appendTo(me.page);
            me.page.find("#comment .componentTitle").addClass("closed");
            me.page.find("#comment .componentBody").hide();
        } else {
            me.page.find("#editPanel").show();  
            me.page.find("#comment").removeClass("floatRight").appendTo(me.page.find("#apv > .flexRow2"));
            me.page.find("#comment .componentTitle").removeClass("closed");            
            me.page.find("#comment .componentBody").show();
            me.page.find("#previewPanel").hide();             
        }
    }
    
    //화면상의 정보로 preview만들기
    me.fnMakePreview=function() { 
        var args = me.pageObj["mst"].exportData()[0]; 
        
        //상신전 상태가 아니면 기능을 Hide한다.
        if(args.doc_stat!='D') me.page.addClass("hideComponentFunc");
        else me.page.removeClass("hideComponentFunc");
        
        args.docid   = me.docid;
        args.content = me.content;
        args.rcv     = me.pageObj["rcv"].exportData();
        args.rcv     = args.rcv.concat( me.pageObj["rcv_cc"].exportData() );
        args.rcv_ap  = [];
        args.rcv_co  = [];
        args.rcv_cc  = [];
        args.rcv.forEach(el=>{
            if(el.rcv_tp=='A'||el.rcv_tp=='C') args.rcv_ap.push(el);
            else if(el.rcv_tp=='B') args.rcv_co.push(el);
            else args.rcv_cc.push(el);
        })
        args.attach  = me.pageObj["attach"].exportData();
        args.ref_doc = me.pageObj["ref_doc"].exportData(); 
        var doc_content = tinyMCE.get(pageid+"mytextarea").getContent(); 
        
        /******* 전자결재문서 생성 *********************************************************/
        //console.log(args);
        var html = `<div class="doc_container">
        <div class="doc_cover">${gfnCdNm("DOC_TEMPLATE_ID",args.doc_template_id,"nm")}</div>
        <div class="doc_top">
            <table class="doc_mst">
                <tr class="doc_row">
                    <th class="doc_label">회사</th>
                    <td><div class="doc_val">${args.reg_co}</div></td>
                </tr>
                <tr class="doc_row">
                    <th class="doc_label">문서번호</th>
                    <td><div class="doc_val">${args.doc_no}</div></td>
                </tr>
                <tr class="doc_row">
                    <th class="doc_label">부서</th>
                    <td><div class="doc_val">${args.reg_dept}</div></td>
                </tr>
                <tr class="doc_row">
                    <th class="doc_label">작성자</th>
                    <td><div class="doc_val">${args.reg_emp_info}</div></td>
                </tr>
                <tr class="doc_row">
                    <th class="doc_label">작성일</th>
                    <td><div class="doc_val">${date(args.doc_dt,"yyyymmdd","yyyy-mm-dd")}</div></td>
                </tr>
            </table>
            <table class="doc_rcvs">
                <tr class="doc_row">
                    <th class="doc_label">결재</th>
                    <td><div class="doc_val"> 
                        <div class="doc_rcv">
                            <label class="hrsp_nm">상신</label>
                            <span class="emp_nm">${(args.rcv_ap[0]||{}).rcv_emp_nm}</span>
                            <label class="ap_dt">${(args.rcv_ap[0]||{}).proc_stat=="Y"?date(args.rcv_ap[0].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):"&nbsp;"}</label>
                        </div> 
                        <div class="doc_rcv">
                            <label class="hrsp_nm">${nvl((args.rcv_ap[1]||{}).rcv_hrsp_nm,"&nbsp;")}</label>
                            <span class="emp_nm">${nvl((args.rcv_ap[1]||{}).rcv_emp_nm,"&nbsp;")}</span>
                            <label class="ap_dt">${(args.rcv_ap[1]||{}).proc_stat=="Y"?date(args.rcv_ap[1].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):((args.rcv_ap[1]||{}).proc_stat=="C"?"(반려)":"&nbsp;")}</label>
                        </div> 
                        <div class="doc_rcv">
                            <label class="hrsp_nm">${nvl((args.rcv_ap[2]||{}).rcv_hrsp_nm,"&nbsp;")}</label>
                            <span class="emp_nm">${nvl((args.rcv_ap[2]||{}).rcv_emp_nm,"&nbsp;")}</span>
                            <label class="ap_dt">${(args.rcv_ap[2]||{}).proc_stat=="Y"?date(args.rcv_ap[2].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):((args.rcv_ap[2]||{}).proc_stat=="C"?"(반려)":"&nbsp;")}</label>
                        </div> 
                        <div class="doc_rcv">
                            <label class="hrsp_nm">${nvl((args.rcv_ap[3]||{}).rcv_hrsp_nm,"&nbsp;")}</label>
                            <span class="emp_nm">${nvl((args.rcv_ap[3]||{}).rcv_emp_nm,"&nbsp;")}</span>
                            <label class="ap_dt">${(args.rcv_ap[3]||{}).proc_stat=="Y"?date(args.rcv_ap[3].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):((args.rcv_ap[3]||{}).proc_stat=="C"?"(반려)":"&nbsp;")}</label>
                        </div> 
                        <div class="doc_rcv">
                            <label class="hrsp_nm">${nvl((args.rcv_ap[4]||{}).rcv_hrsp_nm,"&nbsp;")}</label>
                            <span class="emp_nm">${nvl((args.rcv_ap[4]||{}).rcv_emp_nm,"&nbsp;")}</span>
                            <label class="ap_dt">${(args.rcv_ap[4]||{}).proc_stat=="Y"?date(args.rcv_ap[4].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):((args.rcv_ap[4]||{}).proc_stat=="C"?"(반려)":"&nbsp;")}</label>
                        </div> 
                    </div></td>
                </tr>
                <tr class="doc_row">
                    <th class="doc_label">합의</th>
                    <td><div class="doc_val"> 
                        <div class="doc_rcv">
                            <label class="dept_nm"><span>${nvl((args.rcv_co[0]||{}).rcv_grpid,"&nbsp;")}</span></label>
                            <span class="emp_nm">${nvl((args.rcv_co[0]||{}).rcv_emp_nm,"&nbsp;")}</span>
                            <label class="ap_dt">${(args.rcv_co[0]||{}).proc_stat=="Y"?date(args.rcv_co[0].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):((args.rcv_co[0]||{}).proc_stat=="C"?"(반려)":"&nbsp;")}</label>
                        </div> 
                        <div class="doc_rcv">
                            <label class="dept_nm"><span>${nvl((args.rcv_co[1]||{}).rcv_grpid,"&nbsp;")}</span></label>
                            <span class="emp_nm">${nvl((args.rcv_co[1]||{}).rcv_emp_nm,"&nbsp;")}</span>
                            <label class="ap_dt">${(args.rcv_co[1]||{}).proc_stat=="Y"?date(args.rcv_co[1].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):((args.rcv_co[1]||{}).proc_stat=="C"?"(반려)":"&nbsp;")}</label>
                        </div> 
                        <div class="doc_rcv">
                            <label class="dept_nm"><span>${nvl((args.rcv_co[2]||{}).rcv_grpid,"&nbsp;")}</span></label>
                            <span class="emp_nm">${nvl((args.rcv_co[2]||{}).rcv_emp_nm,"&nbsp;")}</span>
                            <label class="ap_dt">${(args.rcv_co[2]||{}).proc_stat=="Y"?date(args.rcv_co[2].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd"):((args.rcv_co[2]||{}).proc_stat=="C"?"(반려)":"&nbsp;")}</label>
                        </div>
                        ${isNull(args.rcv_co[3])?"":'<div class="doc_rcv">'}
                        ${isNull(args.rcv_co[3])?"":('<label class="dept_nm"><span>'+args.rcv_co[3].rcv_grpid+'</span></label>')}
                        ${isNull(args.rcv_co[3])?"":('<span class="emp_nm">'+args.rcv_co[3].rcv_emp_nm+'</span>')}
                        ${isNull(args.rcv_co[3])?"":('<label class="ap_dt">'+(args.rcv_co[3].proc_stat=="Y"?(date(args.rcv_co[3].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd")):((args.rcv_co[3]||{}).proc_stat=="C"?"(반려)":"&nbsp;"))+'</label>')}
                        ${isNull(args.rcv_co[3])?"":'</div>'}
                        ${isNull(args.rcv_co[4])?"":'<div class="doc_rcv">'}
                        ${isNull(args.rcv_co[4])?"":('<label class="dept_nm"><span>'+args.rcv_co[4].rcv_grpid+'</span></label>')}
                        ${isNull(args.rcv_co[4])?"":('<span class="emp_nm">'+args.rcv_co[4].rcv_emp_nm+'</span>')}
                        ${isNull(args.rcv_co[4])?"":('<label class="ap_dt">'+(args.rcv_co[4].proc_stat=="Y"?(date(args.rcv_co[4].upd_dt,"yyyy-mm-dd hh24:mi:ss","'yy.mm.dd")):((args.rcv_co[4]||{}).proc_stat=="Y"?"(반려)":"&nbsp;"))+'</label>')}
                        ${isNull(args.rcv_co[4])?"":'</div>'}
                    </div></td>
                </tr>
                <tr class="doc_row doc_rcv_cc">
                    <th class="doc_label">참조</th>
                    <td><div class="doc_val"> 
                    </div></td>
                </tr>
            </table>
        </div> 
        <table class="doc_header">
            <tr class="doc_row">
                <th class="doc_label">문서명</th>
                <td><div class="doc_val">${args.title}</div></td>
            </tr>
        </table>
        <div class="doc_body">${doc_content}<br/><br/></div> 
        <table class="doc_footer">
            <tr class="doc_row">
                <th class="doc_label">첨부파일</th>
                <td><div class="doc_val attachs">
                </div></td>
            </tr>
            <tr class="doc_row">
                <th class="doc_label">참조문서</th>
                <td><div class="doc_val ref_docs">
                </div></td>
            </tr>
            <tr class="doc_row">
                <th class="doc_label">키워드</th>
                <td><div class="doc_val">${args.tag}</div></td>
            </tr>
        </table>    
        <!-- hr style="page-break-before:always"></hr -->    
        </div>`;
        me.page.find("#previewPanel").html(html); 
        args.rcv_cc.forEach(el=>{
            me.page.find("#previewPanel .doc_rcv_cc .doc_val").append('<div class="doc_rcv"><span class="emp_nm">'+el.rcv_emp_nm+'</span></div>');    
        });
        args.attach.forEach(el=>{
            var attach = $('<div class="doc_file"><span class="content">'+el.file_nm+'</span><label class="content_info">'+el.file_ext+'('+format(toNum(el.file_sz)/1024,0)+'kb)</label></div>');
            me.page.find("#previewPanel .attachs.doc_val").append(attach);    
            attach.on("dblclick",function(e){
                gfnDownload(el.fileid, el.content); 
            }); 
        });
        args.ref_doc.forEach(el=>{
            var ref_doc = $('<div class="doc_ref_doc"><span class="doc_no">'+el.doc_no+'</span><label class="title">'+el.title+'</label></div>');
            me.page.find("#previewPanel .ref_docs.doc_val").append(ref_doc);
            ref_doc.on("dblclick",function(e){
                gfnShowPlasDoc( el.content );    
            })
        }); 
                         
        /******* 전자결재문서 생성 *********************************************************/


        me.pageObj._pageFunc.setDisp("print",true); 
        me.page.find("#editPanel").hide();  
        me.page.find("#previewPanel").show(); 
        me.page.find("#comment").addClass("floatRight").appendTo(me.page);
        me.page.find("#comment .componentTitle").addClass("closed");
        me.page.find("#comment .componentBody").hide();
    }
    
    //previewPanel을 발행하기 
    me.fnPrint=function() {
        me.fnMakePreview(); 
        //발행을 위한 설정: history.pushState(history객체, title, ?URL)
        var doc_title_org = document.title;
        var doc_title = me.pageObj.mst.getVal("title");
        var url = location.href.substr( location.href.indexOf(SYS_URL)+(SYS_URL.length)+1 );
        var doc_no = me.pageObj.mst.getVal("doc_no");
        var usernm = gUserinfo.usernm;
        var cur_dt = date("today","yy.mm.dd_hh24:mi:ss");
        document.title = doc_title;
        history.pushState(null,"PLAS인쇄",doc_no+"_"+usernm+"_"+cur_dt);
        
        window.print();  //gfnPdf(me, "previewPanel"); 
        
        //발행 후 URL원복
        history.pushState(null,"PLAS인쇄",url);        
        document.title = doc_title_org;
    }  
    
    //close:닫기 
    me.fnClose=function() {
        tinyMCE.execCommand("mceRemoveEditor", true, me.pageid+"mytextarea");
        if(typeof(me.fnCallback)=="function") me.fnCallback();
        
        //팝업으로 표시되었을때는 
        if(me.page.exactObj("[role='dialog']").length==0) {
            gMDI.closeTab(me.pageid);     
        } else {
            var myPopupId = me.page.exactObj("[role='dialog']").attr("aria-describedby");
            $("#"+myPopupId).dialog("close");    
        }
        delete gfn[me.pageid]; 
    }


/*-- SCRIPT autogen ---------------------------------------------------- */        
if(typeof(me.fnInit)=='function') me.fnInit();
});

</script>